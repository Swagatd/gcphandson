[0m02:38:53.111366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc173d8b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1724a0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1724a0160>]}


============================== 02:38:53.119287 | 23ab653c-5491-4fae-9ba9-d7d26e67e32e ==============================
[0m02:38:53.119287 [info ] [MainThread]: Running with dbt=1.5.5
[0m02:38:53.123057 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'partial_parse': 'True', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False'}
[0m02:38:53.193825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23ab653c-5491-4fae-9ba9-d7d26e67e32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1722e89d0>]}
[0m02:38:53.202329 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3w4icdqq'
[0m02:38:53.204705 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:38:53.864945 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:38:53.870033 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:38:54.136590 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:38:54.167678 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:39:02.848390 [info ] [MainThread]: Installed from version 1.1.1
[0m02:39:02.851546 [info ] [MainThread]: Up to date!
[0m02:39:02.856243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '23ab653c-5491-4fae-9ba9-d7d26e67e32e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1724bb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1724bba00>]}
[0m02:39:02.860044 [debug] [MainThread]: Command `dbt deps` succeeded at 02:39:02.859653 after 9.80 seconds
[0m02:39:02.862683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc173d8b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1722e89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc172363820>]}
[0m02:39:02.865484 [debug] [MainThread]: Flushing usage events
[0m02:40:16.285520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc81d93610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc806a05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc806a0040>]}


============================== 02:40:16.292929 | 83f23653-9a2d-4c32-b15e-012d2142da73 ==============================
[0m02:40:16.292929 [info ] [MainThread]: Running with dbt=1.5.5
[0m02:40:16.296000 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False'}
[0m02:40:17.154273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e621240>]}
[0m02:40:17.188572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e64a110>]}
[0m02:40:17.196110 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m02:40:17.257929 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m02:40:17.271492 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:40:17.274261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e64a0e0>]}
[0m02:40:20.503127 [debug] [MainThread]: 1603: static parser failed on analytics/dim_accounts.sql
[0m02:40:20.581924 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/dim_accounts.sql
[0m02:40:20.586974 [debug] [MainThread]: 1603: static parser failed on analytics/dim_users.sql
[0m02:40:20.601923 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/dim_users.sql
[0m02:40:20.606837 [debug] [MainThread]: 1603: static parser failed on analytics/fct_transactions.sql
[0m02:40:20.620046 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/fct_transactions.sql
[0m02:40:20.625324 [debug] [MainThread]: 1699: static parser successfully parsed analytics/report_7d_active_users.sql
[0m02:40:20.632298 [debug] [MainThread]: 1603: static parser failed on staging/stg_accounts_closed.sql
[0m02:40:20.647194 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_accounts_closed.sql
[0m02:40:20.651649 [debug] [MainThread]: 1603: static parser failed on staging/stg_accounts_created.sql
[0m02:40:20.662898 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_accounts_created.sql
[0m02:40:20.668855 [debug] [MainThread]: 1603: static parser failed on staging/stg_accounts_reopened.sql
[0m02:40:20.678998 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_accounts_reopened.sql
[0m02:40:21.167335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e3075b0>]}
[0m02:40:21.209240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e64b130>]}
[0m02:40:21.211630 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m02:40:21.214806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e64a0e0>]}
[0m02:40:21.220620 [info ] [MainThread]: 
[0m02:40:21.228781 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:40:21.233334 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203'
[0m02:40:21.235598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:22.554906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silicon-parity-396203, now create_silicon-parity-396203_monzo)
[0m02:40:22.558690 [debug] [ThreadPool]: Creating schema "database: "silicon-parity-396203"
schema: "monzo"
"
[0m02:40:22.581074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:22.589744 [debug] [ThreadPool]: On create_silicon-parity-396203_monzo: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "connection_name": "create_silicon-parity-396203_monzo"} */
create schema if not exists `silicon-parity-396203`.`monzo`
  
[0m02:40:25.404033 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:941f2a62-1c52-432a-8031-ff65d7cfeb7c&page=queryresults
[0m02:40:25.409732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_silicon-parity-396203_monzo, now list_silicon-parity-396203_monzo)
[0m02:40:25.412001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:26.662946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e304fa0>]}
[0m02:40:26.667472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:40:26.672076 [info ] [MainThread]: 
[0m02:40:26.701694 [debug] [Thread-1 (]: Began running node seed.monzo_task.account_closed
[0m02:40:26.704933 [info ] [Thread-1 (]: 1 of 4 START seed file monzo.account_closed .................................... [RUN]
[0m02:40:26.710506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_monzo, now seed.monzo_task.account_closed)
[0m02:40:26.713098 [debug] [Thread-1 (]: Began compiling node seed.monzo_task.account_closed
[0m02:40:26.715632 [debug] [Thread-1 (]: Timing info for seed.monzo_task.account_closed (compile): 02:40:26.715057 => 02:40:26.715065
[0m02:40:26.718152 [debug] [Thread-1 (]: Began executing node seed.monzo_task.account_closed
[0m02:40:26.814844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:40:37.267479 [debug] [Thread-1 (]: On seed.monzo_task.account_closed: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "seed.monzo_task.account_closed"} */

    alter table `silicon-parity-396203`.`monzo`.`account_closed` set OPTIONS()
  
[0m02:40:39.067393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:d8073c54-b2d2-4926-b64c-1840b429844a&page=queryresults
[0m02:40:39.082444 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.monzo_task.account_closed"
[0m02:40:39.142912 [debug] [Thread-1 (]: Timing info for seed.monzo_task.account_closed (execute): 02:40:26.720792 => 02:40:39.142393
[0m02:40:39.145614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e49d060>]}
[0m02:40:39.148086 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file monzo.account_closed ................................ [[32mINSERT 4013[0m in 12.44s]
[0m02:40:39.152639 [debug] [Thread-1 (]: Finished running node seed.monzo_task.account_closed
[0m02:40:39.155366 [debug] [Thread-1 (]: Began running node seed.monzo_task.account_created
[0m02:40:39.157778 [info ] [Thread-1 (]: 2 of 4 START seed file monzo.account_created ................................... [RUN]
[0m02:40:39.161406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.monzo_task.account_closed, now seed.monzo_task.account_created)
[0m02:40:39.163816 [debug] [Thread-1 (]: Began compiling node seed.monzo_task.account_created
[0m02:40:39.166937 [debug] [Thread-1 (]: Timing info for seed.monzo_task.account_created (compile): 02:40:39.165921 => 02:40:39.165930
[0m02:40:39.169373 [debug] [Thread-1 (]: Began executing node seed.monzo_task.account_created
[0m02:40:39.347915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:40:53.214404 [debug] [Thread-1 (]: On seed.monzo_task.account_created: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "seed.monzo_task.account_created"} */

    alter table `silicon-parity-396203`.`monzo`.`account_created` set OPTIONS()
  
[0m02:40:55.105604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:4d351391-c520-40e9-9620-6c5701b4ac7f&page=queryresults
[0m02:40:55.109004 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.monzo_task.account_created"
[0m02:40:55.129809 [debug] [Thread-1 (]: Timing info for seed.monzo_task.account_created (execute): 02:40:39.171365 => 02:40:55.129407
[0m02:40:55.132598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e304b80>]}
[0m02:40:55.135461 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file monzo.account_created ............................... [[32mINSERT 12000[0m in 15.97s]
[0m02:40:55.138722 [debug] [Thread-1 (]: Finished running node seed.monzo_task.account_created
[0m02:40:55.141233 [debug] [Thread-1 (]: Began running node seed.monzo_task.account_reopened
[0m02:40:55.143735 [info ] [Thread-1 (]: 3 of 4 START seed file monzo.account_reopened .................................. [RUN]
[0m02:40:55.148352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.monzo_task.account_created, now seed.monzo_task.account_reopened)
[0m02:40:55.152314 [debug] [Thread-1 (]: Began compiling node seed.monzo_task.account_reopened
[0m02:40:55.156186 [debug] [Thread-1 (]: Timing info for seed.monzo_task.account_reopened (compile): 02:40:55.155662 => 02:40:55.155671
[0m02:40:55.158347 [debug] [Thread-1 (]: Began executing node seed.monzo_task.account_reopened
[0m02:40:55.174397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:41:02.786056 [debug] [Thread-1 (]: On seed.monzo_task.account_reopened: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "seed.monzo_task.account_reopened"} */

    alter table `silicon-parity-396203`.`monzo`.`account_reopened` set OPTIONS()
  
[0m02:41:04.431160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:5ef3d5c8-f2e8-4602-b8a5-7127e0495b7c&page=queryresults
[0m02:41:04.435511 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.monzo_task.account_reopened"
[0m02:41:04.466545 [debug] [Thread-1 (]: Timing info for seed.monzo_task.account_reopened (execute): 02:40:55.160351 => 02:41:04.466188
[0m02:41:04.469562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7da3c7c0>]}
[0m02:41:04.472191 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file monzo.account_reopened .............................. [[32mINSERT 7[0m in 9.32s]
[0m02:41:04.475272 [debug] [Thread-1 (]: Finished running node seed.monzo_task.account_reopened
[0m02:41:04.477700 [debug] [Thread-1 (]: Began running node seed.monzo_task.account_transactions
[0m02:41:04.480103 [info ] [Thread-1 (]: 4 of 4 START seed file monzo.account_transactions .............................. [RUN]
[0m02:41:04.483627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.monzo_task.account_reopened, now seed.monzo_task.account_transactions)
[0m02:41:04.486826 [debug] [Thread-1 (]: Began compiling node seed.monzo_task.account_transactions
[0m02:41:04.490613 [debug] [Thread-1 (]: Timing info for seed.monzo_task.account_transactions (compile): 02:41:04.489760 => 02:41:04.489774
[0m02:41:04.492981 [debug] [Thread-1 (]: Began executing node seed.monzo_task.account_transactions
[0m02:41:07.649078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:41:29.455003 [debug] [Thread-1 (]: On seed.monzo_task.account_transactions: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "seed.monzo_task.account_transactions"} */

    alter table `silicon-parity-396203`.`monzo`.`account_transactions` set OPTIONS()
  
[0m02:41:31.130131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:e58bb88d-b9bf-44f7-89e7-cae18bdc1db4&page=queryresults
[0m02:41:31.133087 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.monzo_task.account_transactions"
[0m02:41:31.149595 [debug] [Thread-1 (]: Timing info for seed.monzo_task.account_transactions (execute): 02:41:04.494893 => 02:41:31.149207
[0m02:41:31.152308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f23653-9a2d-4c32-b15e-012d2142da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e442950>]}
[0m02:41:31.154592 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file monzo.account_transactions .......................... [[32mINSERT 66666[0m in 26.67s]
[0m02:41:31.157804 [debug] [Thread-1 (]: Finished running node seed.monzo_task.account_transactions
[0m02:41:31.161988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:41:31.164114 [debug] [MainThread]: Connection 'seed.monzo_task.account_transactions' was properly closed.
[0m02:41:31.166851 [info ] [MainThread]: 
[0m02:41:31.171502 [info ] [MainThread]: Finished running 4 seeds in 0 hours 1 minutes and 9.94 seconds (69.94s).
[0m02:41:31.180642 [debug] [MainThread]: Command end result
[0m02:41:31.230724 [info ] [MainThread]: 
[0m02:41:31.237843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:41:31.242430 [info ] [MainThread]: 
[0m02:41:31.249025 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:41:31.255887 [debug] [MainThread]: Command `dbt seed` succeeded at 02:41:31.255456 after 75.01 seconds
[0m02:41:31.259014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc81d93610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e665960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7e64b130>]}
[0m02:41:31.262633 [debug] [MainThread]: Flushing usage events
[0m02:42:36.060394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f04193610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f0286c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f0286c100>]}


============================== 02:42:36.067254 | ffa331c4-f06d-4501-a33d-9c78d3462217 ==============================
[0m02:42:36.067254 [info ] [MainThread]: Running with dbt=1.5.5
[0m02:42:36.070192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True'}
[0m02:42:36.073228 [info ] [MainThread]: dbt version: 1.5.5
[0m02:42:36.078172 [info ] [MainThread]: python version: 3.10.12
[0m02:42:36.086184 [info ] [MainThread]: python path: /usr/local/airflow/dbt_venv/bin/python
[0m02:42:36.088855 [info ] [MainThread]: os info: Linux-5.15.90.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m02:42:36.092265 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/include/dbt/profiles.yml
[0m02:42:36.095284 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/include/dbt/dbt_project.yml
[0m02:42:36.101680 [info ] [MainThread]: Configuration:
[0m02:42:36.666818 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:42:36.726798 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:42:36.729614 [info ] [MainThread]: Required dependencies:
[0m02:42:36.733025 [debug] [MainThread]: Executing "git --help"
[0m02:42:36.737261 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m02:42:36.740356 [info ] [MainThread]: Connection:
[0m02:42:36.742896 [info ] [MainThread]:   method: service-account
[0m02:42:36.745303 [info ] [MainThread]:   database: silicon-parity-396203
[0m02:42:36.748074 [info ] [MainThread]:   schema: monzo
[0m02:42:36.751214 [info ] [MainThread]:   location: US
[0m02:42:36.755310 [info ] [MainThread]:   priority: None
[0m02:42:36.757726 [info ] [MainThread]:   timeout_seconds: 300
[0m02:42:36.760702 [info ] [MainThread]:   maximum_bytes_billed: None
[0m02:42:36.763331 [info ] [MainThread]:   execution_project: silicon-parity-396203
[0m02:42:36.767002 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m02:42:36.771325 [info ] [MainThread]:   job_retries: 1
[0m02:42:36.773905 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m02:42:36.776519 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m02:42:36.779718 [info ] [MainThread]:   gcs_bucket: None
[0m02:42:36.784291 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m02:42:36.789763 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m02:42:36.792034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:36.804359 [debug] [MainThread]: On debug: select 1 as id
[0m02:42:39.924961 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:f81a7426-f3c2-40f7-bd11-f4bd87301a91&page=queryresults
[0m02:42:39.926787 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:42:39.930213 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:42:39.934584 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m02:42:39.938643 [debug] [MainThread]: Command `dbt debug` failed at 02:42:39.938191 after 3.91 seconds
[0m02:42:39.941426 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:42:39.943274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f04193610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f007e5cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f007e6b30>]}
[0m02:42:39.945031 [debug] [MainThread]: Flushing usage events
[0m02:43:17.018551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a1d3ef610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a1bd085b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a1bd08040>]}


============================== 02:43:17.025320 | 4d564f67-8e27-4803-83d3-b0dfe30bec20 ==============================
[0m02:43:17.025320 [info ] [MainThread]: Running with dbt=1.5.5
[0m02:43:17.028206 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True'}
[0m02:43:17.637762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d564f67-8e27-4803-83d3-b0dfe30bec20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a19cb48e0>]}
[0m02:43:17.667387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d564f67-8e27-4803-83d3-b0dfe30bec20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a19ca4430>]}
[0m02:43:17.670152 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m02:43:17.730494 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m02:43:19.337146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:43:19.338784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:43:19.351398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d564f67-8e27-4803-83d3-b0dfe30bec20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a19969b40>]}
[0m02:43:19.385054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d564f67-8e27-4803-83d3-b0dfe30bec20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a19b21270>]}
[0m02:43:19.387336 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m02:43:19.391280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d564f67-8e27-4803-83d3-b0dfe30bec20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a19b22f50>]}
[0m02:43:19.396729 [info ] [MainThread]: 
[0m02:43:19.401889 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:43:19.407735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203'
[0m02:43:19.410021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:20.657270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silicon-parity-396203, now list_silicon-parity-396203_monzo)
[0m02:43:20.661329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:21.981991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d564f67-8e27-4803-83d3-b0dfe30bec20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a19b20d00>]}
[0m02:43:21.985026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:43:21.987965 [info ] [MainThread]: 
[0m02:43:22.013655 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_closed
[0m02:43:22.016523 [info ] [Thread-1 (]: 1 of 7 START sql incremental model monzo.stg_accounts_closed ................... [RUN]
[0m02:43:22.022802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_monzo, now model.monzo_task.stg_accounts_closed)
[0m02:43:22.025364 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_closed
[0m02:43:22.049113 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_closed"
[0m02:43:22.090834 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_closed (compile): 02:43:22.027411 => 02:43:22.089862
[0m02:43:22.093822 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_closed
[0m02:43:22.257848 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_closed"
[0m02:43:22.287334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:22.296235 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_closed: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_closed"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_closed`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(closed_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`monzo_task`.`account_closed`
    
    

)

SELECT * FROM source
    );
  
[0m02:43:23.688729 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_closed"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_closed`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(closed_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`monzo_task`.`account_closed`
    
    

)

SELECT * FROM source
    );
  
[0m02:43:23.692691 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset silicon-parity-396203:monzo_task was not found in location US

Location: US
Job ID: 98f837f9-158c-4cb7-8076-a43fe5b7459c

[0m02:43:23.696297 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_closed (execute): 02:43:22.096265 => 02:43:23.695695
[0m02:43:23.724449 [debug] [Thread-1 (]: Runtime Error in model stg_accounts_closed (models/staging/stg_accounts_closed.sql)
  404 Not found: Dataset silicon-parity-396203:monzo_task was not found in location US
  
  Location: US
  Job ID: 98f837f9-158c-4cb7-8076-a43fe5b7459c
  
[0m02:43:23.726711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d564f67-8e27-4803-83d3-b0dfe30bec20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a19849ea0>]}
[0m02:43:23.729237 [error] [Thread-1 (]: 1 of 7 ERROR creating sql incremental model monzo.stg_accounts_closed .......... [[31mERROR[0m in 1.70s]
[0m02:43:23.732149 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_closed
[0m02:43:23.735389 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_created
[0m02:43:23.738368 [info ] [Thread-1 (]: 2 of 7 START sql incremental model monzo.stg_accounts_created .................. [RUN]
[0m02:43:23.742764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_closed, now model.monzo_task.stg_accounts_created)
[0m02:43:23.745947 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_created
[0m02:43:23.756862 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_created"
[0m02:43:23.776383 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_created (compile): 02:43:23.748229 => 02:43:23.775830
[0m02:43:23.778534 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_created
[0m02:43:23.791083 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_created"
[0m02:43:23.808807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:23.817532 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_created: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_created"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_created`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(created_ts AS TIMESTAMP) as recorded_at,
        account_type,
        account_id_hashed as account_id,
        user_id_hashed as user_id
    FROM
      `silicon-parity-396203`.`monzo_task`.`account_created`
    
    

)

SELECT * FROM source
    );
  
[0m02:43:25.158450 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_created"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_created`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(created_ts AS TIMESTAMP) as recorded_at,
        account_type,
        account_id_hashed as account_id,
        user_id_hashed as user_id
    FROM
      `silicon-parity-396203`.`monzo_task`.`account_created`
    
    

)

SELECT * FROM source
    );
  
[0m02:43:25.165922 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset silicon-parity-396203:monzo_task was not found in location US

Location: US
Job ID: 8d7aaf0a-e868-4104-aeda-db49f845cbcc

[0m02:43:25.174805 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_created (execute): 02:43:23.780394 => 02:43:25.172942
[0m02:43:25.182866 [debug] [Thread-1 (]: Runtime Error in model stg_accounts_created (models/staging/stg_accounts_created.sql)
  404 Not found: Dataset silicon-parity-396203:monzo_task was not found in location US
  
  Location: US
  Job ID: 8d7aaf0a-e868-4104-aeda-db49f845cbcc
  
[0m02:43:25.187493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d564f67-8e27-4803-83d3-b0dfe30bec20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a19ca4100>]}
[0m02:43:25.193386 [error] [Thread-1 (]: 2 of 7 ERROR creating sql incremental model monzo.stg_accounts_created ......... [[31mERROR[0m in 1.44s]
[0m02:43:25.198930 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_created
[0m02:43:25.202441 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_reopened
[0m02:43:25.205777 [info ] [Thread-1 (]: 3 of 7 START sql incremental model monzo.stg_accounts_reopened ................. [RUN]
[0m02:43:25.209782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_created, now model.monzo_task.stg_accounts_reopened)
[0m02:43:25.212350 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_reopened
[0m02:43:25.224514 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_reopened"
[0m02:43:25.244242 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_reopened (compile): 02:43:25.214318 => 02:43:25.243616
[0m02:43:25.246365 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_reopened
[0m02:43:25.271159 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_reopened"
[0m02:43:25.288286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:25.296862 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_reopened: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_reopened"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(reopened_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`monzo_task`.`account_reopened`
    
    

)

SELECT * FROM source
    );
  
[0m02:43:26.760253 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_reopened"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(reopened_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`monzo_task`.`account_reopened`
    
    

)

SELECT * FROM source
    );
  
[0m02:43:26.766004 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset silicon-parity-396203:monzo_task was not found in location US

Location: US
Job ID: 9aea410b-b6f6-4a2b-8218-8a2a50b139d3

[0m02:43:26.770396 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_reopened (execute): 02:43:25.248278 => 02:43:26.768983
[0m02:43:26.775356 [debug] [Thread-1 (]: Runtime Error in model stg_accounts_reopened (models/staging/stg_accounts_reopened.sql)
  404 Not found: Dataset silicon-parity-396203:monzo_task was not found in location US
  
  Location: US
  Job ID: 9aea410b-b6f6-4a2b-8218-8a2a50b139d3
  
[0m02:43:26.778026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d564f67-8e27-4803-83d3-b0dfe30bec20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a19b20ac0>]}
[0m02:43:26.780987 [error] [Thread-1 (]: 3 of 7 ERROR creating sql incremental model monzo.stg_accounts_reopened ........ [[31mERROR[0m in 1.57s]
[0m02:43:26.784263 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_reopened
[0m02:43:26.787881 [debug] [Thread-1 (]: Began running node model.monzo_task.dim_accounts
[0m02:43:26.790268 [info ] [Thread-1 (]: 4 of 7 SKIP relation monzo.dim_accounts ........................................ [[33mSKIP[0m]
[0m02:43:26.794997 [debug] [Thread-1 (]: Finished running node model.monzo_task.dim_accounts
[0m02:43:26.799530 [debug] [Thread-1 (]: Began running node model.monzo_task.dim_users
[0m02:43:26.802101 [info ] [Thread-1 (]: 5 of 7 SKIP relation monzo.dim_users ........................................... [[33mSKIP[0m]
[0m02:43:26.807885 [debug] [Thread-1 (]: Finished running node model.monzo_task.dim_users
[0m02:43:26.811763 [debug] [Thread-1 (]: Began running node model.monzo_task.fct_transactions
[0m02:43:26.818669 [info ] [Thread-1 (]: 6 of 7 SKIP relation monzo.fct_transactions .................................... [[33mSKIP[0m]
[0m02:43:26.827328 [debug] [Thread-1 (]: Finished running node model.monzo_task.fct_transactions
[0m02:43:26.833730 [debug] [Thread-1 (]: Began running node model.monzo_task.report_7d_active_users
[0m02:43:26.837238 [info ] [Thread-1 (]: 7 of 7 SKIP relation monzo.report_7d_active_users .............................. [[33mSKIP[0m]
[0m02:43:26.844110 [debug] [Thread-1 (]: Finished running node model.monzo_task.report_7d_active_users
[0m02:43:26.850146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:26.852118 [debug] [MainThread]: Connection 'model.monzo_task.stg_accounts_reopened' was properly closed.
[0m02:43:26.856096 [info ] [MainThread]: 
[0m02:43:26.859735 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m02:43:26.871557 [debug] [MainThread]: Command end result
[0m02:43:26.932860 [info ] [MainThread]: 
[0m02:43:26.939688 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m02:43:26.943079 [info ] [MainThread]: 
[0m02:43:26.951325 [error] [MainThread]: [33mRuntime Error in model stg_accounts_closed (models/staging/stg_accounts_closed.sql)[0m
[0m02:43:26.959318 [error] [MainThread]:   404 Not found: Dataset silicon-parity-396203:monzo_task was not found in location US
[0m02:43:26.962955 [error] [MainThread]:   
[0m02:43:26.965989 [error] [MainThread]:   Location: US
[0m02:43:26.968419 [error] [MainThread]:   Job ID: 98f837f9-158c-4cb7-8076-a43fe5b7459c
[0m02:43:26.972489 [error] [MainThread]:   
[0m02:43:26.977127 [info ] [MainThread]: 
[0m02:43:26.980706 [error] [MainThread]: [33mRuntime Error in model stg_accounts_created (models/staging/stg_accounts_created.sql)[0m
[0m02:43:26.983522 [error] [MainThread]:   404 Not found: Dataset silicon-parity-396203:monzo_task was not found in location US
[0m02:43:26.986382 [error] [MainThread]:   
[0m02:43:26.993221 [error] [MainThread]:   Location: US
[0m02:43:26.996425 [error] [MainThread]:   Job ID: 8d7aaf0a-e868-4104-aeda-db49f845cbcc
[0m02:43:26.998845 [error] [MainThread]:   
[0m02:43:27.001549 [info ] [MainThread]: 
[0m02:43:27.005307 [error] [MainThread]: [33mRuntime Error in model stg_accounts_reopened (models/staging/stg_accounts_reopened.sql)[0m
[0m02:43:27.008808 [error] [MainThread]:   404 Not found: Dataset silicon-parity-396203:monzo_task was not found in location US
[0m02:43:27.011231 [error] [MainThread]:   
[0m02:43:27.014004 [error] [MainThread]:   Location: US
[0m02:43:27.016415 [error] [MainThread]:   Job ID: 9aea410b-b6f6-4a2b-8218-8a2a50b139d3
[0m02:43:27.019026 [error] [MainThread]:   
[0m02:43:27.023840 [info ] [MainThread]: 
[0m02:43:27.027042 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m02:43:27.029781 [debug] [MainThread]: Command `dbt run` failed at 02:43:27.029525 after 10.05 seconds
[0m02:43:27.031569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a1d3ef610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a18706500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a18704d60>]}
[0m02:43:27.033362 [debug] [MainThread]: Flushing usage events
[0m02:45:49.266056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d563f3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d54d0c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d54d0c040>]}


============================== 02:45:49.273530 | f486025e-8b78-4ff2-89bc-08330e688e3b ==============================
[0m02:45:49.273530 [info ] [MainThread]: Running with dbt=1.5.5
[0m02:45:49.276668 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m02:45:49.888056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d56380970>]}
[0m02:45:49.930967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d52cabfd0>]}
[0m02:45:49.934023 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m02:45:50.008464 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m02:45:51.757853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:45:51.760635 [debug] [MainThread]: Partial parsing: updated file: monzo_task://models/staging/_staging_sources.yml
[0m02:45:51.801978 [debug] [MainThread]: 1699: static parser successfully parsed analytics/report_7d_active_users.sql
[0m02:45:51.822724 [debug] [MainThread]: 1603: static parser failed on analytics/fct_transactions.sql
[0m02:45:51.855329 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/fct_transactions.sql
[0m02:45:51.859663 [debug] [MainThread]: 1603: static parser failed on analytics/dim_users.sql
[0m02:45:51.897962 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/dim_users.sql
[0m02:45:51.902611 [debug] [MainThread]: 1603: static parser failed on analytics/dim_accounts.sql
[0m02:45:51.918788 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/dim_accounts.sql
[0m02:45:51.923067 [debug] [MainThread]: 1603: static parser failed on staging/stg_accounts_closed.sql
[0m02:45:51.938890 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_accounts_closed.sql
[0m02:45:51.943529 [debug] [MainThread]: 1603: static parser failed on staging/stg_accounts_created.sql
[0m02:45:51.953454 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_accounts_created.sql
[0m02:45:51.957619 [debug] [MainThread]: 1603: static parser failed on staging/stg_accounts_reopened.sql
[0m02:45:51.967524 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_accounts_reopened.sql
[0m02:45:52.252521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5202d840>]}
[0m02:45:52.290419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d52b0ba90>]}
[0m02:45:52.292872 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m02:45:52.296278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d52b0bb20>]}
[0m02:45:52.302860 [info ] [MainThread]: 
[0m02:45:52.307942 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:45:52.312431 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203'
[0m02:45:52.314801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:53.755798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silicon-parity-396203, now list_silicon-parity-396203_monzo)
[0m02:45:53.759740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:54.921896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d52b0b010>]}
[0m02:45:54.925660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:45:54.929408 [info ] [MainThread]: 
[0m02:45:54.959090 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_closed
[0m02:45:54.961440 [info ] [Thread-1 (]: 1 of 7 START sql incremental model monzo.stg_accounts_closed ................... [RUN]
[0m02:45:54.964425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_monzo, now model.monzo_task.stg_accounts_closed)
[0m02:45:54.966753 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_closed
[0m02:45:54.984499 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_closed"
[0m02:45:55.005266 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_closed (compile): 02:45:54.968800 => 02:45:55.004346
[0m02:45:55.008277 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_closed
[0m02:45:55.197918 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_closed"
[0m02:45:55.214437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:55.223010 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_closed: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_closed"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_closed`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(closed_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`monzo`.`account_closed`
    
    

)

SELECT * FROM source
    );
  
[0m02:45:59.674990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:4c68d98c-caf7-4b33-9a14-00ed9d994ba2&page=queryresults
[0m02:45:59.711901 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_closed (execute): 02:45:55.010397 => 02:45:59.711556
[0m02:45:59.714834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5202ca30>]}
[0m02:45:59.717241 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model monzo.stg_accounts_closed .............. [[32mCREATE TABLE (4.0k rows, 478.1 KiB processed)[0m in 4.75s]
[0m02:45:59.720516 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_closed
[0m02:45:59.723269 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_created
[0m02:45:59.726136 [info ] [Thread-1 (]: 2 of 7 START sql incremental model monzo.stg_accounts_created .................. [RUN]
[0m02:45:59.729670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_closed, now model.monzo_task.stg_accounts_created)
[0m02:45:59.732496 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_created
[0m02:45:59.744573 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_created"
[0m02:45:59.763797 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_created (compile): 02:45:59.736311 => 02:45:59.763221
[0m02:45:59.766004 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_created
[0m02:45:59.778454 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_created"
[0m02:45:59.797004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:59.806212 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_created: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_created"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_created`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(created_ts AS TIMESTAMP) as recorded_at,
        account_type,
        account_id_hashed as account_id,
        user_id_hashed as user_id
    FROM
      `silicon-parity-396203`.`monzo`.`account_created`
    
    

)

SELECT * FROM source
    );
  
[0m02:46:04.661321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:b02b68c0-4613-4d71-a0c1-afa9b57c8801&page=queryresults
[0m02:46:04.666258 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_created (execute): 02:45:59.767916 => 02:46:04.665815
[0m02:46:04.669141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d529770d0>]}
[0m02:46:04.671930 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model monzo.stg_accounts_created ............. [[32mCREATE TABLE (12.0k rows, 2.6 MiB processed)[0m in 4.94s]
[0m02:46:04.675997 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_created
[0m02:46:04.678603 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_reopened
[0m02:46:04.681029 [info ] [Thread-1 (]: 3 of 7 START sql incremental model monzo.stg_accounts_reopened ................. [RUN]
[0m02:46:04.684560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_created, now model.monzo_task.stg_accounts_reopened)
[0m02:46:04.687337 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_reopened
[0m02:46:04.697624 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_reopened"
[0m02:46:04.717616 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_reopened (compile): 02:46:04.690346 => 02:46:04.717044
[0m02:46:04.719887 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_reopened
[0m02:46:04.731405 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_reopened"
[0m02:46:04.749284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:04.759375 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_reopened: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_reopened"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(reopened_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`monzo`.`account_reopened`
    
    

)

SELECT * FROM source
    );
  
[0m02:46:09.925808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:9f23168d-ca78-48ca-979e-b316d17cf272&page=queryresults
[0m02:46:09.931108 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_reopened (execute): 02:46:04.722052 => 02:46:09.930753
[0m02:46:09.933791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d52977b50>]}
[0m02:46:09.936561 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model monzo.stg_accounts_reopened ............ [[32mCREATE TABLE (7.0 rows, 854.0 Bytes processed)[0m in 5.25s]
[0m02:46:09.941961 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_reopened
[0m02:46:09.945824 [debug] [Thread-1 (]: Began running node model.monzo_task.dim_accounts
[0m02:46:09.948632 [info ] [Thread-1 (]: 4 of 7 START sql view model monzo.dim_accounts ................................. [RUN]
[0m02:46:09.959859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_reopened, now model.monzo_task.dim_accounts)
[0m02:46:09.965215 [debug] [Thread-1 (]: Began compiling node model.monzo_task.dim_accounts
[0m02:46:10.029503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:11.762419 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.dim_accounts"
[0m02:46:11.788846 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_accounts (compile): 02:46:09.967736 => 02:46:11.788285
[0m02:46:11.791562 [debug] [Thread-1 (]: Began executing node model.monzo_task.dim_accounts
[0m02:46:11.828930 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.dim_accounts"
[0m02:46:11.851018 [debug] [Thread-1 (]: On model.monzo_task.dim_accounts: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.dim_accounts"} */


  create or replace view `silicon-parity-396203`.`monzo`.`dim_accounts`
  OPTIONS()
  as 

WITH account_meta AS (

    SELECT
        `account_type`,
  `account_id`,
  `user_id`
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

),

spine AS (

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('true' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

    UNION ALL

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('false' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_closed`

    UNION ALL

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('true' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
    
)

SELECT
    to_hex(md5(cast(coalesce(cast(spine.account_id as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(spine.recorded_at as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS surrogate_key,
    spine.account_id as natural_key,
    spine.is_open,
    account_meta.`account_type`,
  account_meta.`user_id`,
    spine.recorded_at as valid_from,
    COALESCE(LEAD(spine.recorded_at) OVER (PARTITION BY spine.account_id ORDER BY spine.recorded_at ASC), CURRENT_TIMESTAMP()) AS valid_to
FROM
    spine
    INNER JOIN account_meta ON account_meta.account_id = spine.account_id
ORDER BY
    natural_key,
    valid_from;


[0m02:46:13.626913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:a21891bc-1604-47aa-a1b8-ea854a1e974a&page=queryresults
[0m02:46:13.632852 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_accounts (execute): 02:46:11.793870 => 02:46:13.632390
[0m02:46:13.635636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5202ca30>]}
[0m02:46:13.638289 [info ] [Thread-1 (]: 4 of 7 OK created sql view model monzo.dim_accounts ............................ [[32mCREATE VIEW (0 processed)[0m in 3.68s]
[0m02:46:13.641705 [debug] [Thread-1 (]: Finished running node model.monzo_task.dim_accounts
[0m02:46:13.645188 [debug] [Thread-1 (]: Began running node model.monzo_task.dim_users
[0m02:46:13.647839 [info ] [Thread-1 (]: 5 of 7 START sql view model monzo.dim_users .................................... [RUN]
[0m02:46:13.651471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.dim_accounts, now model.monzo_task.dim_users)
[0m02:46:13.654528 [debug] [Thread-1 (]: Began compiling node model.monzo_task.dim_users
[0m02:46:13.669674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:14.920921 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.dim_users"
[0m02:46:14.958936 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_users (compile): 02:46:13.657725 => 02:46:14.957889
[0m02:46:14.962267 [debug] [Thread-1 (]: Began executing node model.monzo_task.dim_users
[0m02:46:14.973940 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.dim_users"
[0m02:46:14.992615 [debug] [Thread-1 (]: On model.monzo_task.dim_users: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.dim_users"} */


  create or replace view `silicon-parity-396203`.`monzo`.`dim_users`
  OPTIONS()
  as 

WITH account_meta AS (

    SELECT
        `account_type`,
  `account_id`,
  `user_id`
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

),

spine AS (

    SELECT DISTINCT
        user_id,
        recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

    UNION ALL

    SELECT DISTINCT
        account_meta.user_id,
        stg_accounts_closed.recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_closed`
        INNER JOIN account_meta ON account_meta.account_id = stg_accounts_closed.account_id

    UNION ALL

    SELECT DISTINCT
        account_meta.user_id,
        stg_accounts_reopened.recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
        INNER JOIN account_meta ON account_meta.account_id = stg_accounts_reopened.account_id
    
),

first_created AS (

    SELECT
        user_id,
        MIN(recorded_at) as recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`
    GROUP BY
        1

),

aggregates AS (

    SELECT
        spine.user_id,
        spine.recorded_at,
        COUNT(DISTINCT dim_accounts.natural_key) AS open_account_total,
        STRING_AGG(DISTINCT dim_accounts.natural_key) as open_accounts,
        STRING_AGG(DISTINCT dim_accounts.account_type) as open_account_types
    FROM
        spine
        LEFT JOIN `silicon-parity-396203`.`monzo`.`dim_accounts` ON dim_accounts.user_id = spine.user_id
            AND dim_accounts.valid_from <= spine.recorded_at
            AND dim_accounts.valid_to > spine.recorded_at
            AND dim_accounts.is_open
    GROUP BY
        1,2

)

SELECT
    to_hex(md5(cast(coalesce(cast(aggregates.user_id as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(aggregates.recorded_at as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS surrogate_key,
    aggregates.user_id as natural_key,
    first_created.recorded_at as first_created,
    aggregates.open_account_total,
    aggregates.open_accounts,
    aggregates.open_account_types,
    aggregates.recorded_at as valid_from,
    COALESCE(LEAD(aggregates.recorded_at) OVER (PARTITION BY aggregates.user_id ORDER BY aggregates.recorded_at ASC), CURRENT_TIMESTAMP()) AS valid_to
FROM
    aggregates
    LEFT JOIN first_created ON first_created.user_id = aggregates.user_id
ORDER BY
    natural_key,
    valid_from;


[0m02:46:16.774638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:6d0b74f7-d7e1-451d-8b80-3cf0ca133341&page=queryresults
[0m02:46:16.788882 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_users (execute): 02:46:14.965744 => 02:46:16.787866
[0m02:46:16.793768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d529aaaa0>]}
[0m02:46:16.797885 [info ] [Thread-1 (]: 5 of 7 OK created sql view model monzo.dim_users ............................... [[32mCREATE VIEW (0 processed)[0m in 3.14s]
[0m02:46:16.802720 [debug] [Thread-1 (]: Finished running node model.monzo_task.dim_users
[0m02:46:16.807089 [debug] [Thread-1 (]: Began running node model.monzo_task.fct_transactions
[0m02:46:16.809573 [info ] [Thread-1 (]: 6 of 7 START sql view model monzo.fct_transactions ............................. [RUN]
[0m02:46:16.813051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.dim_users, now model.monzo_task.fct_transactions)
[0m02:46:16.816785 [debug] [Thread-1 (]: Began compiling node model.monzo_task.fct_transactions
[0m02:46:16.828115 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.fct_transactions"
[0m02:46:16.854249 [debug] [Thread-1 (]: Timing info for model.monzo_task.fct_transactions (compile): 02:46:16.819123 => 02:46:16.853558
[0m02:46:16.856678 [debug] [Thread-1 (]: Began executing node model.monzo_task.fct_transactions
[0m02:46:16.885456 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.fct_transactions"
[0m02:46:16.903634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:16.911678 [debug] [Thread-1 (]: On model.monzo_task.fct_transactions: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.fct_transactions"} */


  create or replace view `silicon-parity-396203`.`monzo`.`fct_transactions`
  OPTIONS()
  as 

SELECT
    to_hex(md5(cast(coalesce(cast(account_transactions.date as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_transactions.account_id_hashed as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_transactions.transactions_num as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS unique_key,
    CAST(account_transactions.date AS TIMESTAMP) as recorded_at,
    account_transactions.account_id_hashed as account_natural_key,
    account_transactions.transactions_num,
    dim_accounts.surrogate_key as account_surrogate_key,
    dim_users.surrogate_key as user_surrogate_key
FROM
    `silicon-parity-396203`.`monzo`.`account_transactions`
    INNER JOIN `silicon-parity-396203`.`monzo`.`dim_accounts` ON dim_accounts.natural_key = account_transactions.account_id_hashed
        AND dim_accounts.valid_from <= CAST(account_transactions.date AS TIMESTAMP)
        AND dim_accounts.valid_to > CAST(account_transactions.date AS TIMESTAMP)
    INNER JOIN `silicon-parity-396203`.`monzo`.`dim_users` ON dim_users.natural_key = dim_accounts.user_id
        AND dim_users.valid_from <= CAST(account_transactions.date AS TIMESTAMP)
        AND dim_users.valid_to > CAST(account_transactions.date AS TIMESTAMP);


[0m02:46:20.148155 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:86e116e0-6373-4294-b7ab-6b22f478178d&page=queryresults
[0m02:46:20.154597 [debug] [Thread-1 (]: Timing info for model.monzo_task.fct_transactions (execute): 02:46:16.858766 => 02:46:20.154067
[0m02:46:20.158168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5299dfc0>]}
[0m02:46:20.161430 [info ] [Thread-1 (]: 6 of 7 OK created sql view model monzo.fct_transactions ........................ [[32mCREATE VIEW (0 processed)[0m in 3.35s]
[0m02:46:20.165940 [debug] [Thread-1 (]: Finished running node model.monzo_task.fct_transactions
[0m02:46:20.171076 [debug] [Thread-1 (]: Began running node model.monzo_task.report_7d_active_users
[0m02:46:20.174157 [info ] [Thread-1 (]: 7 of 7 START sql view model monzo.report_7d_active_users ....................... [RUN]
[0m02:46:20.178031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.fct_transactions, now model.monzo_task.report_7d_active_users)
[0m02:46:20.180895 [debug] [Thread-1 (]: Began compiling node model.monzo_task.report_7d_active_users
[0m02:46:20.195306 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.report_7d_active_users"
[0m02:46:20.214316 [debug] [Thread-1 (]: Timing info for model.monzo_task.report_7d_active_users (compile): 02:46:20.184437 => 02:46:20.213784
[0m02:46:20.218048 [debug] [Thread-1 (]: Began executing node model.monzo_task.report_7d_active_users
[0m02:46:20.226107 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.report_7d_active_users"
[0m02:46:20.245357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:20.254968 [debug] [Thread-1 (]: On model.monzo_task.report_7d_active_users: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.report_7d_active_users"} */


  create or replace view `silicon-parity-396203`.`monzo`.`report_7d_active_users`
  OPTIONS()
  as 

WITH spine AS (

  SELECT 
    CAST(day AS TIMESTAMP) as day
  FROM 
    UNNEST(GENERATE_DATE_ARRAY(DATE('2019-01-14'), DATE('2020-01-01'), INTERVAL 1 DAY)) as day

),

users_daily AS (

  SELECT
    spine.day,
    dim_users.natural_key
  FROM
    spine
    INNER JOIN `silicon-parity-396203`.`monzo`.`dim_users` ON dim_users.valid_from <= spine.day
      AND dim_users.valid_to > spine.day
      AND dim_users.open_account_total > 0

),

users_7d AS (

  SELECT
    spine.day as period_start,
    COUNT(DISTINCT users_daily.natural_key) as total_users
  FROM
    spine
    LEFT JOIN users_daily ON users_daily.day >= spine.day
      AND users_daily.day < DATE_ADD(spine.day, INTERVAL 7 DAY)
  GROUP BY
    1

),

transactions_7d AS (

  SELECT
    spine.day as period_start,
    COUNT(fct_transactions.unique_key) as total_transactions,
    COUNT(DISTINCT dim_users.natural_key) as active_users
  FROM
    spine
    LEFT JOIN `silicon-parity-396203`.`monzo`.`fct_transactions` ON fct_transactions.recorded_at >= spine.day
      AND fct_transactions.recorded_at < DATE_ADD(spine.day, INTERVAL 7 DAY)
    LEFT JOIN `silicon-parity-396203`.`monzo`.`dim_users` ON dim_users.surrogate_key = fct_transactions.user_surrogate_key
  GROUP BY
    1

)

SELECT
  spine.day as period_start,
  DATE_ADD(spine.day, INTERVAL 6 DAY) as period_end,
  users_7d.total_users,
  transactions_7d.active_users,
  transactions_7d.total_transactions,
  ROUND(CAST(active_users/total_users AS DECIMAL), 2) as active_users_7d
FROM
  spine
  LEFT JOIN users_7d ON users_7d.period_start = spine.day
  LEFT JOIN transactions_7d ON transactions_7d.period_start = spine.day
ORDER BY
  1;


[0m02:46:22.944095 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:00b60c8c-a8bb-480c-8662-893144af0a0c&page=queryresults
[0m02:46:22.962457 [debug] [Thread-1 (]: Timing info for model.monzo_task.report_7d_active_users (execute): 02:46:20.220709 => 02:46:22.958911
[0m02:46:22.975723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f486025e-8b78-4ff2-89bc-08330e688e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d529c61a0>]}
[0m02:46:22.984687 [info ] [Thread-1 (]: 7 of 7 OK created sql view model monzo.report_7d_active_users .................. [[32mCREATE VIEW (0 processed)[0m in 2.80s]
[0m02:46:22.993430 [debug] [Thread-1 (]: Finished running node model.monzo_task.report_7d_active_users
[0m02:46:23.001062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:46:23.003783 [debug] [MainThread]: Connection 'model.monzo_task.report_7d_active_users' was properly closed.
[0m02:46:23.006538 [info ] [MainThread]: 
[0m02:46:23.010845 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 30.70 seconds (30.70s).
[0m02:46:23.027341 [debug] [MainThread]: Command end result
[0m02:46:23.064695 [info ] [MainThread]: 
[0m02:46:23.071051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:46:23.074939 [info ] [MainThread]: 
[0m02:46:23.078435 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m02:46:23.082088 [debug] [MainThread]: Command `dbt run` succeeded at 02:46:23.081670 after 33.85 seconds
[0m02:46:23.089045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d563f3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d56383910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d563060b0>]}
[0m02:46:23.091451 [debug] [MainThread]: Flushing usage events
[0m02:56:56.691306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fa623610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f8d545b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f8d54040>]}


============================== 02:56:56.698923 | 5f0edd36-8d0b-4f14-9efc-87a24edfe2ed ==============================
[0m02:56:56.698923 [info ] [MainThread]: Running with dbt=1.5.5
[0m02:56:56.701419 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False'}
[0m02:56:57.432105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fa185630>]}
[0m02:56:57.464373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f6cb2860>]}
[0m02:56:57.466845 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m02:56:57.527576 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m02:56:59.483304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:56:59.484854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:56:59.497517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f6973f10>]}
[0m02:56:59.532368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f6b26170>]}
[0m02:56:59.535112 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m02:56:59.537793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f6b27e50>]}
[0m02:56:59.545380 [info ] [MainThread]: 
[0m02:56:59.548452 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:56:59.552397 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203'
[0m02:56:59.554378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:00.863253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silicon-parity-396203, now list_silicon-parity-396203_monzo)
[0m02:57:00.867137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:02.282542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f6b25c00>]}
[0m02:57:02.285861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:57:02.288542 [info ] [MainThread]: 
[0m02:57:02.322515 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_closed
[0m02:57:02.326209 [info ] [Thread-1 (]: 1 of 7 START sql incremental model monzo.stg_accounts_closed ................... [RUN]
[0m02:57:02.328978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_monzo, now model.monzo_task.stg_accounts_closed)
[0m02:57:02.331145 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_closed
[0m02:57:02.362704 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_closed"
[0m02:57:02.385241 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_closed (compile): 02:57:02.333739 => 02:57:02.384393
[0m02:57:02.387449 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_closed
[0m02:57:02.512117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:02.521105 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_closed: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_closed"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_closed__dbt_tmp`
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH source as (
    
    SELECT
        CAST(closed_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`monzo`.`account_closed`
    
    

  -- this filter will only be applied on an incremental run
    WHERE closed_ts > (SELECT max(closed_ts) FROM `silicon-parity-396203`.`monzo`.`stg_accounts_closed`)

    

)

SELECT * FROM source
    );
  
[0m02:57:10.273522 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:0c86d3a9-83e1-4c5a-83c1-559230ec405c&page=queryresults
[0m02:57:11.351906 [debug] [Thread-1 (]: 
    In `silicon-parity-396203`.`monzo`.`stg_accounts_closed`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m02:57:11.395590 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_closed"
[0m02:57:11.415103 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_closed: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_closed"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `silicon-parity-396203`.`monzo`.`stg_accounts_closed` as DBT_INTERNAL_DEST
        using (
        select
        * from `silicon-parity-396203`.`monzo`.`stg_accounts_closed__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`recorded_at`, `account_id`)
    values
        (`recorded_at`, `account_id`)


    
[0m02:57:14.571544 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:8e004d17-442c-4d6b-9b80-f37291db91e3&page=queryresults
[0m02:57:14.614880 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_closed (execute): 02:57:02.389524 => 02:57:14.614517
[0m02:57:14.617451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f687f070>]}
[0m02:57:14.619933 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model monzo.stg_accounts_closed .............. [[32mMERGE (0.0 rows, 0 processed)[0m in 12.29s]
[0m02:57:14.622882 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_closed
[0m02:57:14.625397 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_created
[0m02:57:14.627878 [info ] [Thread-1 (]: 2 of 7 START sql incremental model monzo.stg_accounts_created .................. [RUN]
[0m02:57:14.632257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_closed, now model.monzo_task.stg_accounts_created)
[0m02:57:14.634566 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_created
[0m02:57:14.642192 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_created"
[0m02:57:14.659912 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_created (compile): 02:57:14.636410 => 02:57:14.659265
[0m02:57:14.662485 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_created
[0m02:57:14.679925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:14.689512 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_created: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_created"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_created__dbt_tmp`
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH source as (
    
    SELECT
        CAST(created_ts AS TIMESTAMP) as recorded_at,
        account_type,
        account_id_hashed as account_id,
        user_id_hashed as user_id
    FROM
      `silicon-parity-396203`.`monzo`.`account_created`
    
    

  -- this filter will only be applied on an incremental run
    WHERE created_ts > (SELECT max(created_ts) FROM `silicon-parity-396203`.`monzo`.`stg_accounts_created`)

    

)

SELECT * FROM source
    );
  
[0m02:57:47.542704 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:7772197d-a9be-47b5-a7fe-14a229288e7e&page=queryresults
[0m02:57:48.588771 [debug] [Thread-1 (]: 
    In `silicon-parity-396203`.`monzo`.`stg_accounts_created`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m02:57:48.601939 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_created"
[0m02:57:48.621330 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_created: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_created"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `silicon-parity-396203`.`monzo`.`stg_accounts_created` as DBT_INTERNAL_DEST
        using (
        select
        * from `silicon-parity-396203`.`monzo`.`stg_accounts_created__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`recorded_at`, `account_type`, `account_id`, `user_id`)
    values
        (`recorded_at`, `account_type`, `account_id`, `user_id`)


    
[0m02:57:51.736399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:542c1466-d210-410e-860f-6a36648d1473&page=queryresults
[0m02:57:51.747872 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_created (execute): 02:57:14.664440 => 02:57:51.746789
[0m02:57:51.752911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f6971750>]}
[0m02:57:51.757691 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model monzo.stg_accounts_created ............. [[32mMERGE (0.0 rows, 0 processed)[0m in 37.12s]
[0m02:57:51.764153 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_created
[0m02:57:51.769191 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_reopened
[0m02:57:51.773502 [info ] [Thread-1 (]: 3 of 7 START sql incremental model monzo.stg_accounts_reopened ................. [RUN]
[0m02:57:51.777793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_created, now model.monzo_task.stg_accounts_reopened)
[0m02:57:51.782073 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_reopened
[0m02:57:51.795082 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_reopened"
[0m02:57:51.814928 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_reopened (compile): 02:57:51.784847 => 02:57:51.814413
[0m02:57:51.817190 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_reopened
[0m02:57:51.825324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:51.836494 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_reopened: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_reopened"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_reopened__dbt_tmp`
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH source as (
    
    SELECT
        CAST(reopened_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`monzo`.`account_reopened`
    
    

  -- this filter will only be applied on an incremental run
    WHERE reopened_ts > (SELECT max(reopened_ts) FROM `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`)

    

)

SELECT * FROM source
    );
  
[0m02:57:56.566306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:61f2ffaa-1947-4f98-b8b5-a809fa0148e4&page=queryresults
[0m02:57:57.610763 [debug] [Thread-1 (]: 
    In `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m02:57:57.627103 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_reopened"
[0m02:57:57.651716 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_reopened: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_reopened"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `silicon-parity-396203`.`monzo`.`stg_accounts_reopened` as DBT_INTERNAL_DEST
        using (
        select
        * from `silicon-parity-396203`.`monzo`.`stg_accounts_reopened__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`recorded_at`, `account_id`)
    values
        (`recorded_at`, `account_id`)


    
[0m02:58:00.592557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:4f4f8d92-a7ec-4bcf-ac59-4cb2f8b6ec7b&page=queryresults
[0m02:58:00.597054 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_reopened (execute): 02:57:51.819039 => 02:58:00.596662
[0m02:58:00.600762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f69e2d70>]}
[0m02:58:00.603518 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model monzo.stg_accounts_reopened ............ [[32mMERGE (0.0 rows, 0 processed)[0m in 8.82s]
[0m02:58:00.606456 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_reopened
[0m02:58:00.609852 [debug] [Thread-1 (]: Began running node model.monzo_task.dim_accounts
[0m02:58:00.612728 [info ] [Thread-1 (]: 4 of 7 START sql view model monzo.dim_accounts ................................. [RUN]
[0m02:58:00.616546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_reopened, now model.monzo_task.dim_accounts)
[0m02:58:00.619765 [debug] [Thread-1 (]: Began compiling node model.monzo_task.dim_accounts
[0m02:58:00.665081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:02.883710 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.dim_accounts"
[0m02:58:02.909827 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_accounts (compile): 02:58:00.621608 => 02:58:02.908990
[0m02:58:02.912667 [debug] [Thread-1 (]: Began executing node model.monzo_task.dim_accounts
[0m02:58:02.975080 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.dim_accounts"
[0m02:58:02.989460 [debug] [Thread-1 (]: On model.monzo_task.dim_accounts: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.dim_accounts"} */


  create or replace view `silicon-parity-396203`.`monzo`.`dim_accounts`
  OPTIONS()
  as 

WITH account_meta AS (

    SELECT
        `account_type`,
  `account_id`,
  `user_id`
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

),

spine AS (

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('true' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

    UNION ALL

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('false' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_closed`

    UNION ALL

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('true' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
    
)

SELECT
    to_hex(md5(cast(coalesce(cast(spine.account_id as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(spine.recorded_at as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS surrogate_key,
    spine.account_id as natural_key,
    spine.is_open,
    account_meta.`account_type`,
  account_meta.`user_id`,
    spine.recorded_at as valid_from,
    COALESCE(LEAD(spine.recorded_at) OVER (PARTITION BY spine.account_id ORDER BY spine.recorded_at ASC), CURRENT_TIMESTAMP()) AS valid_to
FROM
    spine
    INNER JOIN account_meta ON account_meta.account_id = spine.account_id
ORDER BY
    natural_key,
    valid_from;


[0m02:58:04.576575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:4ad50fce-56f9-461b-9f13-461c42c959bc&page=queryresults
[0m02:58:04.598014 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_accounts (execute): 02:58:02.914895 => 02:58:04.597495
[0m02:58:04.603225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f69e2e30>]}
[0m02:58:04.605932 [info ] [Thread-1 (]: 4 of 7 OK created sql view model monzo.dim_accounts ............................ [[32mCREATE VIEW (0 processed)[0m in 3.99s]
[0m02:58:04.608992 [debug] [Thread-1 (]: Finished running node model.monzo_task.dim_accounts
[0m02:58:04.612191 [debug] [Thread-1 (]: Began running node model.monzo_task.dim_users
[0m02:58:04.614325 [info ] [Thread-1 (]: 5 of 7 START sql view model monzo.dim_users .................................... [RUN]
[0m02:58:04.616940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.dim_accounts, now model.monzo_task.dim_users)
[0m02:58:04.619936 [debug] [Thread-1 (]: Began compiling node model.monzo_task.dim_users
[0m02:58:04.630461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:05.936246 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.dim_users"
[0m02:58:05.966932 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_users (compile): 02:58:04.621651 => 02:58:05.966306
[0m02:58:05.970489 [debug] [Thread-1 (]: Began executing node model.monzo_task.dim_users
[0m02:58:05.986395 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.dim_users"
[0m02:58:06.005632 [debug] [Thread-1 (]: On model.monzo_task.dim_users: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.dim_users"} */


  create or replace view `silicon-parity-396203`.`monzo`.`dim_users`
  OPTIONS()
  as 

WITH account_meta AS (

    SELECT
        `account_type`,
  `account_id`,
  `user_id`
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

),

spine AS (

    SELECT DISTINCT
        user_id,
        recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

    UNION ALL

    SELECT DISTINCT
        account_meta.user_id,
        stg_accounts_closed.recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_closed`
        INNER JOIN account_meta ON account_meta.account_id = stg_accounts_closed.account_id

    UNION ALL

    SELECT DISTINCT
        account_meta.user_id,
        stg_accounts_reopened.recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
        INNER JOIN account_meta ON account_meta.account_id = stg_accounts_reopened.account_id
    
),

first_created AS (

    SELECT
        user_id,
        MIN(recorded_at) as recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`
    GROUP BY
        1

),

aggregates AS (

    SELECT
        spine.user_id,
        spine.recorded_at,
        COUNT(DISTINCT dim_accounts.natural_key) AS open_account_total,
        STRING_AGG(DISTINCT dim_accounts.natural_key) as open_accounts,
        STRING_AGG(DISTINCT dim_accounts.account_type) as open_account_types
    FROM
        spine
        LEFT JOIN `silicon-parity-396203`.`monzo`.`dim_accounts` ON dim_accounts.user_id = spine.user_id
            AND dim_accounts.valid_from <= spine.recorded_at
            AND dim_accounts.valid_to > spine.recorded_at
            AND dim_accounts.is_open
    GROUP BY
        1,2

)

SELECT
    to_hex(md5(cast(coalesce(cast(aggregates.user_id as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(aggregates.recorded_at as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS surrogate_key,
    aggregates.user_id as natural_key,
    first_created.recorded_at as first_created,
    aggregates.open_account_total,
    aggregates.open_accounts,
    aggregates.open_account_types,
    aggregates.recorded_at as valid_from,
    COALESCE(LEAD(aggregates.recorded_at) OVER (PARTITION BY aggregates.user_id ORDER BY aggregates.recorded_at ASC), CURRENT_TIMESTAMP()) AS valid_to
FROM
    aggregates
    LEFT JOIN first_created ON first_created.user_id = aggregates.user_id
ORDER BY
    natural_key,
    valid_from;


[0m02:58:07.785911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:cefe1b92-8eb7-421f-bb2c-d4a7a0853933&page=queryresults
[0m02:58:07.808427 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_users (execute): 02:58:05.972944 => 02:58:07.807306
[0m02:58:07.813243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f6a44b20>]}
[0m02:58:07.817133 [info ] [Thread-1 (]: 5 of 7 OK created sql view model monzo.dim_users ............................... [[32mCREATE VIEW (0 processed)[0m in 3.20s]
[0m02:58:07.822241 [debug] [Thread-1 (]: Finished running node model.monzo_task.dim_users
[0m02:58:07.825876 [debug] [Thread-1 (]: Began running node model.monzo_task.fct_transactions
[0m02:58:07.828420 [info ] [Thread-1 (]: 6 of 7 START sql view model monzo.fct_transactions ............................. [RUN]
[0m02:58:07.831363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.dim_users, now model.monzo_task.fct_transactions)
[0m02:58:07.833750 [debug] [Thread-1 (]: Began compiling node model.monzo_task.fct_transactions
[0m02:58:07.845896 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.fct_transactions"
[0m02:58:07.864466 [debug] [Thread-1 (]: Timing info for model.monzo_task.fct_transactions (compile): 02:58:07.835775 => 02:58:07.863989
[0m02:58:07.866503 [debug] [Thread-1 (]: Began executing node model.monzo_task.fct_transactions
[0m02:58:07.874562 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.fct_transactions"
[0m02:58:07.891983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:07.900798 [debug] [Thread-1 (]: On model.monzo_task.fct_transactions: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.fct_transactions"} */


  create or replace view `silicon-parity-396203`.`monzo`.`fct_transactions`
  OPTIONS()
  as 

SELECT
    to_hex(md5(cast(coalesce(cast(account_transactions.date as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_transactions.account_id_hashed as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_transactions.transactions_num as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS unique_key,
    CAST(account_transactions.date AS TIMESTAMP) as recorded_at,
    account_transactions.account_id_hashed as account_natural_key,
    account_transactions.transactions_num,
    dim_accounts.surrogate_key as account_surrogate_key,
    dim_users.surrogate_key as user_surrogate_key
FROM
    `silicon-parity-396203`.`monzo`.`account_transactions`
    INNER JOIN `silicon-parity-396203`.`monzo`.`dim_accounts` ON dim_accounts.natural_key = account_transactions.account_id_hashed
        AND dim_accounts.valid_from <= CAST(account_transactions.date AS TIMESTAMP)
        AND dim_accounts.valid_to > CAST(account_transactions.date AS TIMESTAMP)
    INNER JOIN `silicon-parity-396203`.`monzo`.`dim_users` ON dim_users.natural_key = dim_accounts.user_id
        AND dim_users.valid_from <= CAST(account_transactions.date AS TIMESTAMP)
        AND dim_users.valid_to > CAST(account_transactions.date AS TIMESTAMP);


[0m02:58:11.286824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:c455daf1-1249-43cb-a7f7-0bc61005eafd&page=queryresults
[0m02:58:11.309452 [debug] [Thread-1 (]: Timing info for model.monzo_task.fct_transactions (execute): 02:58:07.868413 => 02:58:11.308695
[0m02:58:11.314167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f689a410>]}
[0m02:58:11.318077 [info ] [Thread-1 (]: 6 of 7 OK created sql view model monzo.fct_transactions ........................ [[32mCREATE VIEW (0 processed)[0m in 3.48s]
[0m02:58:11.322705 [debug] [Thread-1 (]: Finished running node model.monzo_task.fct_transactions
[0m02:58:11.326766 [debug] [Thread-1 (]: Began running node model.monzo_task.report_7d_active_users
[0m02:58:11.329903 [info ] [Thread-1 (]: 7 of 7 START sql view model monzo.report_7d_active_users ....................... [RUN]
[0m02:58:11.333057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.fct_transactions, now model.monzo_task.report_7d_active_users)
[0m02:58:11.335254 [debug] [Thread-1 (]: Began compiling node model.monzo_task.report_7d_active_users
[0m02:58:11.356764 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.report_7d_active_users"
[0m02:58:11.371686 [debug] [Thread-1 (]: Timing info for model.monzo_task.report_7d_active_users (compile): 02:58:11.337377 => 02:58:11.370705
[0m02:58:11.373733 [debug] [Thread-1 (]: Began executing node model.monzo_task.report_7d_active_users
[0m02:58:11.380192 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.report_7d_active_users"
[0m02:58:11.395758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:11.403751 [debug] [Thread-1 (]: On model.monzo_task.report_7d_active_users: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.report_7d_active_users"} */


  create or replace view `silicon-parity-396203`.`monzo`.`report_7d_active_users`
  OPTIONS()
  as 

WITH spine AS (

  SELECT 
    CAST(day AS TIMESTAMP) as day
  FROM 
    UNNEST(GENERATE_DATE_ARRAY(DATE('2019-01-14'), DATE('2020-01-01'), INTERVAL 1 DAY)) as day

),

users_daily AS (

  SELECT
    spine.day,
    dim_users.natural_key
  FROM
    spine
    INNER JOIN `silicon-parity-396203`.`monzo`.`dim_users` ON dim_users.valid_from <= spine.day
      AND dim_users.valid_to > spine.day
      AND dim_users.open_account_total > 0

),

users_7d AS (

  SELECT
    spine.day as period_start,
    COUNT(DISTINCT users_daily.natural_key) as total_users
  FROM
    spine
    LEFT JOIN users_daily ON users_daily.day >= spine.day
      AND users_daily.day < DATE_ADD(spine.day, INTERVAL 7 DAY)
  GROUP BY
    1

),

transactions_7d AS (

  SELECT
    spine.day as period_start,
    COUNT(fct_transactions.unique_key) as total_transactions,
    COUNT(DISTINCT dim_users.natural_key) as active_users
  FROM
    spine
    LEFT JOIN `silicon-parity-396203`.`monzo`.`fct_transactions` ON fct_transactions.recorded_at >= spine.day
      AND fct_transactions.recorded_at < DATE_ADD(spine.day, INTERVAL 7 DAY)
    LEFT JOIN `silicon-parity-396203`.`monzo`.`dim_users` ON dim_users.surrogate_key = fct_transactions.user_surrogate_key
  GROUP BY
    1

)

SELECT
  spine.day as period_start,
  DATE_ADD(spine.day, INTERVAL 6 DAY) as period_end,
  users_7d.total_users,
  transactions_7d.active_users,
  transactions_7d.total_transactions,
  ROUND(CAST(active_users/total_users AS DECIMAL), 2) as active_users_7d
FROM
  spine
  LEFT JOIN users_7d ON users_7d.period_start = spine.day
  LEFT JOIN transactions_7d ON transactions_7d.period_start = spine.day
ORDER BY
  1;


[0m02:58:14.049727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:46913d81-a17b-4bca-8b35-c2430f37b2aa&page=queryresults
[0m02:58:14.073862 [debug] [Thread-1 (]: Timing info for model.monzo_task.report_7d_active_users (execute): 02:58:11.375491 => 02:58:14.071762
[0m02:58:14.080707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0edd36-8d0b-4f14-9efc-87a24edfe2ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f691dc60>]}
[0m02:58:14.085094 [info ] [Thread-1 (]: 7 of 7 OK created sql view model monzo.report_7d_active_users .................. [[32mCREATE VIEW (0 processed)[0m in 2.75s]
[0m02:58:14.091352 [debug] [Thread-1 (]: Finished running node model.monzo_task.report_7d_active_users
[0m02:58:14.098721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:14.101696 [debug] [MainThread]: Connection 'model.monzo_task.report_7d_active_users' was properly closed.
[0m02:58:14.104499 [info ] [MainThread]: 
[0m02:58:14.109592 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 1 minutes and 14.56 seconds (74.56s).
[0m02:58:14.120472 [debug] [MainThread]: Command end result
[0m02:58:14.152904 [info ] [MainThread]: 
[0m02:58:14.155997 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:14.158570 [info ] [MainThread]: 
[0m02:58:14.160987 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m02:58:14.163879 [debug] [MainThread]: Command `dbt run` succeeded at 02:58:14.163611 after 77.52 seconds
[0m02:58:14.166212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20fa623610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f691dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f6a1aaa0>]}
[0m02:58:14.168992 [debug] [MainThread]: Flushing usage events
[0m02:58:21.649775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb763e33610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7625485b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb762548040>]}


============================== 02:58:21.656836 | f79a35b9-6ba1-43b2-9373-9dbf16d44a9a ==============================
[0m02:58:21.656836 [info ] [MainThread]: Running with dbt=1.5.5
[0m02:58:21.659669 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'log_format': 'default'}
[0m02:58:22.259143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f79a35b9-6ba1-43b2-9373-9dbf16d44a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb763956170>]}
[0m02:58:22.288861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f79a35b9-6ba1-43b2-9373-9dbf16d44a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7604c3fd0>]}
[0m02:58:22.292025 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m02:58:22.351354 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m02:58:24.131916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:24.133513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:24.145376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f79a35b9-6ba1-43b2-9373-9dbf16d44a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb76017e3b0>]}
[0m02:58:24.178740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f79a35b9-6ba1-43b2-9373-9dbf16d44a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb760335ae0>]}
[0m02:58:24.181107 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m02:58:24.183721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f79a35b9-6ba1-43b2-9373-9dbf16d44a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7603377c0>]}
[0m02:58:24.190066 [info ] [MainThread]: 
[0m02:58:24.194390 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:58:24.198795 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203_monzo'
[0m02:58:24.200627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:25.453029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f79a35b9-6ba1-43b2-9373-9dbf16d44a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7603376a0>]}
[0m02:58:25.457010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:25.460205 [info ] [MainThread]: 
[0m02:58:25.482958 [debug] [Thread-1 (]: Began running node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m02:58:25.484981 [info ] [Thread-1 (]: 1 of 25 START test dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to  [RUN]
[0m02:58:25.487517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_monzo, now test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6)
[0m02:58:25.489483 [debug] [Thread-1 (]: Began compiling node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m02:58:25.537170 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"
[0m02:58:25.572027 [debug] [Thread-1 (]: Timing info for test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6 (compile): 02:58:25.491259 => 02:58:25.571122
[0m02:58:25.574930 [debug] [Thread-1 (]: Began executing node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m02:58:25.616118 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"
[0m02:58:25.642643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:25.650609 [debug] [Thread-1 (]: On test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        natural_key as partition_by_col,
        
        valid_from as lower_bound,
        valid_to as upper_bound,

        lead(valid_from) over (
            partition by natural_key
            order by valid_from, valid_to
        ) as next_lower_bound,

        row_number() over (
            partition by natural_key
            order by valid_from desc, valid_to desc
        ) = 1 as is_last_record

    from `silicon-parity-396203`.`monzo`.`dim_accounts`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m02:58:36.081872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:c9143abb-3fa5-414f-a676-be532c8f943c&page=queryresults
[0m02:58:36.092824 [debug] [Thread-1 (]: Timing info for test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6 (execute): 02:58:25.577945 => 02:58:36.091957
[0m02:58:36.097252 [info ] [Thread-1 (]: 1 of 25 PASS dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to  [[32mPASS[0m in 10.61s]
[0m02:58:36.101656 [debug] [Thread-1 (]: Finished running node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m02:58:36.104768 [debug] [Thread-1 (]: Began running node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m02:58:36.107131 [info ] [Thread-1 (]: 2 of 25 START test dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to  [RUN]
[0m02:58:36.110160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6, now test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d)
[0m02:58:36.112544 [debug] [Thread-1 (]: Began compiling node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m02:58:36.124277 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"
[0m02:58:36.153663 [debug] [Thread-1 (]: Timing info for test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d (compile): 02:58:36.114426 => 02:58:36.152778
[0m02:58:36.157084 [debug] [Thread-1 (]: Began executing node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m02:58:36.165973 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"
[0m02:58:36.187637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:36.195037 [debug] [Thread-1 (]: On test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        natural_key as partition_by_col,
        
        valid_from as lower_bound,
        valid_to as upper_bound,

        lead(valid_from) over (
            partition by natural_key
            order by valid_from, valid_to
        ) as next_lower_bound,

        row_number() over (
            partition by natural_key
            order by valid_from desc, valid_to desc
        ) = 1 as is_last_record

    from `silicon-parity-396203`.`monzo`.`dim_users`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m02:58:41.037360 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:e55061ed-0104-4f4a-8699-1af0a60ac4f0&page=queryresults
[0m02:58:41.040101 [debug] [Thread-1 (]: Timing info for test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d (execute): 02:58:36.159741 => 02:58:41.039586
[0m02:58:41.043076 [info ] [Thread-1 (]: 2 of 25 PASS dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to  [[32mPASS[0m in 4.93s]
[0m02:58:41.046138 [debug] [Thread-1 (]: Finished running node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m02:58:41.048746 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_accounts_is_open.aafc57baad
[0m02:58:41.051551 [info ] [Thread-1 (]: 3 of 25 START test not_null_dim_accounts_is_open ............................... [RUN]
[0m02:58:41.054654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d, now test.monzo_task.not_null_dim_accounts_is_open.aafc57baad)
[0m02:58:41.056855 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_accounts_is_open.aafc57baad
[0m02:58:41.069913 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_accounts_is_open.aafc57baad"
[0m02:58:41.087892 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_is_open.aafc57baad (compile): 02:58:41.058860 => 02:58:41.087325
[0m02:58:41.089949 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_accounts_is_open.aafc57baad
[0m02:58:41.110033 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_accounts_is_open.aafc57baad"
[0m02:58:41.128959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:41.137865 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_accounts_is_open.aafc57baad: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_accounts_is_open.aafc57baad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_open
from `silicon-parity-396203`.`monzo`.`dim_accounts`
where is_open is null



      
    ) dbt_internal_test
[0m02:58:44.749415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:28aebf00-2bc9-4998-9591-94c21451c021&page=queryresults
[0m02:58:44.771924 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_is_open.aafc57baad (execute): 02:58:41.091812 => 02:58:44.767983
[0m02:58:44.783507 [info ] [Thread-1 (]: 3 of 25 PASS not_null_dim_accounts_is_open ..................................... [[32mPASS[0m in 3.73s]
[0m02:58:44.792177 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_accounts_is_open.aafc57baad
[0m02:58:44.796484 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m02:58:44.800281 [info ] [Thread-1 (]: 4 of 25 START test not_null_dim_accounts_natural_key ........................... [RUN]
[0m02:58:44.805224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_accounts_is_open.aafc57baad, now test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3)
[0m02:58:44.807950 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m02:58:44.817590 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"
[0m02:58:44.840846 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3 (compile): 02:58:44.810244 => 02:58:44.840041
[0m02:58:44.844653 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m02:58:44.854847 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"
[0m02:58:44.873641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:44.883408 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select natural_key
from `silicon-parity-396203`.`monzo`.`dim_accounts`
where natural_key is null



      
    ) dbt_internal_test
[0m02:58:48.994079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:d0d66872-fa71-4a0d-b74d-282e17b5c846&page=queryresults
[0m02:58:49.001995 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3 (execute): 02:58:44.847235 => 02:58:49.000706
[0m02:58:49.007742 [info ] [Thread-1 (]: 4 of 25 PASS not_null_dim_accounts_natural_key ................................. [[32mPASS[0m in 4.20s]
[0m02:58:49.011687 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m02:58:49.014469 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m02:58:49.016789 [info ] [Thread-1 (]: 5 of 25 START test not_null_dim_accounts_surrogate_key ......................... [RUN]
[0m02:58:49.019541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3, now test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77)
[0m02:58:49.022038 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m02:58:49.030190 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77"
[0m02:58:49.059061 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77 (compile): 02:58:49.023993 => 02:58:49.058227
[0m02:58:49.061838 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m02:58:49.084029 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77"
[0m02:58:49.104789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:49.119569 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select surrogate_key
from `silicon-parity-396203`.`monzo`.`dim_accounts`
where surrogate_key is null



      
    ) dbt_internal_test
[0m02:58:53.688746 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:a95abe4e-6336-44f6-83fd-1779d21c9205&page=queryresults
[0m02:58:53.692424 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77 (execute): 02:58:49.076984 => 02:58:53.691851
[0m02:58:53.696212 [info ] [Thread-1 (]: 5 of 25 PASS not_null_dim_accounts_surrogate_key ............................... [[32mPASS[0m in 4.68s]
[0m02:58:53.699481 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m02:58:53.701788 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m02:58:53.704266 [info ] [Thread-1 (]: 6 of 25 START test not_null_dim_accounts_valid_from ............................ [RUN]
[0m02:58:53.707692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77, now test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9)
[0m02:58:53.709903 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m02:58:53.731078 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9"
[0m02:58:53.748385 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9 (compile): 02:58:53.712265 => 02:58:53.747627
[0m02:58:53.750769 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m02:58:53.804795 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9"
[0m02:58:53.824302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:53.843460 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_from
from `silicon-parity-396203`.`monzo`.`dim_accounts`
where valid_from is null



      
    ) dbt_internal_test
[0m02:58:58.130970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:3c8fb587-113f-4b32-b2f2-9018e0bd3faa&page=queryresults
[0m02:58:58.133923 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9 (execute): 02:58:53.752861 => 02:58:58.133485
[0m02:58:58.136815 [info ] [Thread-1 (]: 6 of 25 PASS not_null_dim_accounts_valid_from .................................. [[32mPASS[0m in 4.43s]
[0m02:58:58.139805 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m02:58:58.142458 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m02:58:58.144876 [info ] [Thread-1 (]: 7 of 25 START test not_null_dim_accounts_valid_to .............................. [RUN]
[0m02:58:58.147569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9, now test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2)
[0m02:58:58.149744 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m02:58:58.157847 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2"
[0m02:58:58.176108 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2 (compile): 02:58:58.151585 => 02:58:58.175182
[0m02:58:58.178935 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m02:58:58.185931 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2"
[0m02:58:58.205750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:58:58.214432 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_to
from `silicon-parity-396203`.`monzo`.`dim_accounts`
where valid_to is null



      
    ) dbt_internal_test
[0m02:59:03.153646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:862c3e9b-8563-4449-a7fa-3542a781217b&page=queryresults
[0m02:59:03.170365 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2 (execute): 02:58:58.180939 => 02:59:03.167863
[0m02:59:03.180885 [info ] [Thread-1 (]: 7 of 25 PASS not_null_dim_accounts_valid_to .................................... [[32mPASS[0m in 5.03s]
[0m02:59:03.184760 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m02:59:03.187488 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_users_natural_key.1191491ec3
[0m02:59:03.190056 [info ] [Thread-1 (]: 8 of 25 START test not_null_dim_users_natural_key .............................. [RUN]
[0m02:59:03.193460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2, now test.monzo_task.not_null_dim_users_natural_key.1191491ec3)
[0m02:59:03.196116 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_users_natural_key.1191491ec3
[0m02:59:03.209037 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_users_natural_key.1191491ec3"
[0m02:59:03.228168 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_natural_key.1191491ec3 (compile): 02:59:03.197998 => 02:59:03.227212
[0m02:59:03.230728 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_users_natural_key.1191491ec3
[0m02:59:03.239917 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_users_natural_key.1191491ec3"
[0m02:59:03.259990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:03.275084 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_users_natural_key.1191491ec3: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_users_natural_key.1191491ec3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select natural_key
from `silicon-parity-396203`.`monzo`.`dim_users`
where natural_key is null



      
    ) dbt_internal_test
[0m02:59:07.038978 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:7a970e5c-e405-44c0-b569-a58f43171b44&page=queryresults
[0m02:59:07.052894 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_natural_key.1191491ec3 (execute): 02:59:03.233081 => 02:59:07.050929
[0m02:59:07.061043 [info ] [Thread-1 (]: 8 of 25 PASS not_null_dim_users_natural_key .................................... [[32mPASS[0m in 3.87s]
[0m02:59:07.067137 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_users_natural_key.1191491ec3
[0m02:59:07.070565 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m02:59:07.073490 [info ] [Thread-1 (]: 9 of 25 START test not_null_dim_users_surrogate_key ............................ [RUN]
[0m02:59:07.077066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_users_natural_key.1191491ec3, now test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda)
[0m02:59:07.080114 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m02:59:07.089268 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda"
[0m02:59:07.107710 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda (compile): 02:59:07.082114 => 02:59:07.107139
[0m02:59:07.109886 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m02:59:07.134000 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda"
[0m02:59:07.150468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:07.159040 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select surrogate_key
from `silicon-parity-396203`.`monzo`.`dim_users`
where surrogate_key is null



      
    ) dbt_internal_test
[0m02:59:12.064669 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:e9da778b-e5e0-4536-ac4e-97f920434525&page=queryresults
[0m02:59:12.078246 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda (execute): 02:59:07.111725 => 02:59:12.076555
[0m02:59:12.086902 [info ] [Thread-1 (]: 9 of 25 PASS not_null_dim_users_surrogate_key .................................. [[32mPASS[0m in 5.01s]
[0m02:59:12.092958 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m02:59:12.097082 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_users_valid_from.8cd755bb40
[0m02:59:12.100754 [info ] [Thread-1 (]: 10 of 25 START test not_null_dim_users_valid_from .............................. [RUN]
[0m02:59:12.104285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda, now test.monzo_task.not_null_dim_users_valid_from.8cd755bb40)
[0m02:59:12.106848 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_users_valid_from.8cd755bb40
[0m02:59:12.116128 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_users_valid_from.8cd755bb40"
[0m02:59:12.134409 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_valid_from.8cd755bb40 (compile): 02:59:12.108931 => 02:59:12.133869
[0m02:59:12.136609 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_users_valid_from.8cd755bb40
[0m02:59:12.142670 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_users_valid_from.8cd755bb40"
[0m02:59:12.171712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:12.179957 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_users_valid_from.8cd755bb40: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_users_valid_from.8cd755bb40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_from
from `silicon-parity-396203`.`monzo`.`dim_users`
where valid_from is null



      
    ) dbt_internal_test
[0m02:59:16.263707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:50cef06e-4218-4672-add0-a044e1910041&page=queryresults
[0m02:59:16.276749 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_valid_from.8cd755bb40 (execute): 02:59:12.138443 => 02:59:16.275708
[0m02:59:16.282483 [info ] [Thread-1 (]: 10 of 25 PASS not_null_dim_users_valid_from .................................... [[32mPASS[0m in 4.18s]
[0m02:59:16.287310 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_users_valid_from.8cd755bb40
[0m02:59:16.290796 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_users_valid_to.543960cf0d
[0m02:59:16.293392 [info ] [Thread-1 (]: 11 of 25 START test not_null_dim_users_valid_to ................................ [RUN]
[0m02:59:16.296480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_users_valid_from.8cd755bb40, now test.monzo_task.not_null_dim_users_valid_to.543960cf0d)
[0m02:59:16.298831 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_users_valid_to.543960cf0d
[0m02:59:16.307746 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_users_valid_to.543960cf0d"
[0m02:59:16.326818 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_valid_to.543960cf0d (compile): 02:59:16.301253 => 02:59:16.326309
[0m02:59:16.328902 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_users_valid_to.543960cf0d
[0m02:59:16.338003 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_users_valid_to.543960cf0d"
[0m02:59:16.359815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:16.368364 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_users_valid_to.543960cf0d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_users_valid_to.543960cf0d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_to
from `silicon-parity-396203`.`monzo`.`dim_users`
where valid_to is null



      
    ) dbt_internal_test
[0m02:59:21.203227 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:2559f0cf-9d78-4ef8-beae-607274a5b26d&page=queryresults
[0m02:59:21.207362 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_valid_to.543960cf0d (execute): 02:59:16.330764 => 02:59:21.206778
[0m02:59:21.210809 [info ] [Thread-1 (]: 11 of 25 PASS not_null_dim_users_valid_to ...................................... [[32mPASS[0m in 4.91s]
[0m02:59:21.213910 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_users_valid_to.543960cf0d
[0m02:59:21.216370 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m02:59:21.218947 [info ] [Thread-1 (]: 12 of 25 START test not_null_fct_transactions_unique_key ....................... [RUN]
[0m02:59:21.221536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_users_valid_to.543960cf0d, now test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d)
[0m02:59:21.223527 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m02:59:21.232342 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d"
[0m02:59:21.250980 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d (compile): 02:59:21.225143 => 02:59:21.250381
[0m02:59:21.253621 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m02:59:21.279366 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d"
[0m02:59:21.298865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:21.308071 [debug] [Thread-1 (]: On test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select unique_key
from `silicon-parity-396203`.`monzo`.`fct_transactions`
where unique_key is null



      
    ) dbt_internal_test
[0m02:59:26.359528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:24ae3f63-adbb-42b3-a9b9-20adabccce8e&page=queryresults
[0m02:59:26.378228 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d (execute): 02:59:21.255725 => 02:59:26.371058
[0m02:59:26.385415 [info ] [Thread-1 (]: 12 of 25 PASS not_null_fct_transactions_unique_key ............................. [[32mPASS[0m in 5.16s]
[0m02:59:26.392547 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m02:59:26.397009 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m02:59:26.399855 [info ] [Thread-1 (]: 13 of 25 START test not_null_stg_accounts_closed_account_id .................... [RUN]
[0m02:59:26.403310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d, now test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea)
[0m02:59:26.406305 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m02:59:26.415074 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea"
[0m02:59:26.441287 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea (compile): 02:59:26.408169 => 02:59:26.440531
[0m02:59:26.443452 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m02:59:26.449357 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea"
[0m02:59:26.475030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:26.482013 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`monzo`.`stg_accounts_closed`
where account_id is null



      
    ) dbt_internal_test
[0m02:59:29.954032 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:37fe1b7e-1435-4765-8c32-b2cc6adc489b&page=queryresults
[0m02:59:29.957079 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea (execute): 02:59:26.445248 => 02:59:29.956512
[0m02:59:29.959974 [info ] [Thread-1 (]: 13 of 25 PASS not_null_stg_accounts_closed_account_id .......................... [[32mPASS[0m in 3.56s]
[0m02:59:29.962895 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m02:59:29.965357 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m02:59:29.967622 [info ] [Thread-1 (]: 14 of 25 START test not_null_stg_accounts_closed_recorded_at ................... [RUN]
[0m02:59:29.970391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea, now test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94)
[0m02:59:29.972965 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m02:59:29.981338 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94"
[0m02:59:30.012296 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94 (compile): 02:59:29.975040 => 02:59:30.011360
[0m02:59:30.015294 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m02:59:30.023522 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94"
[0m02:59:30.043941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:30.052481 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`monzo`.`stg_accounts_closed`
where recorded_at is null



      
    ) dbt_internal_test
[0m02:59:33.747878 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:19d766f4-d44d-468a-a98b-fd8443b897be&page=queryresults
[0m02:59:33.752549 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94 (execute): 02:59:30.017725 => 02:59:33.751637
[0m02:59:33.757552 [info ] [Thread-1 (]: 14 of 25 PASS not_null_stg_accounts_closed_recorded_at ......................... [[32mPASS[0m in 3.79s]
[0m02:59:33.762377 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m02:59:33.765306 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m02:59:33.767670 [info ] [Thread-1 (]: 15 of 25 START test not_null_stg_accounts_created_account_id ................... [RUN]
[0m02:59:33.770564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94, now test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd)
[0m02:59:33.772730 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m02:59:33.783418 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"
[0m02:59:33.800058 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd (compile): 02:59:33.774494 => 02:59:33.799584
[0m02:59:33.802160 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m02:59:33.830571 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"
[0m02:59:33.848948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:33.857724 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`monzo`.`stg_accounts_created`
where account_id is null



      
    ) dbt_internal_test
[0m02:59:37.295054 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:64ec2641-07f2-4fb2-b7ea-d3dd2eab68f3&page=queryresults
[0m02:59:37.308435 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd (execute): 02:59:33.804104 => 02:59:37.306857
[0m02:59:37.318920 [info ] [Thread-1 (]: 15 of 25 PASS not_null_stg_accounts_created_account_id ......................... [[32mPASS[0m in 3.55s]
[0m02:59:37.329393 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m02:59:37.338194 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m02:59:37.348596 [info ] [Thread-1 (]: 16 of 25 START test not_null_stg_accounts_created_recorded_at .................. [RUN]
[0m02:59:37.357995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd, now test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df)
[0m02:59:37.362630 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m02:59:37.375347 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df"
[0m02:59:37.396298 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df (compile): 02:59:37.365085 => 02:59:37.395705
[0m02:59:37.398620 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m02:59:37.405322 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df"
[0m02:59:37.422934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:37.431841 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`monzo`.`stg_accounts_created`
where recorded_at is null



      
    ) dbt_internal_test
[0m02:59:41.016739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:60575aec-2d4f-4452-a3cc-975397a7d214&page=queryresults
[0m02:59:41.025878 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df (execute): 02:59:37.401231 => 02:59:41.024654
[0m02:59:41.033093 [info ] [Thread-1 (]: 16 of 25 PASS not_null_stg_accounts_created_recorded_at ........................ [[32mPASS[0m in 3.68s]
[0m02:59:41.039108 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m02:59:41.042309 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m02:59:41.044976 [info ] [Thread-1 (]: 17 of 25 START test not_null_stg_accounts_created_user_id ...................... [RUN]
[0m02:59:41.048228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df, now test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7)
[0m02:59:41.050594 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m02:59:41.058909 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7"
[0m02:59:41.076918 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7 (compile): 02:59:41.052715 => 02:59:41.076363
[0m02:59:41.079579 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m02:59:41.085581 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7"
[0m02:59:41.110989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:41.119842 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `silicon-parity-396203`.`monzo`.`stg_accounts_created`
where user_id is null



      
    ) dbt_internal_test
[0m02:59:44.528318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:0c6c6256-5036-4ac4-9a39-d516f40d9bb0&page=queryresults
[0m02:59:44.532031 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7 (execute): 02:59:41.081525 => 02:59:44.531527
[0m02:59:44.535152 [info ] [Thread-1 (]: 17 of 25 PASS not_null_stg_accounts_created_user_id ............................ [[32mPASS[0m in 3.49s]
[0m02:59:44.538788 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m02:59:44.541724 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m02:59:44.544148 [info ] [Thread-1 (]: 18 of 25 START test not_null_stg_accounts_reopened_account_id .................. [RUN]
[0m02:59:44.547952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7, now test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af)
[0m02:59:44.550569 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m02:59:44.559691 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"
[0m02:59:44.575767 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af (compile): 02:59:44.552581 => 02:59:44.575152
[0m02:59:44.577905 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m02:59:44.602151 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"
[0m02:59:44.619244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:44.626883 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
where account_id is null



      
    ) dbt_internal_test
[0m02:59:48.100976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:70f65fcc-940d-424b-b1f1-93879a84d18e&page=queryresults
[0m02:59:48.104294 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af (execute): 02:59:44.580256 => 02:59:48.103724
[0m02:59:48.107910 [info ] [Thread-1 (]: 18 of 25 PASS not_null_stg_accounts_reopened_account_id ........................ [[32mPASS[0m in 3.56s]
[0m02:59:48.111987 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m02:59:48.114981 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m02:59:48.117583 [info ] [Thread-1 (]: 19 of 25 START test not_null_stg_accounts_reopened_recorded_at ................. [RUN]
[0m02:59:48.121043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af, now test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f)
[0m02:59:48.123549 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m02:59:48.135160 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"
[0m02:59:48.153087 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f (compile): 02:59:48.125777 => 02:59:48.152501
[0m02:59:48.155244 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m02:59:48.161210 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"
[0m02:59:48.181613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:48.191153 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
where recorded_at is null



      
    ) dbt_internal_test
[0m02:59:51.540579 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:0d7f674e-e65b-48fa-a47c-232443d07a8f&page=queryresults
[0m02:59:51.554605 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f (execute): 02:59:48.157172 => 02:59:51.552849
[0m02:59:51.563939 [info ] [Thread-1 (]: 19 of 25 PASS not_null_stg_accounts_reopened_recorded_at ....................... [[32mPASS[0m in 3.44s]
[0m02:59:51.569779 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m02:59:51.573326 [debug] [Thread-1 (]: Began running node test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m02:59:51.576203 [info ] [Thread-1 (]: 20 of 25 START test relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_  [RUN]
[0m02:59:51.579499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f, now test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f)
[0m02:59:51.581916 [debug] [Thread-1 (]: Began compiling node test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m02:59:51.596774 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"
[0m02:59:51.615040 [debug] [Thread-1 (]: Timing info for test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f (compile): 02:59:51.584338 => 02:59:51.614524
[0m02:59:51.617621 [debug] [Thread-1 (]: Began executing node test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m02:59:51.624461 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"
[0m02:59:51.644162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:51.653748 [debug] [Thread-1 (]: On test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select account_surrogate_key as from_field
    from `silicon-parity-396203`.`monzo`.`fct_transactions`
    where account_surrogate_key is not null
),

parent as (
    select surrogate_key as to_field
    from `silicon-parity-396203`.`monzo`.`dim_accounts`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m02:59:56.311353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:49031f35-2d37-4ea8-85df-872022a22621&page=queryresults
[0m02:59:56.314449 [debug] [Thread-1 (]: Timing info for test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f (execute): 02:59:51.619516 => 02:59:56.313804
[0m02:59:56.317996 [info ] [Thread-1 (]: 20 of 25 PASS relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_  [[32mPASS[0m in 4.74s]
[0m02:59:56.321958 [debug] [Thread-1 (]: Finished running node test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m02:59:56.325239 [debug] [Thread-1 (]: Began running node test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m02:59:56.328098 [info ] [Thread-1 (]: 21 of 25 START test relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_  [RUN]
[0m02:59:56.333048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f, now test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a)
[0m02:59:56.336137 [debug] [Thread-1 (]: Began compiling node test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m02:59:56.368886 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"
[0m02:59:56.384226 [debug] [Thread-1 (]: Timing info for test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a (compile): 02:59:56.340325 => 02:59:56.383678
[0m02:59:56.387032 [debug] [Thread-1 (]: Began executing node test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m02:59:56.395942 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"
[0m02:59:56.415419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:59:56.424570 [debug] [Thread-1 (]: On test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_surrogate_key as from_field
    from `silicon-parity-396203`.`monzo`.`fct_transactions`
    where user_surrogate_key is not null
),

parent as (
    select surrogate_key as to_field
    from `silicon-parity-396203`.`monzo`.`dim_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:00:01.338847 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:ae7b6160-5624-465a-80e0-796981eec053&page=queryresults
[0m03:00:01.351077 [debug] [Thread-1 (]: Timing info for test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a (execute): 02:59:56.389055 => 03:00:01.348562
[0m03:00:01.359616 [info ] [Thread-1 (]: 21 of 25 PASS relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_  [[32mPASS[0m in 5.03s]
[0m03:00:01.365093 [debug] [Thread-1 (]: Finished running node test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m03:00:01.369053 [debug] [Thread-1 (]: Began running node test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m03:00:01.372355 [info ] [Thread-1 (]: 22 of 25 START test unique_dim_accounts_surrogate_key .......................... [RUN]
[0m03:00:01.375486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a, now test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064)
[0m03:00:01.377791 [debug] [Thread-1 (]: Began compiling node test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m03:00:01.389872 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064"
[0m03:00:01.407372 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064 (compile): 03:00:01.379741 => 03:00:01.406860
[0m03:00:01.409494 [debug] [Thread-1 (]: Began executing node test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m03:00:01.416719 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064"
[0m03:00:01.435919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:01.444239 [debug] [Thread-1 (]: On test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select surrogate_key as unique_field
  from `silicon-parity-396203`.`monzo`.`dim_accounts`
  where surrogate_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m03:00:05.557838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:15a80481-b642-424b-86e1-c69bf6fcd752&page=queryresults
[0m03:00:05.560562 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064 (execute): 03:00:01.411308 => 03:00:05.559994
[0m03:00:05.563401 [info ] [Thread-1 (]: 22 of 25 PASS unique_dim_accounts_surrogate_key ................................ [[32mPASS[0m in 4.19s]
[0m03:00:05.566335 [debug] [Thread-1 (]: Finished running node test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m03:00:05.568793 [debug] [Thread-1 (]: Began running node test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m03:00:05.571118 [info ] [Thread-1 (]: 23 of 25 START test unique_dim_users_surrogate_key ............................. [RUN]
[0m03:00:05.574366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064, now test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8)
[0m03:00:05.576591 [debug] [Thread-1 (]: Began compiling node test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m03:00:05.584831 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8"
[0m03:00:05.603751 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8 (compile): 03:00:05.578478 => 03:00:05.603086
[0m03:00:05.606275 [debug] [Thread-1 (]: Began executing node test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m03:00:05.613011 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8"
[0m03:00:05.639907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:05.648861 [debug] [Thread-1 (]: On test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select surrogate_key as unique_field
  from `silicon-parity-396203`.`monzo`.`dim_users`
  where surrogate_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m03:00:10.870608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:2357bdf6-c0e5-458f-b6f6-72f73994b329&page=queryresults
[0m03:00:10.884989 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8 (execute): 03:00:05.608308 => 03:00:10.883482
[0m03:00:10.893897 [info ] [Thread-1 (]: 23 of 25 PASS unique_dim_users_surrogate_key ................................... [[32mPASS[0m in 5.32s]
[0m03:00:10.899237 [debug] [Thread-1 (]: Finished running node test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m03:00:10.902987 [debug] [Thread-1 (]: Began running node test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6
[0m03:00:10.905932 [info ] [Thread-1 (]: 24 of 25 START test unique_fct_transactions_unique_key ......................... [RUN]
[0m03:00:10.909422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8, now test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6)
[0m03:00:10.912088 [debug] [Thread-1 (]: Began compiling node test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6
[0m03:00:10.939610 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6"
[0m03:00:10.957750 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6 (compile): 03:00:10.914177 => 03:00:10.957205
[0m03:00:10.960322 [debug] [Thread-1 (]: Began executing node test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6
[0m03:00:10.966092 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6"
[0m03:00:10.986172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:10.995539 [debug] [Thread-1 (]: On test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select unique_key as unique_field
  from `silicon-parity-396203`.`monzo`.`fct_transactions`
  where unique_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m03:00:16.189981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:98b304fb-d712-4842-bcd2-21e054cddef1&page=queryresults
[0m03:00:16.204093 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6 (execute): 03:00:10.962277 => 03:00:16.202707
[0m03:00:16.209873 [info ] [Thread-1 (]: 24 of 25 PASS unique_fct_transactions_unique_key ............................... [[32mPASS[0m in 5.30s]
[0m03:00:16.215965 [debug] [Thread-1 (]: Finished running node test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6
[0m03:00:16.220301 [debug] [Thread-1 (]: Began running node test.monzo_task.unique_stg_accounts_created_account_id.d00a929146
[0m03:00:16.224040 [info ] [Thread-1 (]: 25 of 25 START test unique_stg_accounts_created_account_id ..................... [RUN]
[0m03:00:16.228819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6, now test.monzo_task.unique_stg_accounts_created_account_id.d00a929146)
[0m03:00:16.231727 [debug] [Thread-1 (]: Began compiling node test.monzo_task.unique_stg_accounts_created_account_id.d00a929146
[0m03:00:16.241378 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.unique_stg_accounts_created_account_id.d00a929146"
[0m03:00:16.269721 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_stg_accounts_created_account_id.d00a929146 (compile): 03:00:16.233652 => 03:00:16.268710
[0m03:00:16.272998 [debug] [Thread-1 (]: Began executing node test.monzo_task.unique_stg_accounts_created_account_id.d00a929146
[0m03:00:16.281059 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.unique_stg_accounts_created_account_id.d00a929146"
[0m03:00:16.298061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:16.306355 [debug] [Thread-1 (]: On test.monzo_task.unique_stg_accounts_created_account_id.d00a929146: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.unique_stg_accounts_created_account_id.d00a929146"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select account_id as unique_field
  from `silicon-parity-396203`.`monzo`.`stg_accounts_created`
  where account_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m03:00:19.914787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:09822a08-62b7-4265-bd42-86ebea981564&page=queryresults
[0m03:00:19.928431 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_stg_accounts_created_account_id.d00a929146 (execute): 03:00:16.275649 => 03:00:19.927338
[0m03:00:19.934407 [info ] [Thread-1 (]: 25 of 25 PASS unique_stg_accounts_created_account_id ........................... [[32mPASS[0m in 3.71s]
[0m03:00:19.938553 [debug] [Thread-1 (]: Finished running node test.monzo_task.unique_stg_accounts_created_account_id.d00a929146
[0m03:00:19.944231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:19.947003 [debug] [MainThread]: Connection 'test.monzo_task.unique_stg_accounts_created_account_id.d00a929146' was properly closed.
[0m03:00:19.949282 [info ] [MainThread]: 
[0m03:00:19.951730 [info ] [MainThread]: Finished running 25 tests in 0 hours 1 minutes and 55.76 seconds (115.76s).
[0m03:00:19.967763 [debug] [MainThread]: Command end result
[0m03:00:20.090008 [info ] [MainThread]: 
[0m03:00:20.092994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:00:20.096371 [info ] [MainThread]: 
[0m03:00:20.099112 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m03:00:20.101846 [debug] [MainThread]: Command `dbt test` succeeded at 03:00:20.101578 after 118.50 seconds
[0m03:00:20.103872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb763e33610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7631fbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb760f5ac50>]}
[0m03:00:20.106123 [debug] [MainThread]: Flushing usage events
[0m03:11:58.359026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60127f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ffb9c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ffb9c040>]}


============================== 03:11:58.367906 | 6fbe8770-4c37-4379-b5ea-321363060758 ==============================
[0m03:11:58.367906 [info ] [MainThread]: Running with dbt=1.5.5
[0m03:11:58.370836 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True'}
[0m03:11:59.217904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc600fdd930>]}
[0m03:11:59.345635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fdb365f0>]}
[0m03:11:59.352195 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:11:59.487469 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m03:12:02.093150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:12:02.094828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:12:02.106884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd7fe860>]}
[0m03:12:02.143453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd9b1f90>]}
[0m03:12:02.145851 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m03:12:02.149587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd9b3c70>]}
[0m03:12:02.154195 [info ] [MainThread]: 
[0m03:12:02.157377 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:12:02.162650 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203'
[0m03:12:02.167387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:04.638724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silicon-parity-396203, now list_silicon-parity-396203_monzo)
[0m03:12:04.658231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:05.989941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd9b1a20>]}
[0m03:12:05.993659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:05.996617 [info ] [MainThread]: 
[0m03:12:06.034918 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_closed
[0m03:12:06.039004 [info ] [Thread-1 (]: 1 of 7 START sql incremental model monzo.stg_accounts_closed ................... [RUN]
[0m03:12:06.042208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_monzo, now model.monzo_task.stg_accounts_closed)
[0m03:12:06.044585 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_closed
[0m03:12:06.071245 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_closed"
[0m03:12:06.090954 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_closed (compile): 03:12:06.046788 => 03:12:06.090378
[0m03:12:06.093274 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_closed
[0m03:12:06.213337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:06.223520 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_closed: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_closed"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_closed__dbt_tmp`
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH source as (
    
    SELECT
        CAST(closed_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`monzo`.`account_closed`
    
    

  -- this filter will only be applied on an incremental run
    WHERE closed_ts > (SELECT max(closed_ts) FROM `silicon-parity-396203`.`monzo`.`stg_accounts_closed`)

    

)

SELECT * FROM source
    );
  
[0m03:12:13.483031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:2922a8f6-6d4f-4f3b-834f-e54b60869702&page=queryresults
[0m03:12:14.631367 [debug] [Thread-1 (]: 
    In `silicon-parity-396203`.`monzo`.`stg_accounts_closed`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m03:12:14.677991 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_closed"
[0m03:12:14.702232 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_closed: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_closed"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `silicon-parity-396203`.`monzo`.`stg_accounts_closed` as DBT_INTERNAL_DEST
        using (
        select
        * from `silicon-parity-396203`.`monzo`.`stg_accounts_closed__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`recorded_at`, `account_id`)
    values
        (`recorded_at`, `account_id`)


    
[0m03:12:18.081776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:62619250-361a-49fb-91f9-58d2077248be&page=queryresults
[0m03:12:18.152547 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_closed (execute): 03:12:06.095329 => 03:12:18.152085
[0m03:12:18.156641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd7fef80>]}
[0m03:12:18.159407 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model monzo.stg_accounts_closed .............. [[32mMERGE (0.0 rows, 0 processed)[0m in 12.11s]
[0m03:12:18.162588 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_closed
[0m03:12:18.165632 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_created
[0m03:12:18.168069 [info ] [Thread-1 (]: 2 of 7 START sql incremental model monzo.stg_accounts_created .................. [RUN]
[0m03:12:18.171261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_closed, now model.monzo_task.stg_accounts_created)
[0m03:12:18.174193 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_created
[0m03:12:18.183203 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_created"
[0m03:12:18.208397 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_created (compile): 03:12:18.176259 => 03:12:18.207912
[0m03:12:18.210556 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_created
[0m03:12:18.225183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:18.234489 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_created: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_created"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_created__dbt_tmp`
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH source as (
    
    SELECT
        CAST(created_ts AS TIMESTAMP) as recorded_at,
        account_type,
        account_id_hashed as account_id,
        user_id_hashed as user_id
    FROM
      `silicon-parity-396203`.`monzo`.`account_created`
    
    

  -- this filter will only be applied on an incremental run
    WHERE created_ts > (SELECT max(created_ts) FROM `silicon-parity-396203`.`monzo`.`stg_accounts_created`)

    

)

SELECT * FROM source
    );
  
[0m03:12:52.769654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:f4cc61ff-9181-4839-ae51-4a6a9b472f33&page=queryresults
[0m03:12:53.794486 [debug] [Thread-1 (]: 
    In `silicon-parity-396203`.`monzo`.`stg_accounts_created`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m03:12:53.801932 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_created"
[0m03:12:53.822940 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_created: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_created"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `silicon-parity-396203`.`monzo`.`stg_accounts_created` as DBT_INTERNAL_DEST
        using (
        select
        * from `silicon-parity-396203`.`monzo`.`stg_accounts_created__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`recorded_at`, `account_type`, `account_id`, `user_id`)
    values
        (`recorded_at`, `account_type`, `account_id`, `user_id`)


    
[0m03:12:56.728273 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:b7e4a17b-b4e0-4b33-8c68-713c34fe1f2f&page=queryresults
[0m03:12:56.735014 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_created (execute): 03:12:18.212567 => 03:12:56.734535
[0m03:12:56.739000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd71af20>]}
[0m03:12:56.742294 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model monzo.stg_accounts_created ............. [[32mMERGE (0.0 rows, 0 processed)[0m in 38.57s]
[0m03:12:56.745448 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_created
[0m03:12:56.748104 [debug] [Thread-1 (]: Began running node model.monzo_task.stg_accounts_reopened
[0m03:12:56.750465 [info ] [Thread-1 (]: 3 of 7 START sql incremental model monzo.stg_accounts_reopened ................. [RUN]
[0m03:12:56.753264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_created, now model.monzo_task.stg_accounts_reopened)
[0m03:12:56.756114 [debug] [Thread-1 (]: Began compiling node model.monzo_task.stg_accounts_reopened
[0m03:12:56.765422 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.stg_accounts_reopened"
[0m03:12:56.784144 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_reopened (compile): 03:12:56.758198 => 03:12:56.783638
[0m03:12:56.786361 [debug] [Thread-1 (]: Began executing node model.monzo_task.stg_accounts_reopened
[0m03:12:56.797380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:56.807563 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_reopened: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_reopened"} */

  
    

    create or replace table `silicon-parity-396203`.`monzo`.`stg_accounts_reopened__dbt_tmp`
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

WITH source as (
    
    SELECT
        CAST(reopened_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`monzo`.`account_reopened`
    
    

  -- this filter will only be applied on an incremental run
    WHERE reopened_ts > (SELECT max(reopened_ts) FROM `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`)

    

)

SELECT * FROM source
    );
  
[0m03:13:02.242587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:2ee0d25c-0ece-42f3-881e-99603f1b7e13&page=queryresults
[0m03:13:03.380966 [debug] [Thread-1 (]: 
    In `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m03:13:03.399843 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.stg_accounts_reopened"
[0m03:13:03.447071 [debug] [Thread-1 (]: On model.monzo_task.stg_accounts_reopened: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.stg_accounts_reopened"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `silicon-parity-396203`.`monzo`.`stg_accounts_reopened` as DBT_INTERNAL_DEST
        using (
        select
        * from `silicon-parity-396203`.`monzo`.`stg_accounts_reopened__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`recorded_at`, `account_id`)
    values
        (`recorded_at`, `account_id`)


    
[0m03:13:06.693066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:b10b9393-dead-4dad-8765-aeda49b67dbd&page=queryresults
[0m03:13:06.699144 [debug] [Thread-1 (]: Timing info for model.monzo_task.stg_accounts_reopened (execute): 03:12:56.789041 => 03:13:06.698764
[0m03:13:06.702150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd710940>]}
[0m03:13:06.704888 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model monzo.stg_accounts_reopened ............ [[32mMERGE (0.0 rows, 0 processed)[0m in 9.95s]
[0m03:13:06.707950 [debug] [Thread-1 (]: Finished running node model.monzo_task.stg_accounts_reopened
[0m03:13:06.712296 [debug] [Thread-1 (]: Began running node model.monzo_task.dim_accounts
[0m03:13:06.714887 [info ] [Thread-1 (]: 4 of 7 START sql view model monzo.dim_accounts ................................. [RUN]
[0m03:13:06.717771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.stg_accounts_reopened, now model.monzo_task.dim_accounts)
[0m03:13:06.720045 [debug] [Thread-1 (]: Began compiling node model.monzo_task.dim_accounts
[0m03:13:06.765284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:08.668392 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.dim_accounts"
[0m03:13:08.705392 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_accounts (compile): 03:13:06.722036 => 03:13:08.704646
[0m03:13:08.707857 [debug] [Thread-1 (]: Began executing node model.monzo_task.dim_accounts
[0m03:13:08.771202 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.dim_accounts"
[0m03:13:08.786320 [debug] [Thread-1 (]: On model.monzo_task.dim_accounts: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.dim_accounts"} */


  create or replace view `silicon-parity-396203`.`monzo`.`dim_accounts`
  OPTIONS()
  as 

WITH account_meta AS (

    SELECT
        `account_type`,
  `account_id`,
  `user_id`
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

),

spine AS (

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('true' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

    UNION ALL

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('false' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_closed`

    UNION ALL

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('true' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
    
)

SELECT
    to_hex(md5(cast(coalesce(cast(spine.account_id as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(spine.recorded_at as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS surrogate_key,
    spine.account_id as natural_key,
    spine.is_open,
    account_meta.`account_type`,
  account_meta.`user_id`,
    spine.recorded_at as valid_from,
    COALESCE(LEAD(spine.recorded_at) OVER (PARTITION BY spine.account_id ORDER BY spine.recorded_at ASC), CURRENT_TIMESTAMP()) AS valid_to
FROM
    spine
    INNER JOIN account_meta ON account_meta.account_id = spine.account_id
ORDER BY
    natural_key,
    valid_from;


[0m03:13:10.544149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:915a022b-1f72-4222-a27c-18796906924b&page=queryresults
[0m03:13:10.572297 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_accounts (execute): 03:13:08.709827 => 03:13:10.571251
[0m03:13:10.576422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd77b160>]}
[0m03:13:10.580680 [info ] [Thread-1 (]: 4 of 7 OK created sql view model monzo.dim_accounts ............................ [[32mCREATE VIEW (0 processed)[0m in 3.86s]
[0m03:13:10.584300 [debug] [Thread-1 (]: Finished running node model.monzo_task.dim_accounts
[0m03:13:10.588100 [debug] [Thread-1 (]: Began running node model.monzo_task.dim_users
[0m03:13:10.590517 [info ] [Thread-1 (]: 5 of 7 START sql view model monzo.dim_users .................................... [RUN]
[0m03:13:10.593775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.dim_accounts, now model.monzo_task.dim_users)
[0m03:13:10.596624 [debug] [Thread-1 (]: Began compiling node model.monzo_task.dim_users
[0m03:13:10.607692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:11.919435 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.dim_users"
[0m03:13:11.942826 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_users (compile): 03:13:10.598618 => 03:13:11.942086
[0m03:13:11.945292 [debug] [Thread-1 (]: Began executing node model.monzo_task.dim_users
[0m03:13:11.955094 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.dim_users"
[0m03:13:11.970989 [debug] [Thread-1 (]: On model.monzo_task.dim_users: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.dim_users"} */


  create or replace view `silicon-parity-396203`.`monzo`.`dim_users`
  OPTIONS()
  as 

WITH account_meta AS (

    SELECT
        `account_type`,
  `account_id`,
  `user_id`
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

),

spine AS (

    SELECT DISTINCT
        user_id,
        recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`

    UNION ALL

    SELECT DISTINCT
        account_meta.user_id,
        stg_accounts_closed.recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_closed`
        INNER JOIN account_meta ON account_meta.account_id = stg_accounts_closed.account_id

    UNION ALL

    SELECT DISTINCT
        account_meta.user_id,
        stg_accounts_reopened.recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
        INNER JOIN account_meta ON account_meta.account_id = stg_accounts_reopened.account_id
    
),

first_created AS (

    SELECT
        user_id,
        MIN(recorded_at) as recorded_at
    FROM
        `silicon-parity-396203`.`monzo`.`stg_accounts_created`
    GROUP BY
        1

),

aggregates AS (

    SELECT
        spine.user_id,
        spine.recorded_at,
        COUNT(DISTINCT dim_accounts.natural_key) AS open_account_total,
        STRING_AGG(DISTINCT dim_accounts.natural_key) as open_accounts,
        STRING_AGG(DISTINCT dim_accounts.account_type) as open_account_types
    FROM
        spine
        LEFT JOIN `silicon-parity-396203`.`monzo`.`dim_accounts` ON dim_accounts.user_id = spine.user_id
            AND dim_accounts.valid_from <= spine.recorded_at
            AND dim_accounts.valid_to > spine.recorded_at
            AND dim_accounts.is_open
    GROUP BY
        1,2

)

SELECT
    to_hex(md5(cast(coalesce(cast(aggregates.user_id as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(aggregates.recorded_at as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS surrogate_key,
    aggregates.user_id as natural_key,
    first_created.recorded_at as first_created,
    aggregates.open_account_total,
    aggregates.open_accounts,
    aggregates.open_account_types,
    aggregates.recorded_at as valid_from,
    COALESCE(LEAD(aggregates.recorded_at) OVER (PARTITION BY aggregates.user_id ORDER BY aggregates.recorded_at ASC), CURRENT_TIMESTAMP()) AS valid_to
FROM
    aggregates
    LEFT JOIN first_created ON first_created.user_id = aggregates.user_id
ORDER BY
    natural_key,
    valid_from;


[0m03:13:13.772439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:08706398-3416-4534-aefa-44e4f47ab1fa&page=queryresults
[0m03:13:13.779005 [debug] [Thread-1 (]: Timing info for model.monzo_task.dim_users (execute): 03:13:11.948385 => 03:13:13.778510
[0m03:13:13.783801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd8a3100>]}
[0m03:13:13.786871 [info ] [Thread-1 (]: 5 of 7 OK created sql view model monzo.dim_users ............................... [[32mCREATE VIEW (0 processed)[0m in 3.19s]
[0m03:13:13.790199 [debug] [Thread-1 (]: Finished running node model.monzo_task.dim_users
[0m03:13:13.794512 [debug] [Thread-1 (]: Began running node model.monzo_task.fct_transactions
[0m03:13:13.797879 [info ] [Thread-1 (]: 6 of 7 START sql view model monzo.fct_transactions ............................. [RUN]
[0m03:13:13.801438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.dim_users, now model.monzo_task.fct_transactions)
[0m03:13:13.804393 [debug] [Thread-1 (]: Began compiling node model.monzo_task.fct_transactions
[0m03:13:13.817862 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.fct_transactions"
[0m03:13:13.835685 [debug] [Thread-1 (]: Timing info for model.monzo_task.fct_transactions (compile): 03:13:13.806689 => 03:13:13.835140
[0m03:13:13.837807 [debug] [Thread-1 (]: Began executing node model.monzo_task.fct_transactions
[0m03:13:13.848302 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.fct_transactions"
[0m03:13:13.869395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:13.878556 [debug] [Thread-1 (]: On model.monzo_task.fct_transactions: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.fct_transactions"} */


  create or replace view `silicon-parity-396203`.`monzo`.`fct_transactions`
  OPTIONS()
  as 

SELECT
    to_hex(md5(cast(coalesce(cast(account_transactions.date as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_transactions.account_id_hashed as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_transactions.transactions_num as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS unique_key,
    CAST(account_transactions.date AS TIMESTAMP) as recorded_at,
    account_transactions.account_id_hashed as account_natural_key,
    account_transactions.transactions_num,
    dim_accounts.surrogate_key as account_surrogate_key,
    dim_users.surrogate_key as user_surrogate_key
FROM
    `silicon-parity-396203`.`monzo`.`account_transactions`
    INNER JOIN `silicon-parity-396203`.`monzo`.`dim_accounts` ON dim_accounts.natural_key = account_transactions.account_id_hashed
        AND dim_accounts.valid_from <= CAST(account_transactions.date AS TIMESTAMP)
        AND dim_accounts.valid_to > CAST(account_transactions.date AS TIMESTAMP)
    INNER JOIN `silicon-parity-396203`.`monzo`.`dim_users` ON dim_users.natural_key = dim_accounts.user_id
        AND dim_users.valid_from <= CAST(account_transactions.date AS TIMESTAMP)
        AND dim_users.valid_to > CAST(account_transactions.date AS TIMESTAMP);


[0m03:13:16.826666 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:71a2c478-6d4a-456d-9f0d-d3b57c71a1b1&page=queryresults
[0m03:13:16.861342 [debug] [Thread-1 (]: Timing info for model.monzo_task.fct_transactions (execute): 03:13:13.839761 => 03:13:16.859854
[0m03:13:16.870627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd9b24d0>]}
[0m03:13:16.874907 [info ] [Thread-1 (]: 6 of 7 OK created sql view model monzo.fct_transactions ........................ [[32mCREATE VIEW (0 processed)[0m in 3.07s]
[0m03:13:16.879573 [debug] [Thread-1 (]: Finished running node model.monzo_task.fct_transactions
[0m03:13:16.884910 [debug] [Thread-1 (]: Began running node model.monzo_task.report_7d_active_users
[0m03:13:16.887774 [info ] [Thread-1 (]: 7 of 7 START sql view model monzo.report_7d_active_users ....................... [RUN]
[0m03:13:16.890963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.monzo_task.fct_transactions, now model.monzo_task.report_7d_active_users)
[0m03:13:16.893369 [debug] [Thread-1 (]: Began compiling node model.monzo_task.report_7d_active_users
[0m03:13:16.912787 [debug] [Thread-1 (]: Writing injected SQL for node "model.monzo_task.report_7d_active_users"
[0m03:13:16.929272 [debug] [Thread-1 (]: Timing info for model.monzo_task.report_7d_active_users (compile): 03:13:16.895388 => 03:13:16.928718
[0m03:13:16.932253 [debug] [Thread-1 (]: Began executing node model.monzo_task.report_7d_active_users
[0m03:13:16.939158 [debug] [Thread-1 (]: Writing runtime sql for node "model.monzo_task.report_7d_active_users"
[0m03:13:16.957060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:16.967620 [debug] [Thread-1 (]: On model.monzo_task.report_7d_active_users: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "model.monzo_task.report_7d_active_users"} */


  create or replace view `silicon-parity-396203`.`monzo`.`report_7d_active_users`
  OPTIONS()
  as 

WITH spine AS (

  SELECT 
    CAST(day AS TIMESTAMP) as day
  FROM 
    UNNEST(GENERATE_DATE_ARRAY(DATE('2019-01-14'), DATE('2020-01-01'), INTERVAL 1 DAY)) as day

),

users_daily AS (

  SELECT
    spine.day,
    dim_users.natural_key
  FROM
    spine
    INNER JOIN `silicon-parity-396203`.`monzo`.`dim_users` ON dim_users.valid_from <= spine.day
      AND dim_users.valid_to > spine.day
      AND dim_users.open_account_total > 0

),

users_7d AS (

  SELECT
    spine.day as period_start,
    COUNT(DISTINCT users_daily.natural_key) as total_users
  FROM
    spine
    LEFT JOIN users_daily ON users_daily.day >= spine.day
      AND users_daily.day < DATE_ADD(spine.day, INTERVAL 7 DAY)
  GROUP BY
    1

),

transactions_7d AS (

  SELECT
    spine.day as period_start,
    COUNT(fct_transactions.unique_key) as total_transactions,
    COUNT(DISTINCT dim_users.natural_key) as active_users
  FROM
    spine
    LEFT JOIN `silicon-parity-396203`.`monzo`.`fct_transactions` ON fct_transactions.recorded_at >= spine.day
      AND fct_transactions.recorded_at < DATE_ADD(spine.day, INTERVAL 7 DAY)
    LEFT JOIN `silicon-parity-396203`.`monzo`.`dim_users` ON dim_users.surrogate_key = fct_transactions.user_surrogate_key
  GROUP BY
    1

)

SELECT
  spine.day as period_start,
  DATE_ADD(spine.day, INTERVAL 6 DAY) as period_end,
  users_7d.total_users,
  transactions_7d.active_users,
  transactions_7d.total_transactions,
  ROUND(CAST(active_users/total_users AS DECIMAL), 2) as active_users_7d
FROM
  spine
  LEFT JOIN users_7d ON users_7d.period_start = spine.day
  LEFT JOIN transactions_7d ON transactions_7d.period_start = spine.day
ORDER BY
  1;


[0m03:13:19.412458 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:60d84734-3fc4-46df-8421-8418d4e760f5&page=queryresults
[0m03:13:19.424027 [debug] [Thread-1 (]: Timing info for model.monzo_task.report_7d_active_users (execute): 03:13:16.934137 => 03:13:19.423324
[0m03:13:19.428186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fbe8770-4c37-4379-b5ea-321363060758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd8a0ee0>]}
[0m03:13:19.431760 [info ] [Thread-1 (]: 7 of 7 OK created sql view model monzo.report_7d_active_users .................. [[32mCREATE VIEW (0 processed)[0m in 2.54s]
[0m03:13:19.436840 [debug] [Thread-1 (]: Finished running node model.monzo_task.report_7d_active_users
[0m03:13:19.441801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:19.443964 [debug] [MainThread]: Connection 'model.monzo_task.report_7d_active_users' was properly closed.
[0m03:13:19.447752 [info ] [MainThread]: 
[0m03:13:19.451233 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 1 minutes and 17.29 seconds (77.29s).
[0m03:13:19.460914 [debug] [MainThread]: Command end result
[0m03:13:19.494860 [info ] [MainThread]: 
[0m03:13:19.497474 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:13:19.501454 [info ] [MainThread]: 
[0m03:13:19.504113 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m03:13:19.510431 [debug] [MainThread]: Command `dbt run` succeeded at 03:13:19.510050 after 81.19 seconds
[0m03:13:19.512538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc60127f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd7b27a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fd8a05e0>]}
[0m03:13:19.514949 [debug] [MainThread]: Flushing usage events
[0m03:13:27.445864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0edeb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0d6f85b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0d6f8040>]}


============================== 03:13:27.452584 | d6d126aa-8493-480a-820a-2078eb17f7cd ==============================
[0m03:13:27.452584 [info ] [MainThread]: Running with dbt=1.5.5
[0m03:13:27.455888 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'quiet': 'False', 'write_json': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'introspect': 'True', 'target_path': 'None'}
[0m03:13:28.118861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6d126aa-8493-480a-820a-2078eb17f7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0b786440>]}
[0m03:13:28.149927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6d126aa-8493-480a-820a-2078eb17f7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0b7a89a0>]}
[0m03:13:28.152363 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:13:28.208796 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m03:13:30.041368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:13:30.042988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:13:30.053804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6d126aa-8493-480a-820a-2078eb17f7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0b472200>]}
[0m03:13:30.086560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6d126aa-8493-480a-820a-2078eb17f7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0b42d930>]}
[0m03:13:30.090458 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m03:13:30.093326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d126aa-8493-480a-820a-2078eb17f7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0b42f610>]}
[0m03:13:30.101065 [info ] [MainThread]: 
[0m03:13:30.104861 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:13:30.109661 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203_monzo'
[0m03:13:30.111659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:31.650101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d126aa-8493-480a-820a-2078eb17f7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0b42f4f0>]}
[0m03:13:31.659426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:31.663499 [info ] [MainThread]: 
[0m03:13:31.693600 [debug] [Thread-1 (]: Began running node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m03:13:31.695748 [info ] [Thread-1 (]: 1 of 25 START test dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to  [RUN]
[0m03:13:31.698339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_monzo, now test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6)
[0m03:13:31.700217 [debug] [Thread-1 (]: Began compiling node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m03:13:31.744933 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"
[0m03:13:31.764516 [debug] [Thread-1 (]: Timing info for test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6 (compile): 03:13:31.701940 => 03:13:31.763772
[0m03:13:31.767063 [debug] [Thread-1 (]: Began executing node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m03:13:31.800056 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"
[0m03:13:31.819450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:31.828697 [debug] [Thread-1 (]: On test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        natural_key as partition_by_col,
        
        valid_from as lower_bound,
        valid_to as upper_bound,

        lead(valid_from) over (
            partition by natural_key
            order by valid_from, valid_to
        ) as next_lower_bound,

        row_number() over (
            partition by natural_key
            order by valid_from desc, valid_to desc
        ) = 1 as is_last_record

    from `silicon-parity-396203`.`monzo`.`dim_accounts`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m03:13:38.452934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:4bd82201-6d35-49ac-ac6f-8c007669cebe&page=queryresults
[0m03:13:38.464464 [debug] [Thread-1 (]: Timing info for test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6 (execute): 03:13:31.768836 => 03:13:38.463549
[0m03:13:38.468310 [info ] [Thread-1 (]: 1 of 25 PASS dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to  [[32mPASS[0m in 6.77s]
[0m03:13:38.471888 [debug] [Thread-1 (]: Finished running node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m03:13:38.475849 [debug] [Thread-1 (]: Began running node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m03:13:38.478143 [info ] [Thread-1 (]: 2 of 25 START test dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to  [RUN]
[0m03:13:38.480651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6, now test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d)
[0m03:13:38.482931 [debug] [Thread-1 (]: Began compiling node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m03:13:38.495176 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"
[0m03:13:38.510834 [debug] [Thread-1 (]: Timing info for test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d (compile): 03:13:38.484648 => 03:13:38.510293
[0m03:13:38.512847 [debug] [Thread-1 (]: Began executing node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m03:13:38.518312 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"
[0m03:13:38.533636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:38.541499 [debug] [Thread-1 (]: On test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        natural_key as partition_by_col,
        
        valid_from as lower_bound,
        valid_to as upper_bound,

        lead(valid_from) over (
            partition by natural_key
            order by valid_from, valid_to
        ) as next_lower_bound,

        row_number() over (
            partition by natural_key
            order by valid_from desc, valid_to desc
        ) = 1 as is_last_record

    from `silicon-parity-396203`.`monzo`.`dim_users`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m03:13:44.473749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:42203669-e016-4caa-aef2-70bf75b5b482&page=queryresults
[0m03:13:44.488517 [debug] [Thread-1 (]: Timing info for test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d (execute): 03:13:38.514409 => 03:13:44.486605
[0m03:13:44.496683 [info ] [Thread-1 (]: 2 of 25 PASS dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to  [[32mPASS[0m in 6.02s]
[0m03:13:44.501549 [debug] [Thread-1 (]: Finished running node test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m03:13:44.505565 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_accounts_is_open.aafc57baad
[0m03:13:44.509417 [info ] [Thread-1 (]: 3 of 25 START test not_null_dim_accounts_is_open ............................... [RUN]
[0m03:13:44.515090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d, now test.monzo_task.not_null_dim_accounts_is_open.aafc57baad)
[0m03:13:44.518544 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_accounts_is_open.aafc57baad
[0m03:13:44.544237 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_accounts_is_open.aafc57baad"
[0m03:13:44.565088 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_is_open.aafc57baad (compile): 03:13:44.521829 => 03:13:44.564528
[0m03:13:44.566885 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_accounts_is_open.aafc57baad
[0m03:13:44.586902 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_accounts_is_open.aafc57baad"
[0m03:13:44.603738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:44.611610 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_accounts_is_open.aafc57baad: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_accounts_is_open.aafc57baad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_open
from `silicon-parity-396203`.`monzo`.`dim_accounts`
where is_open is null



      
    ) dbt_internal_test
[0m03:13:48.685185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:5bbea224-4483-46d3-a29b-db82be9dde05&page=queryresults
[0m03:13:48.689645 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_is_open.aafc57baad (execute): 03:13:44.568362 => 03:13:48.688775
[0m03:13:48.694131 [info ] [Thread-1 (]: 3 of 25 PASS not_null_dim_accounts_is_open ..................................... [[32mPASS[0m in 4.18s]
[0m03:13:48.699958 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_accounts_is_open.aafc57baad
[0m03:13:48.703483 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m03:13:48.706744 [info ] [Thread-1 (]: 4 of 25 START test not_null_dim_accounts_natural_key ........................... [RUN]
[0m03:13:48.710756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_accounts_is_open.aafc57baad, now test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3)
[0m03:13:48.714913 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m03:13:48.728099 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"
[0m03:13:48.750501 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3 (compile): 03:13:48.717737 => 03:13:48.749988
[0m03:13:48.752716 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m03:13:48.758535 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"
[0m03:13:48.791786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:48.802341 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select natural_key
from `silicon-parity-396203`.`monzo`.`dim_accounts`
where natural_key is null



      
    ) dbt_internal_test
[0m03:13:53.691832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:503f3371-a88f-4af1-b00c-87f30a3f7ed5&page=queryresults
[0m03:13:53.707725 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3 (execute): 03:13:48.754674 => 03:13:53.706562
[0m03:13:53.713983 [info ] [Thread-1 (]: 4 of 25 PASS not_null_dim_accounts_natural_key ................................. [[32mPASS[0m in 5.00s]
[0m03:13:53.721167 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m03:13:53.726014 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m03:13:53.729329 [info ] [Thread-1 (]: 5 of 25 START test not_null_dim_accounts_surrogate_key ......................... [RUN]
[0m03:13:53.734737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_accounts_natural_key.7e1ffcb3c3, now test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77)
[0m03:13:53.737189 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m03:13:53.745807 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77"
[0m03:13:53.762691 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77 (compile): 03:13:53.739196 => 03:13:53.761906
[0m03:13:53.765040 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m03:13:53.770912 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77"
[0m03:13:53.786741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:53.793859 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select surrogate_key
from `silicon-parity-396203`.`monzo`.`dim_accounts`
where surrogate_key is null



      
    ) dbt_internal_test
[0m03:13:57.449865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:4a966a69-ffb2-497b-85a8-3cf16c401491&page=queryresults
[0m03:13:57.462155 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77 (execute): 03:13:53.767102 => 03:13:57.460761
[0m03:13:57.469096 [info ] [Thread-1 (]: 5 of 25 PASS not_null_dim_accounts_surrogate_key ............................... [[32mPASS[0m in 3.73s]
[0m03:13:57.474534 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m03:13:57.478188 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m03:13:57.480883 [info ] [Thread-1 (]: 6 of 25 START test not_null_dim_accounts_valid_from ............................ [RUN]
[0m03:13:57.485533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_accounts_surrogate_key.cd62265b77, now test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9)
[0m03:13:57.487935 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m03:13:57.496582 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9"
[0m03:13:57.516836 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9 (compile): 03:13:57.489791 => 03:13:57.515913
[0m03:13:57.519711 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m03:13:57.541457 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9"
[0m03:13:57.559980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:57.568419 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_from
from `silicon-parity-396203`.`monzo`.`dim_accounts`
where valid_from is null



      
    ) dbt_internal_test
[0m03:14:01.881286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:a206d80f-b5fb-441d-83a1-9b3250036857&page=queryresults
[0m03:14:01.891973 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9 (execute): 03:13:57.521642 => 03:14:01.891011
[0m03:14:01.897067 [info ] [Thread-1 (]: 6 of 25 PASS not_null_dim_accounts_valid_from .................................. [[32mPASS[0m in 4.41s]
[0m03:14:01.901500 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m03:14:01.905484 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m03:14:01.908182 [info ] [Thread-1 (]: 7 of 25 START test not_null_dim_accounts_valid_to .............................. [RUN]
[0m03:14:01.911370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_accounts_valid_from.f50343b3b9, now test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2)
[0m03:14:01.913670 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m03:14:01.922745 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2"
[0m03:14:01.942196 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2 (compile): 03:14:01.915664 => 03:14:01.941696
[0m03:14:01.944436 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m03:14:01.950190 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2"
[0m03:14:01.966900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:01.975843 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_to
from `silicon-parity-396203`.`monzo`.`dim_accounts`
where valid_to is null



      
    ) dbt_internal_test
[0m03:14:05.874959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:95a55696-0a54-43b1-a3c0-3ab27cba0326&page=queryresults
[0m03:14:05.877761 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2 (execute): 03:14:01.946455 => 03:14:05.877261
[0m03:14:05.880711 [info ] [Thread-1 (]: 7 of 25 PASS not_null_dim_accounts_valid_to .................................... [[32mPASS[0m in 3.97s]
[0m03:14:05.883766 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m03:14:05.886305 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_users_natural_key.1191491ec3
[0m03:14:05.889848 [info ] [Thread-1 (]: 8 of 25 START test not_null_dim_users_natural_key .............................. [RUN]
[0m03:14:05.892752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_accounts_valid_to.944cc54bc2, now test.monzo_task.not_null_dim_users_natural_key.1191491ec3)
[0m03:14:05.894995 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_users_natural_key.1191491ec3
[0m03:14:05.903457 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_users_natural_key.1191491ec3"
[0m03:14:05.939280 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_natural_key.1191491ec3 (compile): 03:14:05.896913 => 03:14:05.938762
[0m03:14:05.941683 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_users_natural_key.1191491ec3
[0m03:14:05.949299 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_users_natural_key.1191491ec3"
[0m03:14:05.975217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:05.982200 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_users_natural_key.1191491ec3: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_users_natural_key.1191491ec3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select natural_key
from `silicon-parity-396203`.`monzo`.`dim_users`
where natural_key is null



      
    ) dbt_internal_test
[0m03:14:10.070820 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:2f782e0b-e3f6-4f7b-83a6-ea22d6782182&page=queryresults
[0m03:14:10.079193 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_natural_key.1191491ec3 (execute): 03:14:05.943651 => 03:14:10.077969
[0m03:14:10.084453 [info ] [Thread-1 (]: 8 of 25 PASS not_null_dim_users_natural_key .................................... [[32mPASS[0m in 4.19s]
[0m03:14:10.088817 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_users_natural_key.1191491ec3
[0m03:14:10.092749 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m03:14:10.095136 [info ] [Thread-1 (]: 9 of 25 START test not_null_dim_users_surrogate_key ............................ [RUN]
[0m03:14:10.098161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_users_natural_key.1191491ec3, now test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda)
[0m03:14:10.105641 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m03:14:10.120698 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda"
[0m03:14:10.138205 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda (compile): 03:14:10.109623 => 03:14:10.137704
[0m03:14:10.141123 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m03:14:10.163489 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda"
[0m03:14:10.177790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:10.186465 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select surrogate_key
from `silicon-parity-396203`.`monzo`.`dim_users`
where surrogate_key is null



      
    ) dbt_internal_test
[0m03:14:14.080517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:fd5bacc6-2fdb-4b2d-9d78-4047d2ce5c50&page=queryresults
[0m03:14:14.083338 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda (execute): 03:14:10.142743 => 03:14:14.082868
[0m03:14:14.086163 [info ] [Thread-1 (]: 9 of 25 PASS not_null_dim_users_surrogate_key .................................. [[32mPASS[0m in 3.99s]
[0m03:14:14.089150 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m03:14:14.092547 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_users_valid_from.8cd755bb40
[0m03:14:14.094813 [info ] [Thread-1 (]: 10 of 25 START test not_null_dim_users_valid_from .............................. [RUN]
[0m03:14:14.097637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_users_surrogate_key.7eb147ccda, now test.monzo_task.not_null_dim_users_valid_from.8cd755bb40)
[0m03:14:14.099901 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_users_valid_from.8cd755bb40
[0m03:14:14.109742 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_users_valid_from.8cd755bb40"
[0m03:14:14.128793 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_valid_from.8cd755bb40 (compile): 03:14:14.101903 => 03:14:14.128271
[0m03:14:14.131086 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_users_valid_from.8cd755bb40
[0m03:14:14.136668 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_users_valid_from.8cd755bb40"
[0m03:14:14.163700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:14.172605 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_users_valid_from.8cd755bb40: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_users_valid_from.8cd755bb40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_from
from `silicon-parity-396203`.`monzo`.`dim_users`
where valid_from is null



      
    ) dbt_internal_test
[0m03:14:18.188030 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:6e0e14c3-cdff-4468-9a91-0394dcf9cf08&page=queryresults
[0m03:14:18.204435 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_valid_from.8cd755bb40 (execute): 03:14:14.133016 => 03:14:18.202603
[0m03:14:18.219370 [info ] [Thread-1 (]: 10 of 25 PASS not_null_dim_users_valid_from .................................... [[32mPASS[0m in 4.12s]
[0m03:14:18.228428 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_users_valid_from.8cd755bb40
[0m03:14:18.232884 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_dim_users_valid_to.543960cf0d
[0m03:14:18.236585 [info ] [Thread-1 (]: 11 of 25 START test not_null_dim_users_valid_to ................................ [RUN]
[0m03:14:18.240644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_users_valid_from.8cd755bb40, now test.monzo_task.not_null_dim_users_valid_to.543960cf0d)
[0m03:14:18.244737 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_dim_users_valid_to.543960cf0d
[0m03:14:18.257807 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_dim_users_valid_to.543960cf0d"
[0m03:14:18.280190 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_valid_to.543960cf0d (compile): 03:14:18.247076 => 03:14:18.279647
[0m03:14:18.282536 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_dim_users_valid_to.543960cf0d
[0m03:14:18.288774 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_dim_users_valid_to.543960cf0d"
[0m03:14:18.312029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:18.321640 [debug] [Thread-1 (]: On test.monzo_task.not_null_dim_users_valid_to.543960cf0d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_dim_users_valid_to.543960cf0d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_to
from `silicon-parity-396203`.`monzo`.`dim_users`
where valid_to is null



      
    ) dbt_internal_test
[0m03:14:22.466945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:c028ace0-2386-40b2-84ed-8a117a4d959f&page=queryresults
[0m03:14:22.469926 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_dim_users_valid_to.543960cf0d (execute): 03:14:18.284359 => 03:14:22.469448
[0m03:14:22.472919 [info ] [Thread-1 (]: 11 of 25 PASS not_null_dim_users_valid_to ...................................... [[32mPASS[0m in 4.23s]
[0m03:14:22.475907 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_dim_users_valid_to.543960cf0d
[0m03:14:22.479603 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m03:14:22.481967 [info ] [Thread-1 (]: 12 of 25 START test not_null_fct_transactions_unique_key ....................... [RUN]
[0m03:14:22.484859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_dim_users_valid_to.543960cf0d, now test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d)
[0m03:14:22.487153 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m03:14:22.496804 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d"
[0m03:14:22.516855 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d (compile): 03:14:22.489285 => 03:14:22.516318
[0m03:14:22.518893 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m03:14:22.541253 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d"
[0m03:14:22.573811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:22.586241 [debug] [Thread-1 (]: On test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select unique_key
from `silicon-parity-396203`.`monzo`.`fct_transactions`
where unique_key is null



      
    ) dbt_internal_test
[0m03:14:27.293491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:50bbc067-a084-4e26-b430-b4dc7842c950&page=queryresults
[0m03:14:27.304586 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d (execute): 03:14:22.520725 => 03:14:27.303264
[0m03:14:27.309809 [info ] [Thread-1 (]: 12 of 25 PASS not_null_fct_transactions_unique_key ............................. [[32mPASS[0m in 4.82s]
[0m03:14:27.315148 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m03:14:27.318871 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m03:14:27.325174 [info ] [Thread-1 (]: 13 of 25 START test not_null_stg_accounts_closed_account_id .................... [RUN]
[0m03:14:27.328763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_fct_transactions_unique_key.8acdf74f4d, now test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea)
[0m03:14:27.332339 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m03:14:27.348822 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea"
[0m03:14:27.375927 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea (compile): 03:14:27.334430 => 03:14:27.375397
[0m03:14:27.378004 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m03:14:27.384254 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea"
[0m03:14:27.408076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:27.418096 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`monzo`.`stg_accounts_closed`
where account_id is null



      
    ) dbt_internal_test
[0m03:14:30.638093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:d8d01417-9c5a-4288-80cf-8c3e1647d6ed&page=queryresults
[0m03:14:30.642869 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea (execute): 03:14:27.380493 => 03:14:30.642022
[0m03:14:30.646933 [info ] [Thread-1 (]: 13 of 25 PASS not_null_stg_accounts_closed_account_id .......................... [[32mPASS[0m in 3.32s]
[0m03:14:30.652593 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m03:14:30.656048 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m03:14:30.658360 [info ] [Thread-1 (]: 14 of 25 START test not_null_stg_accounts_closed_recorded_at ................... [RUN]
[0m03:14:30.661026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_closed_account_id.682104c9ea, now test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94)
[0m03:14:30.663132 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m03:14:30.674277 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94"
[0m03:14:30.706576 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94 (compile): 03:14:30.665934 => 03:14:30.704370
[0m03:14:30.711395 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m03:14:30.722627 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94"
[0m03:14:30.739600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:30.746118 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`monzo`.`stg_accounts_closed`
where recorded_at is null



      
    ) dbt_internal_test
[0m03:14:34.204647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:1eb26ce3-b345-49ca-a2a0-e66250dadefb&page=queryresults
[0m03:14:34.223838 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94 (execute): 03:14:30.715959 => 03:14:34.221537
[0m03:14:34.236479 [info ] [Thread-1 (]: 14 of 25 PASS not_null_stg_accounts_closed_recorded_at ......................... [[32mPASS[0m in 3.57s]
[0m03:14:34.248158 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m03:14:34.259641 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m03:14:34.264283 [info ] [Thread-1 (]: 15 of 25 START test not_null_stg_accounts_created_account_id ................... [RUN]
[0m03:14:34.272216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_closed_recorded_at.824b452f94, now test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd)
[0m03:14:34.276459 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m03:14:34.298388 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"
[0m03:14:34.324276 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd (compile): 03:14:34.280459 => 03:14:34.323741
[0m03:14:34.326204 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m03:14:34.350369 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"
[0m03:14:34.372201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:34.380284 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`monzo`.`stg_accounts_created`
where account_id is null



      
    ) dbt_internal_test
[0m03:14:37.574960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:35304706-d1ee-4b78-b711-840b3e300c1a&page=queryresults
[0m03:14:37.589075 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd (execute): 03:14:34.327833 => 03:14:37.584822
[0m03:14:37.600195 [info ] [Thread-1 (]: 15 of 25 PASS not_null_stg_accounts_created_account_id ......................... [[32mPASS[0m in 3.33s]
[0m03:14:37.614098 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m03:14:37.622274 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m03:14:37.626136 [info ] [Thread-1 (]: 16 of 25 START test not_null_stg_accounts_created_recorded_at .................. [RUN]
[0m03:14:37.630871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_created_account_id.b3edb4cbfd, now test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df)
[0m03:14:37.633756 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m03:14:37.645283 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df"
[0m03:14:37.663224 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df (compile): 03:14:37.637461 => 03:14:37.662675
[0m03:14:37.665253 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m03:14:37.672545 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df"
[0m03:14:37.688409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:37.695468 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`monzo`.`stg_accounts_created`
where recorded_at is null



      
    ) dbt_internal_test
[0m03:14:40.947978 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:d486343f-afc8-42b7-be3d-6159323e3769&page=queryresults
[0m03:14:40.955676 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df (execute): 03:14:37.666928 => 03:14:40.955185
[0m03:14:40.958338 [info ] [Thread-1 (]: 16 of 25 PASS not_null_stg_accounts_created_recorded_at ........................ [[32mPASS[0m in 3.33s]
[0m03:14:40.961173 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m03:14:40.963806 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m03:14:40.966062 [info ] [Thread-1 (]: 17 of 25 START test not_null_stg_accounts_created_user_id ...................... [RUN]
[0m03:14:40.968824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_created_recorded_at.83f76044df, now test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7)
[0m03:14:40.971915 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m03:14:40.980286 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7"
[0m03:14:41.000212 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7 (compile): 03:14:40.973835 => 03:14:40.999701
[0m03:14:41.002408 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m03:14:41.009132 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7"
[0m03:14:41.042298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:41.052763 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `silicon-parity-396203`.`monzo`.`stg_accounts_created`
where user_id is null



      
    ) dbt_internal_test
[0m03:14:44.084341 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:689061e4-7946-425f-8376-8dcaa9f98932&page=queryresults
[0m03:14:44.087661 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7 (execute): 03:14:41.005138 => 03:14:44.087026
[0m03:14:44.091667 [info ] [Thread-1 (]: 17 of 25 PASS not_null_stg_accounts_created_user_id ............................ [[32mPASS[0m in 3.12s]
[0m03:14:44.095190 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m03:14:44.097994 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m03:14:44.100482 [info ] [Thread-1 (]: 18 of 25 START test not_null_stg_accounts_reopened_account_id .................. [RUN]
[0m03:14:44.103797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_created_user_id.5796d808a7, now test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af)
[0m03:14:44.106897 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m03:14:44.116137 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"
[0m03:14:44.131909 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af (compile): 03:14:44.108862 => 03:14:44.131198
[0m03:14:44.133878 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m03:14:44.156619 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"
[0m03:14:44.171197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:44.179151 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
where account_id is null



      
    ) dbt_internal_test
[0m03:14:47.332132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:ec83199e-9ec0-41bf-b4ca-cc055fc6c090&page=queryresults
[0m03:14:47.346845 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af (execute): 03:14:44.135401 => 03:14:47.344965
[0m03:14:47.364106 [info ] [Thread-1 (]: 18 of 25 PASS not_null_stg_accounts_reopened_account_id ........................ [[32mPASS[0m in 3.26s]
[0m03:14:47.371453 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m03:14:47.375526 [debug] [Thread-1 (]: Began running node test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m03:14:47.378584 [info ] [Thread-1 (]: 19 of 25 START test not_null_stg_accounts_reopened_recorded_at ................. [RUN]
[0m03:14:47.382110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af, now test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f)
[0m03:14:47.384871 [debug] [Thread-1 (]: Began compiling node test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m03:14:47.395303 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"
[0m03:14:47.412957 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f (compile): 03:14:47.387821 => 03:14:47.412453
[0m03:14:47.414885 [debug] [Thread-1 (]: Began executing node test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m03:14:47.421703 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"
[0m03:14:47.449350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:47.460062 [debug] [Thread-1 (]: On test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`monzo`.`stg_accounts_reopened`
where recorded_at is null



      
    ) dbt_internal_test
[0m03:14:50.898714 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:46654a86-0a8a-41f0-9aaa-a75dedf88435&page=queryresults
[0m03:14:50.901962 [debug] [Thread-1 (]: Timing info for test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f (execute): 03:14:47.416708 => 03:14:50.901358
[0m03:14:50.906679 [info ] [Thread-1 (]: 19 of 25 PASS not_null_stg_accounts_reopened_recorded_at ....................... [[32mPASS[0m in 3.52s]
[0m03:14:50.910048 [debug] [Thread-1 (]: Finished running node test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m03:14:50.912772 [debug] [Thread-1 (]: Began running node test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m03:14:50.915198 [info ] [Thread-1 (]: 20 of 25 START test relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_  [RUN]
[0m03:14:50.917920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f, now test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f)
[0m03:14:50.920419 [debug] [Thread-1 (]: Began compiling node test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m03:14:50.935425 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"
[0m03:14:50.967732 [debug] [Thread-1 (]: Timing info for test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f (compile): 03:14:50.923059 => 03:14:50.966971
[0m03:14:50.971542 [debug] [Thread-1 (]: Began executing node test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m03:14:50.978409 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"
[0m03:14:50.999352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:51.008893 [debug] [Thread-1 (]: On test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select account_surrogate_key as from_field
    from `silicon-parity-396203`.`monzo`.`fct_transactions`
    where account_surrogate_key is not null
),

parent as (
    select surrogate_key as to_field
    from `silicon-parity-396203`.`monzo`.`dim_accounts`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:14:55.759265 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:bb97a087-2326-462c-a199-4acb7632a807&page=queryresults
[0m03:14:55.778432 [debug] [Thread-1 (]: Timing info for test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f (execute): 03:14:50.974058 => 03:14:55.776559
[0m03:14:55.787964 [info ] [Thread-1 (]: 20 of 25 PASS relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_  [[32mPASS[0m in 4.87s]
[0m03:14:55.793571 [debug] [Thread-1 (]: Finished running node test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m03:14:55.797661 [debug] [Thread-1 (]: Began running node test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m03:14:55.802140 [info ] [Thread-1 (]: 21 of 25 START test relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_  [RUN]
[0m03:14:55.805757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f, now test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a)
[0m03:14:55.808414 [debug] [Thread-1 (]: Began compiling node test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m03:14:55.840000 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"
[0m03:14:55.862009 [debug] [Thread-1 (]: Timing info for test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a (compile): 03:14:55.810508 => 03:14:55.861339
[0m03:14:55.863854 [debug] [Thread-1 (]: Began executing node test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m03:14:55.870203 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"
[0m03:14:55.890296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:55.898609 [debug] [Thread-1 (]: On test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_surrogate_key as from_field
    from `silicon-parity-396203`.`monzo`.`fct_transactions`
    where user_surrogate_key is not null
),

parent as (
    select surrogate_key as to_field
    from `silicon-parity-396203`.`monzo`.`dim_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:15:01.097363 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:98d4a1c8-a695-46a9-8076-62e1d73bead8&page=queryresults
[0m03:15:01.113256 [debug] [Thread-1 (]: Timing info for test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a (execute): 03:14:55.865621 => 03:15:01.111281
[0m03:15:01.122239 [info ] [Thread-1 (]: 21 of 25 PASS relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_  [[32mPASS[0m in 5.32s]
[0m03:15:01.127000 [debug] [Thread-1 (]: Finished running node test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m03:15:01.131049 [debug] [Thread-1 (]: Began running node test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m03:15:01.134688 [info ] [Thread-1 (]: 22 of 25 START test unique_dim_accounts_surrogate_key .......................... [RUN]
[0m03:15:01.137909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a, now test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064)
[0m03:15:01.140368 [debug] [Thread-1 (]: Began compiling node test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m03:15:01.153357 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064"
[0m03:15:01.181386 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064 (compile): 03:15:01.142237 => 03:15:01.180349
[0m03:15:01.186028 [debug] [Thread-1 (]: Began executing node test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m03:15:01.202417 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064"
[0m03:15:01.223729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:01.234499 [debug] [Thread-1 (]: On test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select surrogate_key as unique_field
  from `silicon-parity-396203`.`monzo`.`dim_accounts`
  where surrogate_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m03:15:05.274516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:77d2296b-4446-43eb-bff8-bdf233542d8e&page=queryresults
[0m03:15:05.289995 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064 (execute): 03:15:01.189485 => 03:15:05.287633
[0m03:15:05.304966 [info ] [Thread-1 (]: 22 of 25 PASS unique_dim_accounts_surrogate_key ................................ [[32mPASS[0m in 4.17s]
[0m03:15:05.311906 [debug] [Thread-1 (]: Finished running node test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m03:15:05.317997 [debug] [Thread-1 (]: Began running node test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m03:15:05.321457 [info ] [Thread-1 (]: 23 of 25 START test unique_dim_users_surrogate_key ............................. [RUN]
[0m03:15:05.325448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.unique_dim_accounts_surrogate_key.aa8b761064, now test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8)
[0m03:15:05.328308 [debug] [Thread-1 (]: Began compiling node test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m03:15:05.341890 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8"
[0m03:15:05.376897 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8 (compile): 03:15:05.331855 => 03:15:05.376258
[0m03:15:05.379091 [debug] [Thread-1 (]: Began executing node test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m03:15:05.387049 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8"
[0m03:15:05.407642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:05.417269 [debug] [Thread-1 (]: On test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select surrogate_key as unique_field
  from `silicon-parity-396203`.`monzo`.`dim_users`
  where surrogate_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m03:15:09.444936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:e7dc21d8-1314-4e11-8784-5cce2e43bad3&page=queryresults
[0m03:15:09.448934 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8 (execute): 03:15:05.381999 => 03:15:09.448419
[0m03:15:09.452099 [info ] [Thread-1 (]: 23 of 25 PASS unique_dim_users_surrogate_key ................................... [[32mPASS[0m in 4.13s]
[0m03:15:09.455033 [debug] [Thread-1 (]: Finished running node test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m03:15:09.457416 [debug] [Thread-1 (]: Began running node test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6
[0m03:15:09.459581 [info ] [Thread-1 (]: 24 of 25 START test unique_fct_transactions_unique_key ......................... [RUN]
[0m03:15:09.462413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.unique_dim_users_surrogate_key.6aad9a59e8, now test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6)
[0m03:15:09.465363 [debug] [Thread-1 (]: Began compiling node test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6
[0m03:15:09.490002 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6"
[0m03:15:09.510148 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6 (compile): 03:15:09.467193 => 03:15:09.509597
[0m03:15:09.512255 [debug] [Thread-1 (]: Began executing node test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6
[0m03:15:09.518480 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6"
[0m03:15:09.538816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:09.549776 [debug] [Thread-1 (]: On test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select unique_key as unique_field
  from `silicon-parity-396203`.`monzo`.`fct_transactions`
  where unique_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m03:15:14.478717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:cabb245e-8402-4c84-818a-c4f7513821a9&page=queryresults
[0m03:15:14.487773 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6 (execute): 03:15:09.514841 => 03:15:14.486335
[0m03:15:14.493003 [info ] [Thread-1 (]: 24 of 25 PASS unique_fct_transactions_unique_key ............................... [[32mPASS[0m in 5.03s]
[0m03:15:14.503804 [debug] [Thread-1 (]: Finished running node test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6
[0m03:15:14.507513 [debug] [Thread-1 (]: Began running node test.monzo_task.unique_stg_accounts_created_account_id.d00a929146
[0m03:15:14.510127 [info ] [Thread-1 (]: 25 of 25 START test unique_stg_accounts_created_account_id ..................... [RUN]
[0m03:15:14.513730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.monzo_task.unique_fct_transactions_unique_key.3151c30ad6, now test.monzo_task.unique_stg_accounts_created_account_id.d00a929146)
[0m03:15:14.517332 [debug] [Thread-1 (]: Began compiling node test.monzo_task.unique_stg_accounts_created_account_id.d00a929146
[0m03:15:14.528247 [debug] [Thread-1 (]: Writing injected SQL for node "test.monzo_task.unique_stg_accounts_created_account_id.d00a929146"
[0m03:15:14.554230 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_stg_accounts_created_account_id.d00a929146 (compile): 03:15:14.519442 => 03:15:14.553741
[0m03:15:14.556222 [debug] [Thread-1 (]: Began executing node test.monzo_task.unique_stg_accounts_created_account_id.d00a929146
[0m03:15:14.561763 [debug] [Thread-1 (]: Writing runtime sql for node "test.monzo_task.unique_stg_accounts_created_account_id.d00a929146"
[0m03:15:14.578719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:14.589032 [debug] [Thread-1 (]: On test.monzo_task.unique_stg_accounts_created_account_id.d00a929146: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "monzo_task", "target_name": "dev", "node_id": "test.monzo_task.unique_stg_accounts_created_account_id.d00a929146"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select account_id as unique_field
  from `silicon-parity-396203`.`monzo`.`stg_accounts_created`
  where account_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m03:15:18.479407 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:e2f71917-1377-4cc1-ae0a-61ff86262ac5&page=queryresults
[0m03:15:18.491048 [debug] [Thread-1 (]: Timing info for test.monzo_task.unique_stg_accounts_created_account_id.d00a929146 (execute): 03:15:14.558027 => 03:15:18.489675
[0m03:15:18.499066 [info ] [Thread-1 (]: 25 of 25 PASS unique_stg_accounts_created_account_id ........................... [[32mPASS[0m in 3.98s]
[0m03:15:18.509614 [debug] [Thread-1 (]: Finished running node test.monzo_task.unique_stg_accounts_created_account_id.d00a929146
[0m03:15:18.523904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:18.527813 [debug] [MainThread]: Connection 'test.monzo_task.unique_stg_accounts_created_account_id.d00a929146' was properly closed.
[0m03:15:18.532128 [info ] [MainThread]: 
[0m03:15:18.538473 [info ] [MainThread]: Finished running 25 tests in 0 hours 1 minutes and 48.43 seconds (108.43s).
[0m03:15:18.564931 [debug] [MainThread]: Command end result
[0m03:15:18.714769 [info ] [MainThread]: 
[0m03:15:18.718339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:15:18.721109 [info ] [MainThread]: 
[0m03:15:18.723857 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m03:15:18.727173 [debug] [MainThread]: Command `dbt test` succeeded at 03:15:18.726816 after 111.31 seconds
[0m03:15:18.729563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0edeb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0c1ed1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf0c201c60>]}
[0m03:15:18.732246 [debug] [MainThread]: Flushing usage events
[0m06:05:33.311823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3434f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32c6c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc32c6c040>]}


============================== 06:05:33.322806 | 7d2b5fa3-8093-4ba2-8ff4-fc15cef01363 ==============================
[0m06:05:33.322806 [info ] [MainThread]: Running with dbt=1.5.5
[0m06:05:33.326015 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'version_check': 'True', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'static_parser': 'True'}
[0m06:05:34.495164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30c14940>]}
[0m06:05:34.525830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30c06110>]}
[0m06:05:34.528927 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:05:34.624123 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m06:05:34.720048 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m06:05:34.722682 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m06:05:34.724981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30c14880>]}
[0m06:05:39.343663 [debug] [MainThread]: 1603: static parser failed on analytics/dim_accounts.sql
[0m06:05:39.413311 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/dim_accounts.sql
[0m06:05:39.417604 [debug] [MainThread]: 1603: static parser failed on analytics/dim_users.sql
[0m06:05:39.433823 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/dim_users.sql
[0m06:05:39.438488 [debug] [MainThread]: 1603: static parser failed on analytics/fct_transactions.sql
[0m06:05:39.451662 [debug] [MainThread]: 1602: parser fallback to jinja rendering on analytics/fct_transactions.sql
[0m06:05:39.456986 [debug] [MainThread]: 1699: static parser successfully parsed analytics/report_7d_active_users.sql
[0m06:05:39.464549 [debug] [MainThread]: 1603: static parser failed on staging/stg_accounts_closed.sql
[0m06:05:39.479569 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_accounts_closed.sql
[0m06:05:39.483887 [debug] [MainThread]: 1603: static parser failed on staging/stg_accounts_created.sql
[0m06:05:39.495831 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_accounts_created.sql
[0m06:05:39.499996 [debug] [MainThread]: 1603: static parser failed on staging/stg_accounts_reopened.sql
[0m06:05:39.514694 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_accounts_reopened.sql
[0m06:05:40.003411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30a31e70>]}
[0m06:05:40.040340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30a30b50>]}
[0m06:05:40.042797 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:05:40.045688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30b07b80>]}
[0m06:05:40.052107 [info ] [MainThread]: 
[0m06:05:40.055555 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:05:40.059500 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203'
[0m06:05:40.061717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:41.420176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silicon-parity-396203, now list_silicon-parity-396203_retail)
[0m06:05:41.422389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:05:42.728323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30a31e70>]}
[0m06:05:42.733915 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:05:42.737255 [info ] [MainThread]: 
[0m06:05:42.766079 [debug] [Thread-1 (]: Began running node model.retail_task.stg_accounts_closed
[0m06:05:42.768313 [info ] [Thread-1 (]: 1 of 7 START sql incremental model retail.stg_accounts_closed .................. [RUN]
[0m06:05:42.771015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_retail, now model.retail_task.stg_accounts_closed)
[0m06:05:42.772999 [debug] [Thread-1 (]: Began compiling node model.retail_task.stg_accounts_closed
[0m06:05:42.787281 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.stg_accounts_closed"
[0m06:05:42.822951 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_closed (compile): 06:05:42.774750 => 06:05:42.822124
[0m06:05:42.825745 [debug] [Thread-1 (]: Began executing node model.retail_task.stg_accounts_closed
[0m06:05:42.949212 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.stg_accounts_closed"
[0m06:05:42.989476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:05:43.000580 [debug] [Thread-1 (]: On model.retail_task.stg_accounts_closed: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.stg_accounts_closed"} */

  
    

    create or replace table `silicon-parity-396203`.`retail`.`stg_accounts_closed`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(closed_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`retail`.`account_closed`
    
    

)

SELECT * FROM source
    );
  
[0m06:05:47.831341 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:c2dc284c-d872-48cf-88f9-b229dc067679&page=queryresults
[0m06:05:47.867405 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_closed (execute): 06:05:42.827936 => 06:05:47.866110
[0m06:05:47.871176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30c23670>]}
[0m06:05:47.873611 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model retail.stg_accounts_closed ............. [[32mCREATE TABLE (4.0k rows, 384.1 KiB processed)[0m in 5.10s]
[0m06:05:47.876391 [debug] [Thread-1 (]: Finished running node model.retail_task.stg_accounts_closed
[0m06:05:47.878507 [debug] [Thread-1 (]: Began running node model.retail_task.stg_accounts_created
[0m06:05:47.880583 [info ] [Thread-1 (]: 2 of 7 START sql incremental model retail.stg_accounts_created ................. [RUN]
[0m06:05:47.884052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.stg_accounts_closed, now model.retail_task.stg_accounts_created)
[0m06:05:47.886888 [debug] [Thread-1 (]: Began compiling node model.retail_task.stg_accounts_created
[0m06:05:47.894737 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.stg_accounts_created"
[0m06:05:47.910498 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_created (compile): 06:05:47.888559 => 06:05:47.909868
[0m06:05:47.912668 [debug] [Thread-1 (]: Began executing node model.retail_task.stg_accounts_created
[0m06:05:47.923832 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.stg_accounts_created"
[0m06:05:47.940372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:05:47.948520 [debug] [Thread-1 (]: On model.retail_task.stg_accounts_created: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.stg_accounts_created"} */

  
    

    create or replace table `silicon-parity-396203`.`retail`.`stg_accounts_created`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(created_ts AS TIMESTAMP) as recorded_at,
        account_type,
        account_id_hashed as account_id,
        user_id_hashed as user_id
    FROM
      `silicon-parity-396203`.`retail`.`account_created`
    
    

)

SELECT * FROM source
    );
  
[0m06:05:53.225822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:bc0ae031-d493-491b-ae74-7cde8bc59a4b&page=queryresults
[0m06:05:53.236773 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_created (execute): 06:05:47.914644 => 06:05:53.236217
[0m06:05:53.241508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2bf797e0>]}
[0m06:05:53.245469 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model retail.stg_accounts_created ............ [[32mCREATE TABLE (12.0k rows, 2.3 MiB processed)[0m in 5.36s]
[0m06:05:53.249935 [debug] [Thread-1 (]: Finished running node model.retail_task.stg_accounts_created
[0m06:05:53.253421 [debug] [Thread-1 (]: Began running node model.retail_task.stg_accounts_reopened
[0m06:05:53.255974 [info ] [Thread-1 (]: 3 of 7 START sql incremental model retail.stg_accounts_reopened ................ [RUN]
[0m06:05:53.258657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.stg_accounts_created, now model.retail_task.stg_accounts_reopened)
[0m06:05:53.260667 [debug] [Thread-1 (]: Began compiling node model.retail_task.stg_accounts_reopened
[0m06:05:53.281047 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.stg_accounts_reopened"
[0m06:05:53.297451 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_reopened (compile): 06:05:53.262262 => 06:05:53.296716
[0m06:05:53.299990 [debug] [Thread-1 (]: Began executing node model.retail_task.stg_accounts_reopened
[0m06:05:53.311107 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.stg_accounts_reopened"
[0m06:05:53.337899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:05:53.352126 [debug] [Thread-1 (]: On model.retail_task.stg_accounts_reopened: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.stg_accounts_reopened"} */

  
    

    create or replace table `silicon-parity-396203`.`retail`.`stg_accounts_reopened`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(reopened_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`retail`.`account_reopened`
    
    

)

SELECT * FROM source
    );
  
[0m06:05:58.253012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:8d928a78-b533-46ae-89b6-634da90f66d1&page=queryresults
[0m06:05:58.260171 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_reopened (execute): 06:05:53.301812 => 06:05:58.259448
[0m06:05:58.267973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2bf7e680>]}
[0m06:05:58.274172 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model retail.stg_accounts_reopened ........... [[32mCREATE TABLE (7.0 rows, 686.0 Bytes processed)[0m in 5.01s]
[0m06:05:58.285442 [debug] [Thread-1 (]: Finished running node model.retail_task.stg_accounts_reopened
[0m06:05:58.292722 [debug] [Thread-1 (]: Began running node model.retail_task.dim_accounts
[0m06:05:58.302670 [info ] [Thread-1 (]: 4 of 7 START sql view model retail.dim_accounts ................................ [RUN]
[0m06:05:58.320947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.stg_accounts_reopened, now model.retail_task.dim_accounts)
[0m06:05:58.428739 [debug] [Thread-1 (]: Began compiling node model.retail_task.dim_accounts
[0m06:05:58.454722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:00.367440 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.dim_accounts"
[0m06:06:00.430754 [debug] [Thread-1 (]: Timing info for model.retail_task.dim_accounts (compile): 06:05:58.431480 => 06:06:00.430032
[0m06:06:00.443840 [debug] [Thread-1 (]: Began executing node model.retail_task.dim_accounts
[0m06:06:00.563066 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.dim_accounts"
[0m06:06:00.615866 [debug] [Thread-1 (]: On model.retail_task.dim_accounts: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.dim_accounts"} */


  create or replace view `silicon-parity-396203`.`retail`.`dim_accounts`
  OPTIONS()
  as 

WITH account_meta AS (

    SELECT
        `account_type`,
  `account_id`,
  `user_id`
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_created`

),

spine AS (

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('true' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_created`

    UNION ALL

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('false' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_closed`

    UNION ALL

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('true' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_reopened`
    
)

SELECT
    to_hex(md5(cast(coalesce(cast(spine.account_id as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(spine.recorded_at as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS surrogate_key,
    spine.account_id as natural_key,
    spine.is_open,
    account_meta.`account_type`,
  account_meta.`user_id`,
    spine.recorded_at as valid_from,
    COALESCE(LEAD(spine.recorded_at) OVER (PARTITION BY spine.account_id ORDER BY spine.recorded_at ASC), CURRENT_TIMESTAMP()) AS valid_to
FROM
    spine
    INNER JOIN account_meta ON account_meta.account_id = spine.account_id
ORDER BY
    natural_key,
    valid_from;


[0m06:06:02.405253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:e86b7c1d-8ecb-49ee-a972-a3820cedd8b2&page=queryresults
[0m06:06:02.414679 [debug] [Thread-1 (]: Timing info for model.retail_task.dim_accounts (execute): 06:06:00.460320 => 06:06:02.414189
[0m06:06:02.418806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30a8ce50>]}
[0m06:06:02.424619 [info ] [Thread-1 (]: 4 of 7 OK created sql view model retail.dim_accounts ........................... [[32mCREATE VIEW (0 processed)[0m in 4.10s]
[0m06:06:02.429896 [debug] [Thread-1 (]: Finished running node model.retail_task.dim_accounts
[0m06:06:02.433982 [debug] [Thread-1 (]: Began running node model.retail_task.dim_users
[0m06:06:02.436687 [info ] [Thread-1 (]: 5 of 7 START sql view model retail.dim_users ................................... [RUN]
[0m06:06:02.442613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.dim_accounts, now model.retail_task.dim_users)
[0m06:06:02.445772 [debug] [Thread-1 (]: Began compiling node model.retail_task.dim_users
[0m06:06:02.461045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:03.698504 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.dim_users"
[0m06:06:03.728934 [debug] [Thread-1 (]: Timing info for model.retail_task.dim_users (compile): 06:06:02.447999 => 06:06:03.728062
[0m06:06:03.732247 [debug] [Thread-1 (]: Began executing node model.retail_task.dim_users
[0m06:06:03.778004 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.dim_users"
[0m06:06:03.861196 [debug] [Thread-1 (]: On model.retail_task.dim_users: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.dim_users"} */


  create or replace view `silicon-parity-396203`.`retail`.`dim_users`
  OPTIONS()
  as 

WITH account_meta AS (

    SELECT
        `account_type`,
  `account_id`,
  `user_id`
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_created`

),

spine AS (

    SELECT DISTINCT
        user_id,
        recorded_at
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_created`

    UNION ALL

    SELECT DISTINCT
        account_meta.user_id,
        stg_accounts_closed.recorded_at
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_closed`
        INNER JOIN account_meta ON account_meta.account_id = stg_accounts_closed.account_id

    UNION ALL

    SELECT DISTINCT
        account_meta.user_id,
        stg_accounts_reopened.recorded_at
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_reopened`
        INNER JOIN account_meta ON account_meta.account_id = stg_accounts_reopened.account_id
    
),

first_created AS (

    SELECT
        user_id,
        MIN(recorded_at) as recorded_at
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_created`
    GROUP BY
        1

),

aggregates AS (

    SELECT
        spine.user_id,
        spine.recorded_at,
        COUNT(DISTINCT dim_accounts.natural_key) AS open_account_total,
        STRING_AGG(DISTINCT dim_accounts.natural_key) as open_accounts,
        STRING_AGG(DISTINCT dim_accounts.account_type) as open_account_types
    FROM
        spine
        LEFT JOIN `silicon-parity-396203`.`retail`.`dim_accounts` ON dim_accounts.user_id = spine.user_id
            AND dim_accounts.valid_from <= spine.recorded_at
            AND dim_accounts.valid_to > spine.recorded_at
            AND dim_accounts.is_open
    GROUP BY
        1,2

)

SELECT
    to_hex(md5(cast(coalesce(cast(aggregates.user_id as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(aggregates.recorded_at as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS surrogate_key,
    aggregates.user_id as natural_key,
    first_created.recorded_at as first_created,
    aggregates.open_account_total,
    aggregates.open_accounts,
    aggregates.open_account_types,
    aggregates.recorded_at as valid_from,
    COALESCE(LEAD(aggregates.recorded_at) OVER (PARTITION BY aggregates.user_id ORDER BY aggregates.recorded_at ASC), CURRENT_TIMESTAMP()) AS valid_to
FROM
    aggregates
    LEFT JOIN first_created ON first_created.user_id = aggregates.user_id
ORDER BY
    natural_key,
    valid_from;


[0m06:06:06.130453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:f6c36a95-fcf4-48ab-9372-3ba145f95577&page=queryresults
[0m06:06:06.136002 [debug] [Thread-1 (]: Timing info for model.retail_task.dim_users (execute): 06:06:03.735407 => 06:06:06.135556
[0m06:06:06.141306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30a8f6a0>]}
[0m06:06:06.143742 [info ] [Thread-1 (]: 5 of 7 OK created sql view model retail.dim_users .............................. [[32mCREATE VIEW (0 processed)[0m in 3.70s]
[0m06:06:06.146470 [debug] [Thread-1 (]: Finished running node model.retail_task.dim_users
[0m06:06:06.149901 [debug] [Thread-1 (]: Began running node model.retail_task.fct_transactions
[0m06:06:06.152251 [info ] [Thread-1 (]: 6 of 7 START sql view model retail.fct_transactions ............................ [RUN]
[0m06:06:06.156644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.dim_users, now model.retail_task.fct_transactions)
[0m06:06:06.158803 [debug] [Thread-1 (]: Began compiling node model.retail_task.fct_transactions
[0m06:06:06.172440 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.fct_transactions"
[0m06:06:06.191489 [debug] [Thread-1 (]: Timing info for model.retail_task.fct_transactions (compile): 06:06:06.160471 => 06:06:06.190711
[0m06:06:06.194036 [debug] [Thread-1 (]: Began executing node model.retail_task.fct_transactions
[0m06:06:06.203004 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.fct_transactions"
[0m06:06:06.220005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:06.233829 [debug] [Thread-1 (]: On model.retail_task.fct_transactions: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.fct_transactions"} */


  create or replace view `silicon-parity-396203`.`retail`.`fct_transactions`
  OPTIONS()
  as 

SELECT
    to_hex(md5(cast(coalesce(cast(account_transactions.date as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_transactions.account_id_hashed as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_transactions.transactions_num as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS unique_key,
    CAST(account_transactions.date AS TIMESTAMP) as recorded_at,
    account_transactions.account_id_hashed as account_natural_key,
    account_transactions.transactions_num,
    dim_accounts.surrogate_key as account_surrogate_key,
    dim_users.surrogate_key as user_surrogate_key
FROM
    `silicon-parity-396203`.`retail`.`account_transactions`
    INNER JOIN `silicon-parity-396203`.`retail`.`dim_accounts` ON dim_accounts.natural_key = account_transactions.account_id_hashed
        AND dim_accounts.valid_from <= CAST(account_transactions.date AS TIMESTAMP)
        AND dim_accounts.valid_to > CAST(account_transactions.date AS TIMESTAMP)
    INNER JOIN `silicon-parity-396203`.`retail`.`dim_users` ON dim_users.natural_key = dim_accounts.user_id
        AND dim_users.valid_from <= CAST(account_transactions.date AS TIMESTAMP)
        AND dim_users.valid_to > CAST(account_transactions.date AS TIMESTAMP);


[0m06:06:09.007800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:9c9d1f8e-e2c3-4608-9059-45070f3899cd&page=queryresults
[0m06:06:09.012668 [debug] [Thread-1 (]: Timing info for model.retail_task.fct_transactions (execute): 06:06:06.196060 => 06:06:09.012254
[0m06:06:09.015818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30a8c2e0>]}
[0m06:06:09.018649 [info ] [Thread-1 (]: 6 of 7 OK created sql view model retail.fct_transactions ....................... [[32mCREATE VIEW (0 processed)[0m in 2.86s]
[0m06:06:09.022350 [debug] [Thread-1 (]: Finished running node model.retail_task.fct_transactions
[0m06:06:09.025525 [debug] [Thread-1 (]: Began running node model.retail_task.report_7d_active_users
[0m06:06:09.027963 [info ] [Thread-1 (]: 7 of 7 START sql view model retail.report_7d_active_users ...................... [RUN]
[0m06:06:09.031540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.fct_transactions, now model.retail_task.report_7d_active_users)
[0m06:06:09.034133 [debug] [Thread-1 (]: Began compiling node model.retail_task.report_7d_active_users
[0m06:06:09.050653 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.report_7d_active_users"
[0m06:06:09.282273 [debug] [Thread-1 (]: Timing info for model.retail_task.report_7d_active_users (compile): 06:06:09.036117 => 06:06:09.281758
[0m06:06:09.284803 [debug] [Thread-1 (]: Began executing node model.retail_task.report_7d_active_users
[0m06:06:09.292297 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.report_7d_active_users"
[0m06:06:09.309504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:09.317738 [debug] [Thread-1 (]: On model.retail_task.report_7d_active_users: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.report_7d_active_users"} */


  create or replace view `silicon-parity-396203`.`retail`.`report_7d_active_users`
  OPTIONS()
  as 

WITH spine AS (

  SELECT 
    CAST(day AS TIMESTAMP) as day
  FROM 
    UNNEST(GENERATE_DATE_ARRAY(DATE('2019-01-14'), DATE('2020-01-01'), INTERVAL 1 DAY)) as day

),

users_daily AS (

  SELECT
    spine.day,
    dim_users.natural_key
  FROM
    spine
    INNER JOIN `silicon-parity-396203`.`retail`.`dim_users` ON dim_users.valid_from <= spine.day
      AND dim_users.valid_to > spine.day
      AND dim_users.open_account_total > 0

),

users_7d AS (

  SELECT
    spine.day as period_start,
    COUNT(DISTINCT users_daily.natural_key) as total_users
  FROM
    spine
    LEFT JOIN users_daily ON users_daily.day >= spine.day
      AND users_daily.day < DATE_ADD(spine.day, INTERVAL 7 DAY)
  GROUP BY
    1

),

transactions_7d AS (

  SELECT
    spine.day as period_start,
    COUNT(fct_transactions.unique_key) as total_transactions,
    COUNT(DISTINCT dim_users.natural_key) as active_users
  FROM
    spine
    LEFT JOIN `silicon-parity-396203`.`retail`.`fct_transactions` ON fct_transactions.recorded_at >= spine.day
      AND fct_transactions.recorded_at < DATE_ADD(spine.day, INTERVAL 7 DAY)
    LEFT JOIN `silicon-parity-396203`.`retail`.`dim_users` ON dim_users.surrogate_key = fct_transactions.user_surrogate_key
  GROUP BY
    1

)

SELECT
  spine.day as period_start,
  DATE_ADD(spine.day, INTERVAL 6 DAY) as period_end,
  users_7d.total_users,
  transactions_7d.active_users,
  transactions_7d.total_transactions,
  ROUND(CAST(active_users/total_users AS DECIMAL), 2) as active_users_7d
FROM
  spine
  LEFT JOIN users_7d ON users_7d.period_start = spine.day
  LEFT JOIN transactions_7d ON transactions_7d.period_start = spine.day
ORDER BY
  1;


[0m06:06:11.706391 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:657e29bd-8adb-4d4e-9a6a-bc5bd4ca260a&page=queryresults
[0m06:06:11.712206 [debug] [Thread-1 (]: Timing info for model.retail_task.report_7d_active_users (execute): 06:06:09.286932 => 06:06:11.711582
[0m06:06:11.715470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2b5fa3-8093-4ba2-8ff4-fc15cef01363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30a8c2e0>]}
[0m06:06:11.717892 [info ] [Thread-1 (]: 7 of 7 OK created sql view model retail.report_7d_active_users ................. [[32mCREATE VIEW (0 processed)[0m in 2.68s]
[0m06:06:11.720632 [debug] [Thread-1 (]: Finished running node model.retail_task.report_7d_active_users
[0m06:06:11.725266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:06:11.727166 [debug] [MainThread]: Connection 'model.retail_task.report_7d_active_users' was properly closed.
[0m06:06:11.729191 [info ] [MainThread]: 
[0m06:06:11.731276 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 31.67 seconds (31.67s).
[0m06:06:11.741923 [debug] [MainThread]: Command end result
[0m06:06:12.035638 [info ] [MainThread]: 
[0m06:06:12.045100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:06:12.049424 [info ] [MainThread]: 
[0m06:06:12.052687 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m06:06:12.056328 [debug] [MainThread]: Command `dbt run` succeeded at 06:06:12.055918 after 38.82 seconds
[0m06:06:12.058787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3434f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30b07b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc30c05b70>]}
[0m06:06:12.062959 [debug] [MainThread]: Flushing usage events
[0m06:06:22.149494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc80a0f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7f0cc5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7f0cc040>]}


============================== 06:06:22.156504 | 5b4ac1b0-e06e-4bfc-8e1f-eed683ce53d8 ==============================
[0m06:06:22.156504 [info ] [MainThread]: Running with dbt=1.5.5
[0m06:06:22.159234 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'write_json': 'True', 'target_path': 'None', 'version_check': 'True', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'introspect': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m06:06:22.953913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b4ac1b0-e06e-4bfc-8e1f-eed683ce53d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc80561930>]}
[0m06:06:22.984256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b4ac1b0-e06e-4bfc-8e1f-eed683ce53d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7d24ffd0>]}
[0m06:06:22.987013 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:06:23.043126 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m06:06:26.358783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:06:26.368735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:06:26.398348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b4ac1b0-e06e-4bfc-8e1f-eed683ce53d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7cf128c0>]}
[0m06:06:26.456348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b4ac1b0-e06e-4bfc-8e1f-eed683ce53d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7cecfcd0>]}
[0m06:06:26.465722 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:06:26.505184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b4ac1b0-e06e-4bfc-8e1f-eed683ce53d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7cecfd00>]}
[0m06:06:26.514588 [info ] [MainThread]: 
[0m06:06:26.523081 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:06:26.528528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203_retail'
[0m06:06:26.533015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:06:27.930649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b4ac1b0-e06e-4bfc-8e1f-eed683ce53d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7cecfbe0>]}
[0m06:06:27.935833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:06:27.939171 [info ] [MainThread]: 
[0m06:06:27.986626 [debug] [Thread-1 (]: Began running node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m06:06:28.001116 [info ] [Thread-1 (]: 1 of 25 START test dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to  [RUN]
[0m06:06:28.007180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_retail, now test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6)
[0m06:06:28.017480 [debug] [Thread-1 (]: Began compiling node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m06:06:28.100746 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"
[0m06:06:28.135226 [debug] [Thread-1 (]: Timing info for test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6 (compile): 06:06:28.022015 => 06:06:28.134530
[0m06:06:28.137801 [debug] [Thread-1 (]: Began executing node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m06:06:28.190773 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"
[0m06:06:28.224497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:28.237846 [debug] [Thread-1 (]: On test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        natural_key as partition_by_col,
        
        valid_from as lower_bound,
        valid_to as upper_bound,

        lead(valid_from) over (
            partition by natural_key
            order by valid_from, valid_to
        ) as next_lower_bound,

        row_number() over (
            partition by natural_key
            order by valid_from desc, valid_to desc
        ) = 1 as is_last_record

    from `silicon-parity-396203`.`retail`.`dim_accounts`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m06:06:33.110916 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:10bfc524-1872-45f1-803a-9491aff216a6&page=queryresults
[0m06:06:33.118153 [debug] [Thread-1 (]: Timing info for test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6 (execute): 06:06:28.139914 => 06:06:33.117312
[0m06:06:33.122343 [info ] [Thread-1 (]: 1 of 25 PASS dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to  [[32mPASS[0m in 5.12s]
[0m06:06:33.124938 [debug] [Thread-1 (]: Finished running node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m06:06:33.127082 [debug] [Thread-1 (]: Began running node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m06:06:33.128967 [info ] [Thread-1 (]: 2 of 25 START test dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to  [RUN]
[0m06:06:33.133107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6, now test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d)
[0m06:06:33.135480 [debug] [Thread-1 (]: Began compiling node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m06:06:33.161546 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"
[0m06:06:33.192492 [debug] [Thread-1 (]: Timing info for test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d (compile): 06:06:33.138440 => 06:06:33.191455
[0m06:06:33.201338 [debug] [Thread-1 (]: Began executing node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m06:06:33.210621 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"
[0m06:06:33.234999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:33.246024 [debug] [Thread-1 (]: On test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        natural_key as partition_by_col,
        
        valid_from as lower_bound,
        valid_to as upper_bound,

        lead(valid_from) over (
            partition by natural_key
            order by valid_from, valid_to
        ) as next_lower_bound,

        row_number() over (
            partition by natural_key
            order by valid_from desc, valid_to desc
        ) = 1 as is_last_record

    from `silicon-parity-396203`.`retail`.`dim_users`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m06:06:39.111392 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:508e8cca-d8cf-42ae-8e16-69f279813e97&page=queryresults
[0m06:06:39.115618 [debug] [Thread-1 (]: Timing info for test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d (execute): 06:06:33.205146 => 06:06:39.114910
[0m06:06:39.126135 [info ] [Thread-1 (]: 2 of 25 PASS dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to  [[32mPASS[0m in 5.99s]
[0m06:06:39.130013 [debug] [Thread-1 (]: Finished running node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m06:06:39.133819 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_accounts_is_open.aafc57baad
[0m06:06:39.142323 [info ] [Thread-1 (]: 3 of 25 START test not_null_dim_accounts_is_open ............................... [RUN]
[0m06:06:39.146241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d, now test.retail_task.not_null_dim_accounts_is_open.aafc57baad)
[0m06:06:39.150360 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_accounts_is_open.aafc57baad
[0m06:06:39.182374 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_accounts_is_open.aafc57baad"
[0m06:06:39.242148 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_is_open.aafc57baad (compile): 06:06:39.157640 => 06:06:39.241174
[0m06:06:39.245522 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_accounts_is_open.aafc57baad
[0m06:06:39.262091 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_accounts_is_open.aafc57baad"
[0m06:06:39.292240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:39.306859 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_accounts_is_open.aafc57baad: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_accounts_is_open.aafc57baad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_open
from `silicon-parity-396203`.`retail`.`dim_accounts`
where is_open is null



      
    ) dbt_internal_test
[0m06:06:42.428385 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:db45e1d2-b7e5-409c-8f9a-a0909364df70&page=queryresults
[0m06:06:42.432079 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_is_open.aafc57baad (execute): 06:06:39.255185 => 06:06:42.431433
[0m06:06:42.437265 [info ] [Thread-1 (]: 3 of 25 PASS not_null_dim_accounts_is_open ..................................... [[32mPASS[0m in 3.29s]
[0m06:06:42.441215 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_accounts_is_open.aafc57baad
[0m06:06:42.444601 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m06:06:42.447195 [info ] [Thread-1 (]: 4 of 25 START test not_null_dim_accounts_natural_key ........................... [RUN]
[0m06:06:42.450450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_accounts_is_open.aafc57baad, now test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3)
[0m06:06:42.458931 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m06:06:42.475682 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"
[0m06:06:42.512825 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3 (compile): 06:06:42.463138 => 06:06:42.511930
[0m06:06:42.516597 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m06:06:42.535049 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"
[0m06:06:42.575778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:42.597804 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select natural_key
from `silicon-parity-396203`.`retail`.`dim_accounts`
where natural_key is null



      
    ) dbt_internal_test
[0m06:06:47.084325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:2fefd794-7c74-4ddf-bb8c-a3bc16ebf1ab&page=queryresults
[0m06:06:47.096972 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3 (execute): 06:06:42.527162 => 06:06:47.095967
[0m06:06:47.101551 [info ] [Thread-1 (]: 4 of 25 PASS not_null_dim_accounts_natural_key ................................. [[32mPASS[0m in 4.65s]
[0m06:06:47.110185 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m06:06:47.113775 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m06:06:47.116934 [info ] [Thread-1 (]: 5 of 25 START test not_null_dim_accounts_surrogate_key ......................... [RUN]
[0m06:06:47.122214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3, now test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77)
[0m06:06:47.125503 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m06:06:47.134200 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77"
[0m06:06:47.160507 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77 (compile): 06:06:47.127311 => 06:06:47.159813
[0m06:06:47.165750 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m06:06:47.235940 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77"
[0m06:06:47.274663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:47.286168 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select surrogate_key
from `silicon-parity-396203`.`retail`.`dim_accounts`
where surrogate_key is null



      
    ) dbt_internal_test
[0m06:06:51.257941 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:200cff92-6979-495a-807b-8c3566d646d6&page=queryresults
[0m06:06:51.268034 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77 (execute): 06:06:47.227932 => 06:06:51.265357
[0m06:06:51.276392 [info ] [Thread-1 (]: 5 of 25 PASS not_null_dim_accounts_surrogate_key ............................... [[32mPASS[0m in 4.16s]
[0m06:06:51.280258 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m06:06:51.283675 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m06:06:51.286260 [info ] [Thread-1 (]: 6 of 25 START test not_null_dim_accounts_valid_from ............................ [RUN]
[0m06:06:51.291883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77, now test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9)
[0m06:06:51.293907 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m06:06:51.302762 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9"
[0m06:06:51.319467 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9 (compile): 06:06:51.295704 => 06:06:51.318778
[0m06:06:51.322970 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m06:06:51.329399 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9"
[0m06:06:51.350871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:51.360910 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_from
from `silicon-parity-396203`.`retail`.`dim_accounts`
where valid_from is null



      
    ) dbt_internal_test
[0m06:06:55.482175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:67dff1d3-f24c-492f-8e25-32426db8d9d2&page=queryresults
[0m06:06:55.500018 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9 (execute): 06:06:51.324794 => 06:06:55.497099
[0m06:06:55.511886 [info ] [Thread-1 (]: 6 of 25 PASS not_null_dim_accounts_valid_from .................................. [[32mPASS[0m in 4.22s]
[0m06:06:55.517952 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m06:06:55.522275 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m06:06:55.526520 [info ] [Thread-1 (]: 7 of 25 START test not_null_dim_accounts_valid_to .............................. [RUN]
[0m06:06:55.531003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9, now test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2)
[0m06:06:55.533508 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m06:06:55.545089 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2"
[0m06:06:55.563861 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2 (compile): 06:06:55.535500 => 06:06:55.563282
[0m06:06:55.566407 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m06:06:55.581620 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2"
[0m06:06:55.608077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:06:55.619745 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_to
from `silicon-parity-396203`.`retail`.`dim_accounts`
where valid_to is null



      
    ) dbt_internal_test
[0m06:06:59.887525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:49f7269b-3040-43c4-8e78-42850c472285&page=queryresults
[0m06:06:59.903334 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2 (execute): 06:06:55.568305 => 06:06:59.901416
[0m06:06:59.916724 [info ] [Thread-1 (]: 7 of 25 PASS not_null_dim_accounts_valid_to .................................... [[32mPASS[0m in 4.39s]
[0m06:06:59.927366 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m06:06:59.932389 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_users_natural_key.1191491ec3
[0m06:06:59.935965 [info ] [Thread-1 (]: 8 of 25 START test not_null_dim_users_natural_key .............................. [RUN]
[0m06:06:59.940569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2, now test.retail_task.not_null_dim_users_natural_key.1191491ec3)
[0m06:06:59.945227 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_users_natural_key.1191491ec3
[0m06:06:59.959646 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_users_natural_key.1191491ec3"
[0m06:06:59.980762 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_natural_key.1191491ec3 (compile): 06:06:59.948549 => 06:06:59.980269
[0m06:06:59.983111 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_users_natural_key.1191491ec3
[0m06:06:59.989148 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_users_natural_key.1191491ec3"
[0m06:07:00.013300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:00.029826 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_users_natural_key.1191491ec3: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_users_natural_key.1191491ec3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select natural_key
from `silicon-parity-396203`.`retail`.`dim_users`
where natural_key is null



      
    ) dbt_internal_test
[0m06:07:04.547823 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:50eb9690-4e34-4c79-8494-459958d7c055&page=queryresults
[0m06:07:04.559402 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_natural_key.1191491ec3 (execute): 06:06:59.985057 => 06:07:04.557527
[0m06:07:04.573289 [info ] [Thread-1 (]: 8 of 25 PASS not_null_dim_users_natural_key .................................... [[32mPASS[0m in 4.63s]
[0m06:07:04.588509 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_users_natural_key.1191491ec3
[0m06:07:04.596170 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m06:07:04.600331 [info ] [Thread-1 (]: 9 of 25 START test not_null_dim_users_surrogate_key ............................ [RUN]
[0m06:07:04.605164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_users_natural_key.1191491ec3, now test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda)
[0m06:07:04.608422 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m06:07:04.621111 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda"
[0m06:07:04.644345 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda (compile): 06:07:04.612824 => 06:07:04.643270
[0m06:07:04.646966 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m06:07:04.655383 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda"
[0m06:07:04.674118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:04.682788 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select surrogate_key
from `silicon-parity-396203`.`retail`.`dim_users`
where surrogate_key is null



      
    ) dbt_internal_test
[0m06:07:09.701918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:0816357d-3793-46d6-aa36-104f73599220&page=queryresults
[0m06:07:09.725246 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda (execute): 06:07:04.649155 => 06:07:09.721732
[0m06:07:09.738903 [info ] [Thread-1 (]: 9 of 25 PASS not_null_dim_users_surrogate_key .................................. [[32mPASS[0m in 5.13s]
[0m06:07:09.745499 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m06:07:09.750546 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_users_valid_from.8cd755bb40
[0m06:07:09.754360 [info ] [Thread-1 (]: 10 of 25 START test not_null_dim_users_valid_from .............................. [RUN]
[0m06:07:09.757950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda, now test.retail_task.not_null_dim_users_valid_from.8cd755bb40)
[0m06:07:09.760743 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_users_valid_from.8cd755bb40
[0m06:07:09.771900 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_users_valid_from.8cd755bb40"
[0m06:07:09.792285 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_valid_from.8cd755bb40 (compile): 06:07:09.763730 => 06:07:09.791574
[0m06:07:09.794969 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_users_valid_from.8cd755bb40
[0m06:07:09.803331 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_users_valid_from.8cd755bb40"
[0m06:07:09.823281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:09.831649 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_users_valid_from.8cd755bb40: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_users_valid_from.8cd755bb40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_from
from `silicon-parity-396203`.`retail`.`dim_users`
where valid_from is null



      
    ) dbt_internal_test
[0m06:07:13.939393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:568a9632-d3a5-45c3-8695-8356c743c809&page=queryresults
[0m06:07:13.945022 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_valid_from.8cd755bb40 (execute): 06:07:09.797926 => 06:07:13.943894
[0m06:07:13.950362 [info ] [Thread-1 (]: 10 of 25 PASS not_null_dim_users_valid_from .................................... [[32mPASS[0m in 4.19s]
[0m06:07:13.954076 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_users_valid_from.8cd755bb40
[0m06:07:13.957148 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_users_valid_to.543960cf0d
[0m06:07:13.959402 [info ] [Thread-1 (]: 11 of 25 START test not_null_dim_users_valid_to ................................ [RUN]
[0m06:07:13.962244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_users_valid_from.8cd755bb40, now test.retail_task.not_null_dim_users_valid_to.543960cf0d)
[0m06:07:13.965082 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_users_valid_to.543960cf0d
[0m06:07:13.973844 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_users_valid_to.543960cf0d"
[0m06:07:13.992108 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_valid_to.543960cf0d (compile): 06:07:13.967246 => 06:07:13.991417
[0m06:07:13.994431 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_users_valid_to.543960cf0d
[0m06:07:14.001166 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_users_valid_to.543960cf0d"
[0m06:07:14.018564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:14.026844 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_users_valid_to.543960cf0d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_users_valid_to.543960cf0d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_to
from `silicon-parity-396203`.`retail`.`dim_users`
where valid_to is null



      
    ) dbt_internal_test
[0m06:07:18.806377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:2cc86d08-a69e-4c9a-ab7a-894db564974b&page=queryresults
[0m06:07:18.809890 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_valid_to.543960cf0d (execute): 06:07:13.996508 => 06:07:18.809156
[0m06:07:18.813218 [info ] [Thread-1 (]: 11 of 25 PASS not_null_dim_users_valid_to ...................................... [[32mPASS[0m in 4.85s]
[0m06:07:18.817305 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_users_valid_to.543960cf0d
[0m06:07:18.821889 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m06:07:18.824507 [info ] [Thread-1 (]: 12 of 25 START test not_null_fct_transactions_unique_key ....................... [RUN]
[0m06:07:18.828157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_users_valid_to.543960cf0d, now test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d)
[0m06:07:18.830222 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m06:07:18.841153 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d"
[0m06:07:18.857003 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d (compile): 06:07:18.831966 => 06:07:18.856379
[0m06:07:18.859141 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m06:07:18.866075 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d"
[0m06:07:18.883194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:18.906691 [debug] [Thread-1 (]: On test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select unique_key
from `silicon-parity-396203`.`retail`.`fct_transactions`
where unique_key is null



      
    ) dbt_internal_test
[0m06:07:24.481177 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:732debef-cec9-47ef-b812-228546bcfc62&page=queryresults
[0m06:07:24.490541 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d (execute): 06:07:18.861034 => 06:07:24.489047
[0m06:07:24.496093 [info ] [Thread-1 (]: 12 of 25 PASS not_null_fct_transactions_unique_key ............................. [[32mPASS[0m in 5.67s]
[0m06:07:24.500902 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m06:07:24.504981 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m06:07:24.507266 [info ] [Thread-1 (]: 13 of 25 START test not_null_stg_accounts_closed_account_id .................... [RUN]
[0m06:07:24.510158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d, now test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea)
[0m06:07:24.512289 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m06:07:24.525015 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea"
[0m06:07:24.547425 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea (compile): 06:07:24.513967 => 06:07:24.546737
[0m06:07:24.549854 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m06:07:24.555982 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea"
[0m06:07:24.588210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:24.597998 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`retail`.`stg_accounts_closed`
where account_id is null



      
    ) dbt_internal_test
[0m06:07:28.033353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:7d15fb58-2b92-4fa9-b07a-269dee413508&page=queryresults
[0m06:07:28.042424 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea (execute): 06:07:24.551977 => 06:07:28.041043
[0m06:07:28.046284 [info ] [Thread-1 (]: 13 of 25 PASS not_null_stg_accounts_closed_account_id .......................... [[32mPASS[0m in 3.54s]
[0m06:07:28.050297 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m06:07:28.055136 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m06:07:28.057899 [info ] [Thread-1 (]: 14 of 25 START test not_null_stg_accounts_closed_recorded_at ................... [RUN]
[0m06:07:28.060608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea, now test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94)
[0m06:07:28.062610 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m06:07:28.074279 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94"
[0m06:07:28.098020 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94 (compile): 06:07:28.064516 => 06:07:28.096937
[0m06:07:28.108488 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m06:07:28.145828 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94"
[0m06:07:28.174677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:28.182373 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`retail`.`stg_accounts_closed`
where recorded_at is null



      
    ) dbt_internal_test
[0m06:07:31.720139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:165f3f8f-b6a0-4bc2-b630-44c315b58dd9&page=queryresults
[0m06:07:31.726568 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94 (execute): 06:07:28.131094 => 06:07:31.725523
[0m06:07:31.733421 [info ] [Thread-1 (]: 14 of 25 PASS not_null_stg_accounts_closed_recorded_at ......................... [[32mPASS[0m in 3.67s]
[0m06:07:31.744683 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m06:07:31.749480 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m06:07:31.755545 [info ] [Thread-1 (]: 15 of 25 START test not_null_stg_accounts_created_account_id ................... [RUN]
[0m06:07:31.760701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94, now test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd)
[0m06:07:31.764890 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m06:07:31.783617 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"
[0m06:07:31.808395 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd (compile): 06:07:31.768509 => 06:07:31.807794
[0m06:07:31.811084 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m06:07:31.837348 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"
[0m06:07:31.857819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:31.867660 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`retail`.`stg_accounts_created`
where account_id is null



      
    ) dbt_internal_test
[0m06:07:35.499873 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:2c388c0c-2c24-4df8-aed5-1770db4f1313&page=queryresults
[0m06:07:35.508120 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd (execute): 06:07:31.813031 => 06:07:35.507156
[0m06:07:35.513262 [info ] [Thread-1 (]: 15 of 25 PASS not_null_stg_accounts_created_account_id ......................... [[32mPASS[0m in 3.75s]
[0m06:07:35.517501 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m06:07:35.522341 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m06:07:35.525100 [info ] [Thread-1 (]: 16 of 25 START test not_null_stg_accounts_created_recorded_at .................. [RUN]
[0m06:07:35.528740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd, now test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df)
[0m06:07:35.531187 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m06:07:35.540333 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df"
[0m06:07:35.560421 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df (compile): 06:07:35.533201 => 06:07:35.559869
[0m06:07:35.562606 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m06:07:35.568888 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df"
[0m06:07:35.591387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:35.601132 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`retail`.`stg_accounts_created`
where recorded_at is null



      
    ) dbt_internal_test
[0m06:07:39.088003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:1cc07676-244b-4992-b09f-dcc3b97c1c84&page=queryresults
[0m06:07:39.095017 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df (execute): 06:07:35.564552 => 06:07:39.094323
[0m06:07:39.099732 [info ] [Thread-1 (]: 16 of 25 PASS not_null_stg_accounts_created_recorded_at ........................ [[32mPASS[0m in 3.57s]
[0m06:07:39.113708 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m06:07:39.141589 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m06:07:39.153762 [info ] [Thread-1 (]: 17 of 25 START test not_null_stg_accounts_created_user_id ...................... [RUN]
[0m06:07:39.160954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df, now test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7)
[0m06:07:39.168965 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m06:07:39.202047 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7"
[0m06:07:39.232163 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7 (compile): 06:07:39.177705 => 06:07:39.231329
[0m06:07:39.244447 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m06:07:39.259258 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7"
[0m06:07:39.302512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:39.325962 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `silicon-parity-396203`.`retail`.`stg_accounts_created`
where user_id is null



      
    ) dbt_internal_test
[0m06:07:42.713951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:d324a624-56cf-470f-a750-7fefbbfa77e9&page=queryresults
[0m06:07:42.717660 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7 (execute): 06:07:39.250478 => 06:07:42.716501
[0m06:07:42.722985 [info ] [Thread-1 (]: 17 of 25 PASS not_null_stg_accounts_created_user_id ............................ [[32mPASS[0m in 3.56s]
[0m06:07:42.726989 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m06:07:42.729912 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m06:07:42.732461 [info ] [Thread-1 (]: 18 of 25 START test not_null_stg_accounts_reopened_account_id .................. [RUN]
[0m06:07:42.737017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7, now test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af)
[0m06:07:42.739906 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m06:07:42.753401 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"
[0m06:07:42.777111 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af (compile): 06:07:42.742087 => 06:07:42.776286
[0m06:07:42.779767 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m06:07:42.813656 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"
[0m06:07:42.832681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:42.842981 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`retail`.`stg_accounts_reopened`
where account_id is null



      
    ) dbt_internal_test
[0m06:07:46.163577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:9a4e1150-bde3-44e5-911b-3706d8e89a09&page=queryresults
[0m06:07:46.176736 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af (execute): 06:07:42.781733 => 06:07:46.175250
[0m06:07:46.181834 [info ] [Thread-1 (]: 18 of 25 PASS not_null_stg_accounts_reopened_account_id ........................ [[32mPASS[0m in 3.44s]
[0m06:07:46.188437 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m06:07:46.191423 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m06:07:46.193588 [info ] [Thread-1 (]: 19 of 25 START test not_null_stg_accounts_reopened_recorded_at ................. [RUN]
[0m06:07:46.196189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af, now test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f)
[0m06:07:46.198025 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m06:07:46.207465 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"
[0m06:07:46.222377 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f (compile): 06:07:46.199642 => 06:07:46.221713
[0m06:07:46.224381 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m06:07:46.230185 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"
[0m06:07:46.248453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:46.259281 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`retail`.`stg_accounts_reopened`
where recorded_at is null



      
    ) dbt_internal_test
[0m06:07:50.058133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:5f719b16-a4fb-40eb-869d-8548d6fc4fc2&page=queryresults
[0m06:07:50.065291 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f (execute): 06:07:46.226087 => 06:07:50.063473
[0m06:07:50.072227 [info ] [Thread-1 (]: 19 of 25 PASS not_null_stg_accounts_reopened_recorded_at ....................... [[32mPASS[0m in 3.88s]
[0m06:07:50.076258 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m06:07:50.080054 [debug] [Thread-1 (]: Began running node test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m06:07:50.084202 [info ] [Thread-1 (]: 20 of 25 START test relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_  [RUN]
[0m06:07:50.087295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f, now test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f)
[0m06:07:50.089932 [debug] [Thread-1 (]: Began compiling node test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m06:07:50.114900 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"
[0m06:07:50.136669 [debug] [Thread-1 (]: Timing info for test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f (compile): 06:07:50.091778 => 06:07:50.135702
[0m06:07:50.139443 [debug] [Thread-1 (]: Began executing node test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m06:07:50.146949 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"
[0m06:07:50.170453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:50.178544 [debug] [Thread-1 (]: On test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select account_surrogate_key as from_field
    from `silicon-parity-396203`.`retail`.`fct_transactions`
    where account_surrogate_key is not null
),

parent as (
    select surrogate_key as to_field
    from `silicon-parity-396203`.`retail`.`dim_accounts`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:07:55.376049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:3e3856f4-6583-4200-8cd5-d02c6d067015&page=queryresults
[0m06:07:55.380152 [debug] [Thread-1 (]: Timing info for test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f (execute): 06:07:50.141861 => 06:07:55.379208
[0m06:07:55.384966 [info ] [Thread-1 (]: 20 of 25 PASS relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_  [[32mPASS[0m in 5.30s]
[0m06:07:55.388866 [debug] [Thread-1 (]: Finished running node test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m06:07:55.392122 [debug] [Thread-1 (]: Began running node test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m06:07:55.395000 [info ] [Thread-1 (]: 21 of 25 START test relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_  [RUN]
[0m06:07:55.399388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f, now test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a)
[0m06:07:55.402212 [debug] [Thread-1 (]: Began compiling node test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m06:07:55.418169 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"
[0m06:07:55.443787 [debug] [Thread-1 (]: Timing info for test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a (compile): 06:07:55.404699 => 06:07:55.442990
[0m06:07:55.446638 [debug] [Thread-1 (]: Began executing node test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m06:07:55.572015 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"
[0m06:07:55.590534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:55.600491 [debug] [Thread-1 (]: On test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_surrogate_key as from_field
    from `silicon-parity-396203`.`retail`.`fct_transactions`
    where user_surrogate_key is not null
),

parent as (
    select surrogate_key as to_field
    from `silicon-parity-396203`.`retail`.`dim_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:08:00.641667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:5f442988-46e7-4914-887f-69da353f431f&page=queryresults
[0m06:08:00.652208 [debug] [Thread-1 (]: Timing info for test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a (execute): 06:07:55.449519 => 06:08:00.650909
[0m06:08:00.657762 [info ] [Thread-1 (]: 21 of 25 PASS relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_  [[32mPASS[0m in 5.26s]
[0m06:08:00.664104 [debug] [Thread-1 (]: Finished running node test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m06:08:00.668456 [debug] [Thread-1 (]: Began running node test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m06:08:00.671411 [info ] [Thread-1 (]: 22 of 25 START test unique_dim_accounts_surrogate_key .......................... [RUN]
[0m06:08:00.674237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a, now test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064)
[0m06:08:00.676494 [debug] [Thread-1 (]: Began compiling node test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m06:08:00.688772 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064"
[0m06:08:00.708828 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064 (compile): 06:08:00.678423 => 06:08:00.708193
[0m06:08:00.711053 [debug] [Thread-1 (]: Began executing node test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m06:08:00.717987 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064"
[0m06:08:00.742051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:00.753864 [debug] [Thread-1 (]: On test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select surrogate_key as unique_field
  from `silicon-parity-396203`.`retail`.`dim_accounts`
  where surrogate_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:08:05.004518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:6ec4029e-3cde-4539-a1a8-162a84d7ea5b&page=queryresults
[0m06:08:05.007704 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064 (execute): 06:08:00.713007 => 06:08:05.007007
[0m06:08:05.010984 [info ] [Thread-1 (]: 22 of 25 PASS unique_dim_accounts_surrogate_key ................................ [[32mPASS[0m in 4.34s]
[0m06:08:05.014197 [debug] [Thread-1 (]: Finished running node test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m06:08:05.016902 [debug] [Thread-1 (]: Began running node test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m06:08:05.019605 [info ] [Thread-1 (]: 23 of 25 START test unique_dim_users_surrogate_key ............................. [RUN]
[0m06:08:05.027424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064, now test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8)
[0m06:08:05.032668 [debug] [Thread-1 (]: Began compiling node test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m06:08:05.055159 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8"
[0m06:08:05.074936 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8 (compile): 06:08:05.035283 => 06:08:05.074150
[0m06:08:05.077347 [debug] [Thread-1 (]: Began executing node test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m06:08:05.083852 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8"
[0m06:08:05.116637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:05.127475 [debug] [Thread-1 (]: On test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select surrogate_key as unique_field
  from `silicon-parity-396203`.`retail`.`dim_users`
  where surrogate_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:08:10.740498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:85cc811c-05ee-4952-9810-72372b2b83d6&page=queryresults
[0m06:08:10.752439 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8 (execute): 06:08:05.079566 => 06:08:10.750841
[0m06:08:10.759014 [info ] [Thread-1 (]: 23 of 25 PASS unique_dim_users_surrogate_key ................................... [[32mPASS[0m in 5.73s]
[0m06:08:10.763525 [debug] [Thread-1 (]: Finished running node test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m06:08:10.767109 [debug] [Thread-1 (]: Began running node test.retail_task.unique_fct_transactions_unique_key.3151c30ad6
[0m06:08:10.770110 [info ] [Thread-1 (]: 24 of 25 START test unique_fct_transactions_unique_key ......................... [RUN]
[0m06:08:10.774481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8, now test.retail_task.unique_fct_transactions_unique_key.3151c30ad6)
[0m06:08:10.777204 [debug] [Thread-1 (]: Began compiling node test.retail_task.unique_fct_transactions_unique_key.3151c30ad6
[0m06:08:10.792270 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.unique_fct_transactions_unique_key.3151c30ad6"
[0m06:08:10.810682 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_fct_transactions_unique_key.3151c30ad6 (compile): 06:08:10.779324 => 06:08:10.810030
[0m06:08:10.813100 [debug] [Thread-1 (]: Began executing node test.retail_task.unique_fct_transactions_unique_key.3151c30ad6
[0m06:08:10.829993 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.unique_fct_transactions_unique_key.3151c30ad6"
[0m06:08:10.849406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:10.862156 [debug] [Thread-1 (]: On test.retail_task.unique_fct_transactions_unique_key.3151c30ad6: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.unique_fct_transactions_unique_key.3151c30ad6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select unique_key as unique_field
  from `silicon-parity-396203`.`retail`.`fct_transactions`
  where unique_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:08:16.096418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:43d10354-02c9-48ad-9b86-12ddab9675f8&page=queryresults
[0m06:08:16.117154 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_fct_transactions_unique_key.3151c30ad6 (execute): 06:08:10.815176 => 06:08:16.114195
[0m06:08:16.124678 [info ] [Thread-1 (]: 24 of 25 PASS unique_fct_transactions_unique_key ............................... [[32mPASS[0m in 5.35s]
[0m06:08:16.132695 [debug] [Thread-1 (]: Finished running node test.retail_task.unique_fct_transactions_unique_key.3151c30ad6
[0m06:08:16.137050 [debug] [Thread-1 (]: Began running node test.retail_task.unique_stg_accounts_created_account_id.d00a929146
[0m06:08:16.140380 [info ] [Thread-1 (]: 25 of 25 START test unique_stg_accounts_created_account_id ..................... [RUN]
[0m06:08:16.145271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.unique_fct_transactions_unique_key.3151c30ad6, now test.retail_task.unique_stg_accounts_created_account_id.d00a929146)
[0m06:08:16.147633 [debug] [Thread-1 (]: Began compiling node test.retail_task.unique_stg_accounts_created_account_id.d00a929146
[0m06:08:16.159654 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.unique_stg_accounts_created_account_id.d00a929146"
[0m06:08:16.178795 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_stg_accounts_created_account_id.d00a929146 (compile): 06:08:16.149748 => 06:08:16.177836
[0m06:08:16.184315 [debug] [Thread-1 (]: Began executing node test.retail_task.unique_stg_accounts_created_account_id.d00a929146
[0m06:08:16.197830 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.unique_stg_accounts_created_account_id.d00a929146"
[0m06:08:16.224317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:16.234415 [debug] [Thread-1 (]: On test.retail_task.unique_stg_accounts_created_account_id.d00a929146: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.unique_stg_accounts_created_account_id.d00a929146"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select account_id as unique_field
  from `silicon-parity-396203`.`retail`.`stg_accounts_created`
  where account_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:08:19.565045 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:1d6d428f-3833-4d0d-ac38-9a9e56073000&page=queryresults
[0m06:08:19.572567 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_stg_accounts_created_account_id.d00a929146 (execute): 06:08:16.189551 => 06:08:19.571757
[0m06:08:19.576984 [info ] [Thread-1 (]: 25 of 25 PASS unique_stg_accounts_created_account_id ........................... [[32mPASS[0m in 3.43s]
[0m06:08:19.581330 [debug] [Thread-1 (]: Finished running node test.retail_task.unique_stg_accounts_created_account_id.d00a929146
[0m06:08:19.587248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:08:19.589727 [debug] [MainThread]: Connection 'test.retail_task.unique_stg_accounts_created_account_id.d00a929146' was properly closed.
[0m06:08:19.592313 [info ] [MainThread]: 
[0m06:08:19.596638 [info ] [MainThread]: Finished running 25 tests in 0 hours 1 minutes and 53.07 seconds (113.07s).
[0m06:08:19.608343 [debug] [MainThread]: Command end result
[0m06:08:19.665396 [info ] [MainThread]: 
[0m06:08:19.668423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:08:19.671270 [info ] [MainThread]: 
[0m06:08:19.674905 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m06:08:19.680544 [debug] [MainThread]: Command `dbt test` succeeded at 06:08:19.680225 after 117.56 seconds
[0m06:08:19.683383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc80a0f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7d01fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7ece8580>]}
[0m06:08:19.686278 [debug] [MainThread]: Flushing usage events
[0m06:36:53.847975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9b44f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd99b285b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd99b28040>]}


============================== 06:36:53.859380 | ff0df6b0-5aa6-4374-aa50-b3d218f7ee53 ==============================
[0m06:36:53.859380 [info ] [MainThread]: Running with dbt=1.5.5
[0m06:36:53.863601 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'target_path': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m06:36:56.011351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9b1d8970>]}
[0m06:36:56.074035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd97c8e2c0>]}
[0m06:36:56.077880 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:36:56.165496 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m06:37:00.134808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:37:00.136871 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:37:00.153140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd97952590>]}
[0m06:37:00.216291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd97909cc0>]}
[0m06:37:00.222080 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:37:00.229164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9790b9a0>]}
[0m06:37:00.238247 [info ] [MainThread]: 
[0m06:37:00.245139 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:37:00.251531 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203'
[0m06:37:00.255439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:37:02.134494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_silicon-parity-396203, now list_silicon-parity-396203_retail)
[0m06:37:02.137054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:37:04.074368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd97909750>]}
[0m06:37:04.079020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:37:04.082264 [info ] [MainThread]: 
[0m06:37:07.046809 [debug] [Thread-1 (]: Began running node model.retail_task.stg_accounts_closed
[0m06:37:07.050986 [info ] [Thread-1 (]: 1 of 7 START sql incremental model retail.stg_accounts_closed .................. [RUN]
[0m06:37:07.055569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_retail, now model.retail_task.stg_accounts_closed)
[0m06:37:07.062466 [debug] [Thread-1 (]: Began compiling node model.retail_task.stg_accounts_closed
[0m06:37:07.093635 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.stg_accounts_closed"
[0m06:37:07.117143 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_closed (compile): 06:37:07.064825 => 06:37:07.115724
[0m06:37:07.122118 [debug] [Thread-1 (]: Began executing node model.retail_task.stg_accounts_closed
[0m06:37:07.463149 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.stg_accounts_closed"
[0m06:37:07.537428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:07.614404 [debug] [Thread-1 (]: On model.retail_task.stg_accounts_closed: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.stg_accounts_closed"} */

  
    

    create or replace table `silicon-parity-396203`.`retail`.`stg_accounts_closed`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(closed_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`retail`.`account_closed`
    
    

)

SELECT * FROM source
    );
  
[0m06:37:12.183160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:4c4a404c-616d-49c9-95a9-baf69c402155&page=queryresults
[0m06:37:12.308761 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_closed (execute): 06:37:07.124567 => 06:37:12.307828
[0m06:37:12.316234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd97aad870>]}
[0m06:37:12.332412 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model retail.stg_accounts_closed ............. [[32mCREATE TABLE (4.0k rows, 384.1 KiB processed)[0m in 5.26s]
[0m06:37:12.339660 [debug] [Thread-1 (]: Finished running node model.retail_task.stg_accounts_closed
[0m06:37:12.352924 [debug] [Thread-1 (]: Began running node model.retail_task.stg_accounts_created
[0m06:37:12.420402 [info ] [Thread-1 (]: 2 of 7 START sql incremental model retail.stg_accounts_created ................. [RUN]
[0m06:37:12.435475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.stg_accounts_closed, now model.retail_task.stg_accounts_created)
[0m06:37:12.441138 [debug] [Thread-1 (]: Began compiling node model.retail_task.stg_accounts_created
[0m06:37:12.471175 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.stg_accounts_created"
[0m06:37:12.547243 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_created (compile): 06:37:12.448314 => 06:37:12.546144
[0m06:37:12.552661 [debug] [Thread-1 (]: Began executing node model.retail_task.stg_accounts_created
[0m06:37:12.595524 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.stg_accounts_created"
[0m06:37:12.706748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:12.723873 [debug] [Thread-1 (]: On model.retail_task.stg_accounts_created: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.stg_accounts_created"} */

  
    

    create or replace table `silicon-parity-396203`.`retail`.`stg_accounts_created`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(created_ts AS TIMESTAMP) as recorded_at,
        account_type,
        account_id_hashed as account_id,
        user_id_hashed as user_id
    FROM
      `silicon-parity-396203`.`retail`.`account_created`
    
    

)

SELECT * FROM source
    );
  
[0m06:37:17.450818 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:29c259a0-f7d3-4ac3-ac90-5f0bfda2bd4c&page=queryresults
[0m06:37:17.516113 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_created (execute): 06:37:12.571479 => 06:37:17.514444
[0m06:37:17.522616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9790ad40>]}
[0m06:37:17.536829 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model retail.stg_accounts_created ............ [[32mCREATE TABLE (12.0k rows, 2.3 MiB processed)[0m in 5.09s]
[0m06:37:17.546122 [debug] [Thread-1 (]: Finished running node model.retail_task.stg_accounts_created
[0m06:37:17.551369 [debug] [Thread-1 (]: Began running node model.retail_task.stg_accounts_reopened
[0m06:37:17.557770 [info ] [Thread-1 (]: 3 of 7 START sql incremental model retail.stg_accounts_reopened ................ [RUN]
[0m06:37:17.562338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.stg_accounts_created, now model.retail_task.stg_accounts_reopened)
[0m06:37:17.566347 [debug] [Thread-1 (]: Began compiling node model.retail_task.stg_accounts_reopened
[0m06:37:17.583050 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.stg_accounts_reopened"
[0m06:37:17.616219 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_reopened (compile): 06:37:17.569338 => 06:37:17.615112
[0m06:37:17.619888 [debug] [Thread-1 (]: Began executing node model.retail_task.stg_accounts_reopened
[0m06:37:17.681667 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.stg_accounts_reopened"
[0m06:37:17.711947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:17.726262 [debug] [Thread-1 (]: On model.retail_task.stg_accounts_reopened: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.stg_accounts_reopened"} */

  
    

    create or replace table `silicon-parity-396203`.`retail`.`stg_accounts_reopened`
    
    

    OPTIONS()
    as (
      

WITH source as (
    
    SELECT
        CAST(reopened_ts AS TIMESTAMP) as recorded_at,
        account_id_hashed as account_id
    FROM
      `silicon-parity-396203`.`retail`.`account_reopened`
    
    

)

SELECT * FROM source
    );
  
[0m06:37:21.751177 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:7b19366c-045f-496f-b247-ed120bc1012a&page=queryresults
[0m06:37:21.756672 [debug] [Thread-1 (]: Timing info for model.retail_task.stg_accounts_reopened (execute): 06:37:17.622847 => 06:37:21.756204
[0m06:37:21.760668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9786ab00>]}
[0m06:37:21.763855 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model retail.stg_accounts_reopened ........... [[32mCREATE TABLE (7.0 rows, 686.0 Bytes processed)[0m in 4.20s]
[0m06:37:21.767654 [debug] [Thread-1 (]: Finished running node model.retail_task.stg_accounts_reopened
[0m06:37:21.771283 [debug] [Thread-1 (]: Began running node model.retail_task.dim_accounts
[0m06:37:21.773736 [info ] [Thread-1 (]: 4 of 7 START sql view model retail.dim_accounts ................................ [RUN]
[0m06:37:21.776574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.stg_accounts_reopened, now model.retail_task.dim_accounts)
[0m06:37:21.779243 [debug] [Thread-1 (]: Began compiling node model.retail_task.dim_accounts
[0m06:37:21.822318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:23.514888 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.dim_accounts"
[0m06:37:23.538876 [debug] [Thread-1 (]: Timing info for model.retail_task.dim_accounts (compile): 06:37:21.781357 => 06:37:23.538081
[0m06:37:23.541409 [debug] [Thread-1 (]: Began executing node model.retail_task.dim_accounts
[0m06:37:23.579479 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.dim_accounts"
[0m06:37:23.591566 [debug] [Thread-1 (]: On model.retail_task.dim_accounts: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.dim_accounts"} */


  create or replace view `silicon-parity-396203`.`retail`.`dim_accounts`
  OPTIONS()
  as 

WITH account_meta AS (

    SELECT
        `account_type`,
  `account_id`,
  `user_id`
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_created`

),

spine AS (

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('true' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_created`

    UNION ALL

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('false' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_closed`

    UNION ALL

    SELECT DISTINCT
        account_id,
        recorded_at,
        CAST('true' AS BOOLEAN) as is_open
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_reopened`
    
)

SELECT
    to_hex(md5(cast(coalesce(cast(spine.account_id as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(spine.recorded_at as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS surrogate_key,
    spine.account_id as natural_key,
    spine.is_open,
    account_meta.`account_type`,
  account_meta.`user_id`,
    spine.recorded_at as valid_from,
    COALESCE(LEAD(spine.recorded_at) OVER (PARTITION BY spine.account_id ORDER BY spine.recorded_at ASC), CURRENT_TIMESTAMP()) AS valid_to
FROM
    spine
    INNER JOIN account_meta ON account_meta.account_id = spine.account_id
ORDER BY
    natural_key,
    valid_from;


[0m06:37:25.876273 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:7b60dd7f-ca0d-4dee-8ff4-3aab11c4528e&page=queryresults
[0m06:37:25.882196 [debug] [Thread-1 (]: Timing info for model.retail_task.dim_accounts (execute): 06:37:23.543180 => 06:37:25.881695
[0m06:37:25.886192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd97869de0>]}
[0m06:37:25.888959 [info ] [Thread-1 (]: 4 of 7 OK created sql view model retail.dim_accounts ........................... [[32mCREATE VIEW (0 processed)[0m in 4.11s]
[0m06:37:25.892096 [debug] [Thread-1 (]: Finished running node model.retail_task.dim_accounts
[0m06:37:25.895811 [debug] [Thread-1 (]: Began running node model.retail_task.dim_users
[0m06:37:25.898355 [info ] [Thread-1 (]: 5 of 7 START sql view model retail.dim_users ................................... [RUN]
[0m06:37:25.902251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.dim_accounts, now model.retail_task.dim_users)
[0m06:37:25.905092 [debug] [Thread-1 (]: Began compiling node model.retail_task.dim_users
[0m06:37:25.921935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:27.086542 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.dim_users"
[0m06:37:27.106701 [debug] [Thread-1 (]: Timing info for model.retail_task.dim_users (compile): 06:37:25.907467 => 06:37:27.106168
[0m06:37:27.108718 [debug] [Thread-1 (]: Began executing node model.retail_task.dim_users
[0m06:37:27.134232 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.dim_users"
[0m06:37:27.152458 [debug] [Thread-1 (]: On model.retail_task.dim_users: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.dim_users"} */


  create or replace view `silicon-parity-396203`.`retail`.`dim_users`
  OPTIONS()
  as 

WITH account_meta AS (

    SELECT
        `account_type`,
  `account_id`,
  `user_id`
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_created`

),

spine AS (

    SELECT DISTINCT
        user_id,
        recorded_at
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_created`

    UNION ALL

    SELECT DISTINCT
        account_meta.user_id,
        stg_accounts_closed.recorded_at
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_closed`
        INNER JOIN account_meta ON account_meta.account_id = stg_accounts_closed.account_id

    UNION ALL

    SELECT DISTINCT
        account_meta.user_id,
        stg_accounts_reopened.recorded_at
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_reopened`
        INNER JOIN account_meta ON account_meta.account_id = stg_accounts_reopened.account_id
    
),

first_created AS (

    SELECT
        user_id,
        MIN(recorded_at) as recorded_at
    FROM
        `silicon-parity-396203`.`retail`.`stg_accounts_created`
    GROUP BY
        1

),

aggregates AS (

    SELECT
        spine.user_id,
        spine.recorded_at,
        COUNT(DISTINCT dim_accounts.natural_key) AS open_account_total,
        STRING_AGG(DISTINCT dim_accounts.natural_key) as open_accounts,
        STRING_AGG(DISTINCT dim_accounts.account_type) as open_account_types
    FROM
        spine
        LEFT JOIN `silicon-parity-396203`.`retail`.`dim_accounts` ON dim_accounts.user_id = spine.user_id
            AND dim_accounts.valid_from <= spine.recorded_at
            AND dim_accounts.valid_to > spine.recorded_at
            AND dim_accounts.is_open
    GROUP BY
        1,2

)

SELECT
    to_hex(md5(cast(coalesce(cast(aggregates.user_id as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(aggregates.recorded_at as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS surrogate_key,
    aggregates.user_id as natural_key,
    first_created.recorded_at as first_created,
    aggregates.open_account_total,
    aggregates.open_accounts,
    aggregates.open_account_types,
    aggregates.recorded_at as valid_from,
    COALESCE(LEAD(aggregates.recorded_at) OVER (PARTITION BY aggregates.user_id ORDER BY aggregates.recorded_at ASC), CURRENT_TIMESTAMP()) AS valid_to
FROM
    aggregates
    LEFT JOIN first_created ON first_created.user_id = aggregates.user_id
ORDER BY
    natural_key,
    valid_from;


[0m06:37:28.894741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:6dee2acf-c7a3-4595-b075-93157d81d412&page=queryresults
[0m06:37:28.900121 [debug] [Thread-1 (]: Timing info for model.retail_task.dim_users (execute): 06:37:27.110242 => 06:37:28.899780
[0m06:37:28.903324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd95696080>]}
[0m06:37:28.908407 [info ] [Thread-1 (]: 5 of 7 OK created sql view model retail.dim_users .............................. [[32mCREATE VIEW (0 processed)[0m in 3.00s]
[0m06:37:28.912234 [debug] [Thread-1 (]: Finished running node model.retail_task.dim_users
[0m06:37:28.917369 [debug] [Thread-1 (]: Began running node model.retail_task.fct_transactions
[0m06:37:28.921434 [info ] [Thread-1 (]: 6 of 7 START sql view model retail.fct_transactions ............................ [RUN]
[0m06:37:28.924691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.dim_users, now model.retail_task.fct_transactions)
[0m06:37:28.926984 [debug] [Thread-1 (]: Began compiling node model.retail_task.fct_transactions
[0m06:37:28.941496 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.fct_transactions"
[0m06:37:28.964503 [debug] [Thread-1 (]: Timing info for model.retail_task.fct_transactions (compile): 06:37:28.928884 => 06:37:28.964025
[0m06:37:28.966630 [debug] [Thread-1 (]: Began executing node model.retail_task.fct_transactions
[0m06:37:28.973984 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.fct_transactions"
[0m06:37:28.991999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:29.002598 [debug] [Thread-1 (]: On model.retail_task.fct_transactions: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.fct_transactions"} */


  create or replace view `silicon-parity-396203`.`retail`.`fct_transactions`
  OPTIONS()
  as 

SELECT
    to_hex(md5(cast(coalesce(cast(account_transactions.date as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_transactions.account_id_hashed as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(account_transactions.transactions_num as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS unique_key,
    CAST(account_transactions.date AS TIMESTAMP) as recorded_at,
    account_transactions.account_id_hashed as account_natural_key,
    account_transactions.transactions_num,
    dim_accounts.surrogate_key as account_surrogate_key,
    dim_users.surrogate_key as user_surrogate_key
FROM
    `silicon-parity-396203`.`retail`.`account_transactions`
    INNER JOIN `silicon-parity-396203`.`retail`.`dim_accounts` ON dim_accounts.natural_key = account_transactions.account_id_hashed
        AND dim_accounts.valid_from <= CAST(account_transactions.date AS TIMESTAMP)
        AND dim_accounts.valid_to > CAST(account_transactions.date AS TIMESTAMP)
    INNER JOIN `silicon-parity-396203`.`retail`.`dim_users` ON dim_users.natural_key = dim_accounts.user_id
        AND dim_users.valid_from <= CAST(account_transactions.date AS TIMESTAMP)
        AND dim_users.valid_to > CAST(account_transactions.date AS TIMESTAMP);


[0m06:37:31.389629 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:051627e7-bbc6-407e-93cf-a1dd9f97a370&page=queryresults
[0m06:37:31.394762 [debug] [Thread-1 (]: Timing info for model.retail_task.fct_transactions (execute): 06:37:28.968533 => 06:37:31.394278
[0m06:37:31.397744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd95694280>]}
[0m06:37:31.400302 [info ] [Thread-1 (]: 6 of 7 OK created sql view model retail.fct_transactions ....................... [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m06:37:31.406402 [debug] [Thread-1 (]: Finished running node model.retail_task.fct_transactions
[0m06:37:31.411284 [debug] [Thread-1 (]: Began running node model.retail_task.report_7d_active_users
[0m06:37:31.417140 [info ] [Thread-1 (]: 7 of 7 START sql view model retail.report_7d_active_users ...................... [RUN]
[0m06:37:31.425080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_task.fct_transactions, now model.retail_task.report_7d_active_users)
[0m06:37:31.430673 [debug] [Thread-1 (]: Began compiling node model.retail_task.report_7d_active_users
[0m06:37:31.451577 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_task.report_7d_active_users"
[0m06:37:31.472955 [debug] [Thread-1 (]: Timing info for model.retail_task.report_7d_active_users (compile): 06:37:31.434768 => 06:37:31.471532
[0m06:37:31.478780 [debug] [Thread-1 (]: Began executing node model.retail_task.report_7d_active_users
[0m06:37:31.486303 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_task.report_7d_active_users"
[0m06:37:31.503313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:31.530894 [debug] [Thread-1 (]: On model.retail_task.report_7d_active_users: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "model.retail_task.report_7d_active_users"} */


  create or replace view `silicon-parity-396203`.`retail`.`report_7d_active_users`
  OPTIONS()
  as 

WITH spine AS (

  SELECT 
    CAST(day AS TIMESTAMP) as day
  FROM 
    UNNEST(GENERATE_DATE_ARRAY(DATE('2019-01-14'), DATE('2020-01-01'), INTERVAL 1 DAY)) as day

),

users_daily AS (

  SELECT
    spine.day,
    dim_users.natural_key
  FROM
    spine
    INNER JOIN `silicon-parity-396203`.`retail`.`dim_users` ON dim_users.valid_from <= spine.day
      AND dim_users.valid_to > spine.day
      AND dim_users.open_account_total > 0

),

users_7d AS (

  SELECT
    spine.day as period_start,
    COUNT(DISTINCT users_daily.natural_key) as total_users
  FROM
    spine
    LEFT JOIN users_daily ON users_daily.day >= spine.day
      AND users_daily.day < DATE_ADD(spine.day, INTERVAL 7 DAY)
  GROUP BY
    1

),

transactions_7d AS (

  SELECT
    spine.day as period_start,
    COUNT(fct_transactions.unique_key) as total_transactions,
    COUNT(DISTINCT dim_users.natural_key) as active_users
  FROM
    spine
    LEFT JOIN `silicon-parity-396203`.`retail`.`fct_transactions` ON fct_transactions.recorded_at >= spine.day
      AND fct_transactions.recorded_at < DATE_ADD(spine.day, INTERVAL 7 DAY)
    LEFT JOIN `silicon-parity-396203`.`retail`.`dim_users` ON dim_users.surrogate_key = fct_transactions.user_surrogate_key
  GROUP BY
    1

)

SELECT
  spine.day as period_start,
  DATE_ADD(spine.day, INTERVAL 6 DAY) as period_end,
  users_7d.total_users,
  transactions_7d.active_users,
  transactions_7d.total_transactions,
  ROUND(CAST(active_users/total_users AS DECIMAL), 2) as active_users_7d
FROM
  spine
  LEFT JOIN users_7d ON users_7d.period_start = spine.day
  LEFT JOIN transactions_7d ON transactions_7d.period_start = spine.day
ORDER BY
  1;


[0m06:37:34.647827 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:39b09464-c89b-46d1-9cc9-b65bb4112ec4&page=queryresults
[0m06:37:34.655011 [debug] [Thread-1 (]: Timing info for model.retail_task.report_7d_active_users (execute): 06:37:31.480952 => 06:37:34.654329
[0m06:37:34.669163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0df6b0-5aa6-4374-aa50-b3d218f7ee53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd956b3c70>]}
[0m06:37:34.682841 [info ] [Thread-1 (]: 7 of 7 OK created sql view model retail.report_7d_active_users ................. [[32mCREATE VIEW (0 processed)[0m in 3.24s]
[0m06:37:34.689072 [debug] [Thread-1 (]: Finished running node model.retail_task.report_7d_active_users
[0m06:37:34.697883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:37:34.701839 [debug] [MainThread]: Connection 'model.retail_task.report_7d_active_users' was properly closed.
[0m06:37:34.705921 [info ] [MainThread]: 
[0m06:37:34.714999 [info ] [MainThread]: Finished running 3 incremental models, 4 view models in 0 hours 0 minutes and 34.46 seconds (34.46s).
[0m06:37:34.742019 [debug] [MainThread]: Command end result
[0m06:37:34.932186 [info ] [MainThread]: 
[0m06:37:34.935973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:37:34.947713 [info ] [MainThread]: 
[0m06:37:34.952241 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m06:37:34.972369 [debug] [MainThread]: Command `dbt run` succeeded at 06:37:34.971787 after 41.19 seconds
[0m06:37:34.989044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9b44f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd97c8e2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd956b0d90>]}
[0m06:37:35.012125 [debug] [MainThread]: Flushing usage events
[0m06:37:51.189824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c7f77610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c68945b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c6894040>]}


============================== 06:37:51.201702 | 63629631-880e-454b-a615-48d7a233235f ==============================
[0m06:37:51.201702 [info ] [MainThread]: Running with dbt=1.5.5
[0m06:37:51.204607 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None'}
[0m06:37:52.217091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63629631-880e-454b-a615-48d7a233235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c480a200>]}
[0m06:37:52.258941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63629631-880e-454b-a615-48d7a233235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c482c940>]}
[0m06:37:52.262529 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m06:37:52.348713 [debug] [MainThread]: checksum: a081f3d47f4396098257f37c38b83828c00c3256abdb2a1e8c3daaab63b009e3, vars: {}, profile: , target: , version: 1.5.5
[0m06:37:55.307421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:37:55.309591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:37:55.329062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63629631-880e-454b-a615-48d7a233235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c44f2110>]}
[0m06:37:55.372538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63629631-880e-454b-a615-48d7a233235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c46a5840>]}
[0m06:37:55.375953 [info ] [MainThread]: Found 7 models, 25 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 4 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:37:55.379727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63629631-880e-454b-a615-48d7a233235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c46a7520>]}
[0m06:37:55.393034 [info ] [MainThread]: 
[0m06:37:55.400971 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:37:55.405859 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_silicon-parity-396203_retail'
[0m06:37:55.408088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:37:56.592318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63629631-880e-454b-a615-48d7a233235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c46a7400>]}
[0m06:37:56.595987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:37:56.600827 [info ] [MainThread]: 
[0m06:37:56.630117 [debug] [Thread-1 (]: Began running node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m06:37:56.633957 [info ] [Thread-1 (]: 1 of 25 START test dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to  [RUN]
[0m06:37:56.640464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_silicon-parity-396203_retail, now test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6)
[0m06:37:56.644517 [debug] [Thread-1 (]: Began compiling node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m06:37:56.816765 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"
[0m06:37:56.878469 [debug] [Thread-1 (]: Timing info for test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6 (compile): 06:37:56.648211 => 06:37:56.877420
[0m06:37:56.882504 [debug] [Thread-1 (]: Began executing node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m06:37:57.001549 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"
[0m06:37:57.125494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:57.137450 [debug] [Thread-1 (]: On test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        natural_key as partition_by_col,
        
        valid_from as lower_bound,
        valid_to as upper_bound,

        lead(valid_from) over (
            partition by natural_key
            order by valid_from, valid_to
        ) as next_lower_bound,

        row_number() over (
            partition by natural_key
            order by valid_from desc, valid_to desc
        ) = 1 as is_last_record

    from `silicon-parity-396203`.`retail`.`dim_accounts`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m06:38:02.546079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:73197d70-e454-42ee-8d29-97dba6aa23b1&page=queryresults
[0m06:38:02.552026 [debug] [Thread-1 (]: Timing info for test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6 (execute): 06:37:56.887397 => 06:38:02.551155
[0m06:38:02.556678 [info ] [Thread-1 (]: 1 of 25 PASS dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to  [[32mPASS[0m in 5.92s]
[0m06:38:02.563252 [debug] [Thread-1 (]: Finished running node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6
[0m06:38:02.575198 [debug] [Thread-1 (]: Began running node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m06:38:02.582044 [info ] [Thread-1 (]: 2 of 25 START test dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to  [RUN]
[0m06:38:02.586920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_accounts_not_allowed__valid_from__natural_key__valid_to.87167c36d6, now test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d)
[0m06:38:02.589257 [debug] [Thread-1 (]: Began compiling node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m06:38:02.607214 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"
[0m06:38:02.634039 [debug] [Thread-1 (]: Timing info for test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d (compile): 06:38:02.591271 => 06:38:02.633132
[0m06:38:02.638305 [debug] [Thread-1 (]: Began executing node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m06:38:02.643995 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"
[0m06:38:02.660373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:02.668777 [debug] [Thread-1 (]: On test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        natural_key as partition_by_col,
        
        valid_from as lower_bound,
        valid_to as upper_bound,

        lead(valid_from) over (
            partition by natural_key
            order by valid_from, valid_to
        ) as next_lower_bound,

        row_number() over (
            partition by natural_key
            order by valid_from desc, valid_to desc
        ) = 1 as is_last_record

    from `silicon-parity-396203`.`retail`.`dim_users`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m06:38:07.429930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:dd1abf9d-4596-431d-9c8d-4ee78263e068&page=queryresults
[0m06:38:07.435389 [debug] [Thread-1 (]: Timing info for test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d (execute): 06:38:02.640110 => 06:38:07.434332
[0m06:38:07.444813 [info ] [Thread-1 (]: 2 of 25 PASS dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to  [[32mPASS[0m in 4.86s]
[0m06:38:07.450190 [debug] [Thread-1 (]: Finished running node test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d
[0m06:38:07.460023 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_accounts_is_open.aafc57baad
[0m06:38:07.463607 [info ] [Thread-1 (]: 3 of 25 START test not_null_dim_accounts_is_open ............................... [RUN]
[0m06:38:07.468368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.dbt_utils_mutually_exclusive_ranges_dim_users_not_allowed__valid_from__natural_key__valid_to.ccf2b9461d, now test.retail_task.not_null_dim_accounts_is_open.aafc57baad)
[0m06:38:07.472354 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_accounts_is_open.aafc57baad
[0m06:38:07.511819 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_accounts_is_open.aafc57baad"
[0m06:38:07.583327 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_is_open.aafc57baad (compile): 06:38:07.475177 => 06:38:07.582277
[0m06:38:07.586794 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_accounts_is_open.aafc57baad
[0m06:38:07.607479 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_accounts_is_open.aafc57baad"
[0m06:38:07.661511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:07.679599 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_accounts_is_open.aafc57baad: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_accounts_is_open.aafc57baad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_open
from `silicon-parity-396203`.`retail`.`dim_accounts`
where is_open is null



      
    ) dbt_internal_test
[0m06:38:10.932993 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:a310fe8c-c92f-48dd-8f45-eae62d9afce4&page=queryresults
[0m06:38:10.936432 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_is_open.aafc57baad (execute): 06:38:07.598600 => 06:38:10.935845
[0m06:38:10.941189 [info ] [Thread-1 (]: 3 of 25 PASS not_null_dim_accounts_is_open ..................................... [[32mPASS[0m in 3.47s]
[0m06:38:10.945780 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_accounts_is_open.aafc57baad
[0m06:38:10.951248 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m06:38:10.959581 [info ] [Thread-1 (]: 4 of 25 START test not_null_dim_accounts_natural_key ........................... [RUN]
[0m06:38:10.964009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_accounts_is_open.aafc57baad, now test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3)
[0m06:38:10.966827 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m06:38:10.978751 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"
[0m06:38:11.002423 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3 (compile): 06:38:10.969073 => 06:38:11.001792
[0m06:38:11.005453 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m06:38:11.014353 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"
[0m06:38:11.046671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:11.057584 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select natural_key
from `silicon-parity-396203`.`retail`.`dim_accounts`
where natural_key is null



      
    ) dbt_internal_test
[0m06:38:14.628723 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:7ad059db-0549-4264-8ec4-9417a14215d0&page=queryresults
[0m06:38:14.632286 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3 (execute): 06:38:11.007553 => 06:38:14.631754
[0m06:38:14.636330 [info ] [Thread-1 (]: 4 of 25 PASS not_null_dim_accounts_natural_key ................................. [[32mPASS[0m in 3.67s]
[0m06:38:14.640831 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3
[0m06:38:14.647025 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m06:38:14.652642 [info ] [Thread-1 (]: 5 of 25 START test not_null_dim_accounts_surrogate_key ......................... [RUN]
[0m06:38:14.662774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_accounts_natural_key.7e1ffcb3c3, now test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77)
[0m06:38:14.666146 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m06:38:14.684056 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77"
[0m06:38:14.717775 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77 (compile): 06:38:14.668413 => 06:38:14.717104
[0m06:38:14.720548 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m06:38:14.734566 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77"
[0m06:38:14.772984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:14.796661 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select surrogate_key
from `silicon-parity-396203`.`retail`.`dim_accounts`
where surrogate_key is null



      
    ) dbt_internal_test
[0m06:38:18.328980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:92bd43a6-757c-4c10-91c3-3998b04b1796&page=queryresults
[0m06:38:18.333189 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77 (execute): 06:38:14.722653 => 06:38:18.332365
[0m06:38:18.337002 [info ] [Thread-1 (]: 5 of 25 PASS not_null_dim_accounts_surrogate_key ............................... [[32mPASS[0m in 3.67s]
[0m06:38:18.340575 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77
[0m06:38:18.345608 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m06:38:18.351779 [info ] [Thread-1 (]: 6 of 25 START test not_null_dim_accounts_valid_from ............................ [RUN]
[0m06:38:18.357266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_accounts_surrogate_key.cd62265b77, now test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9)
[0m06:38:18.361044 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m06:38:18.372787 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9"
[0m06:38:18.396456 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9 (compile): 06:38:18.363208 => 06:38:18.395674
[0m06:38:18.398700 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m06:38:18.404185 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9"
[0m06:38:18.429452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:18.437174 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_from
from `silicon-parity-396203`.`retail`.`dim_accounts`
where valid_from is null



      
    ) dbt_internal_test
[0m06:38:22.172706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:e46c1729-4bd7-4b7a-826a-d465fe8a9781&page=queryresults
[0m06:38:22.175810 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9 (execute): 06:38:18.400442 => 06:38:22.175258
[0m06:38:22.180662 [info ] [Thread-1 (]: 6 of 25 PASS not_null_dim_accounts_valid_from .................................. [[32mPASS[0m in 3.82s]
[0m06:38:22.184923 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9
[0m06:38:22.187684 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m06:38:22.189914 [info ] [Thread-1 (]: 7 of 25 START test not_null_dim_accounts_valid_to .............................. [RUN]
[0m06:38:22.194886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_accounts_valid_from.f50343b3b9, now test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2)
[0m06:38:22.199063 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m06:38:22.207783 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2"
[0m06:38:22.248415 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2 (compile): 06:38:22.201132 => 06:38:22.245414
[0m06:38:22.253609 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m06:38:22.265938 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2"
[0m06:38:22.288445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:22.295776 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_to
from `silicon-parity-396203`.`retail`.`dim_accounts`
where valid_to is null



      
    ) dbt_internal_test
[0m06:38:26.864329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:3fab6d52-8698-481b-b933-a1a46bf479b5&page=queryresults
[0m06:38:26.872281 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2 (execute): 06:38:22.256378 => 06:38:26.871661
[0m06:38:26.875315 [info ] [Thread-1 (]: 7 of 25 PASS not_null_dim_accounts_valid_to .................................... [[32mPASS[0m in 4.68s]
[0m06:38:26.878209 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2
[0m06:38:26.882962 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_users_natural_key.1191491ec3
[0m06:38:26.885041 [info ] [Thread-1 (]: 8 of 25 START test not_null_dim_users_natural_key .............................. [RUN]
[0m06:38:26.887665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_accounts_valid_to.944cc54bc2, now test.retail_task.not_null_dim_users_natural_key.1191491ec3)
[0m06:38:26.889710 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_users_natural_key.1191491ec3
[0m06:38:26.912615 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_users_natural_key.1191491ec3"
[0m06:38:26.944441 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_natural_key.1191491ec3 (compile): 06:38:26.891409 => 06:38:26.943663
[0m06:38:26.950438 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_users_natural_key.1191491ec3
[0m06:38:26.959572 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_users_natural_key.1191491ec3"
[0m06:38:26.983758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:26.991864 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_users_natural_key.1191491ec3: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_users_natural_key.1191491ec3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select natural_key
from `silicon-parity-396203`.`retail`.`dim_users`
where natural_key is null



      
    ) dbt_internal_test
[0m06:38:30.392677 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:ab3db0be-e375-4fc1-aa63-a30c30e05d93&page=queryresults
[0m06:38:30.396484 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_natural_key.1191491ec3 (execute): 06:38:26.953466 => 06:38:30.395858
[0m06:38:30.405505 [info ] [Thread-1 (]: 8 of 25 PASS not_null_dim_users_natural_key .................................... [[32mPASS[0m in 3.52s]
[0m06:38:30.408687 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_users_natural_key.1191491ec3
[0m06:38:30.411853 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m06:38:30.421097 [info ] [Thread-1 (]: 9 of 25 START test not_null_dim_users_surrogate_key ............................ [RUN]
[0m06:38:30.428333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_users_natural_key.1191491ec3, now test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda)
[0m06:38:30.435995 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m06:38:30.452864 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda"
[0m06:38:30.495001 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda (compile): 06:38:30.438100 => 06:38:30.493859
[0m06:38:30.508900 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m06:38:30.522395 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda"
[0m06:38:30.621894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:30.668827 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select surrogate_key
from `silicon-parity-396203`.`retail`.`dim_users`
where surrogate_key is null



      
    ) dbt_internal_test
[0m06:38:35.790115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:5f3b6ea4-6a21-480d-b11b-2d1a5fe1c3e4&page=queryresults
[0m06:38:35.793675 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda (execute): 06:38:30.512626 => 06:38:35.792835
[0m06:38:35.797059 [info ] [Thread-1 (]: 9 of 25 PASS not_null_dim_users_surrogate_key .................................. [[32mPASS[0m in 5.37s]
[0m06:38:35.807221 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda
[0m06:38:35.814033 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_users_valid_from.8cd755bb40
[0m06:38:35.826757 [info ] [Thread-1 (]: 10 of 25 START test not_null_dim_users_valid_from .............................. [RUN]
[0m06:38:35.831766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_users_surrogate_key.7eb147ccda, now test.retail_task.not_null_dim_users_valid_from.8cd755bb40)
[0m06:38:35.839214 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_users_valid_from.8cd755bb40
[0m06:38:35.866331 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_users_valid_from.8cd755bb40"
[0m06:38:35.925585 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_valid_from.8cd755bb40 (compile): 06:38:35.842819 => 06:38:35.924464
[0m06:38:35.929164 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_users_valid_from.8cd755bb40
[0m06:38:35.943608 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_users_valid_from.8cd755bb40"
[0m06:38:35.980760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:35.997251 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_users_valid_from.8cd755bb40: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_users_valid_from.8cd755bb40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_from
from `silicon-parity-396203`.`retail`.`dim_users`
where valid_from is null



      
    ) dbt_internal_test
[0m06:38:39.823615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:4fffc4a1-dcb5-4be5-bbaf-fb879caaaa1d&page=queryresults
[0m06:38:39.832024 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_valid_from.8cd755bb40 (execute): 06:38:35.931724 => 06:38:39.831059
[0m06:38:39.836760 [info ] [Thread-1 (]: 10 of 25 PASS not_null_dim_users_valid_from .................................... [[32mPASS[0m in 4.01s]
[0m06:38:39.842478 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_users_valid_from.8cd755bb40
[0m06:38:39.846071 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_dim_users_valid_to.543960cf0d
[0m06:38:39.848845 [info ] [Thread-1 (]: 11 of 25 START test not_null_dim_users_valid_to ................................ [RUN]
[0m06:38:39.853239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_users_valid_from.8cd755bb40, now test.retail_task.not_null_dim_users_valid_to.543960cf0d)
[0m06:38:39.859605 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_dim_users_valid_to.543960cf0d
[0m06:38:39.873616 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_dim_users_valid_to.543960cf0d"
[0m06:38:39.896837 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_valid_to.543960cf0d (compile): 06:38:39.862960 => 06:38:39.896120
[0m06:38:39.899151 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_dim_users_valid_to.543960cf0d
[0m06:38:39.910480 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_dim_users_valid_to.543960cf0d"
[0m06:38:39.933846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:39.944176 [debug] [Thread-1 (]: On test.retail_task.not_null_dim_users_valid_to.543960cf0d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_dim_users_valid_to.543960cf0d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valid_to
from `silicon-parity-396203`.`retail`.`dim_users`
where valid_to is null



      
    ) dbt_internal_test
[0m06:38:43.760723 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:1bc2e657-3301-4717-9245-70f6527a9ab7&page=queryresults
[0m06:38:43.773379 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_dim_users_valid_to.543960cf0d (execute): 06:38:39.901301 => 06:38:43.772548
[0m06:38:43.790786 [info ] [Thread-1 (]: 11 of 25 PASS not_null_dim_users_valid_to ...................................... [[32mPASS[0m in 3.94s]
[0m06:38:43.801608 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_dim_users_valid_to.543960cf0d
[0m06:38:43.807550 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m06:38:43.833270 [info ] [Thread-1 (]: 12 of 25 START test not_null_fct_transactions_unique_key ....................... [RUN]
[0m06:38:43.837161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_dim_users_valid_to.543960cf0d, now test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d)
[0m06:38:43.839486 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m06:38:43.852859 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d"
[0m06:38:43.904310 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d (compile): 06:38:43.841682 => 06:38:43.902974
[0m06:38:43.911111 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m06:38:43.947757 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d"
[0m06:38:43.993130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:44.054241 [debug] [Thread-1 (]: On test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select unique_key
from `silicon-parity-396203`.`retail`.`fct_transactions`
where unique_key is null



      
    ) dbt_internal_test
[0m06:38:48.853302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:3e346f97-3f21-41a5-96f7-f370b08dd51e&page=queryresults
[0m06:38:48.876795 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d (execute): 06:38:43.938666 => 06:38:48.875997
[0m06:38:48.905976 [info ] [Thread-1 (]: 12 of 25 PASS not_null_fct_transactions_unique_key ............................. [[32mPASS[0m in 5.07s]
[0m06:38:48.909762 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d
[0m06:38:48.918826 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m06:38:48.921917 [info ] [Thread-1 (]: 13 of 25 START test not_null_stg_accounts_closed_account_id .................... [RUN]
[0m06:38:48.934641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_fct_transactions_unique_key.8acdf74f4d, now test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea)
[0m06:38:48.939089 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m06:38:48.956505 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea"
[0m06:38:49.017985 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea (compile): 06:38:48.942693 => 06:38:49.016623
[0m06:38:49.043398 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m06:38:49.068621 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea"
[0m06:38:49.155922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:49.241080 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`retail`.`stg_accounts_closed`
where account_id is null



      
    ) dbt_internal_test
[0m06:38:52.556063 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:b8df8251-8819-44b9-b96f-26f8cb164653&page=queryresults
[0m06:38:52.564623 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea (execute): 06:38:49.056450 => 06:38:52.563849
[0m06:38:52.568585 [info ] [Thread-1 (]: 13 of 25 PASS not_null_stg_accounts_closed_account_id .......................... [[32mPASS[0m in 3.63s]
[0m06:38:52.572736 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea
[0m06:38:52.579545 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m06:38:52.582237 [info ] [Thread-1 (]: 14 of 25 START test not_null_stg_accounts_closed_recorded_at ................... [RUN]
[0m06:38:52.585470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_closed_account_id.682104c9ea, now test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94)
[0m06:38:52.588452 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m06:38:52.617369 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94"
[0m06:38:52.659212 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94 (compile): 06:38:52.590822 => 06:38:52.658240
[0m06:38:52.667126 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m06:38:52.675139 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94"
[0m06:38:52.705839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:52.716444 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`retail`.`stg_accounts_closed`
where recorded_at is null



      
    ) dbt_internal_test
[0m06:38:55.835939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:9e7277c1-fbae-4d72-b384-c1fca3ac0703&page=queryresults
[0m06:38:55.842176 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94 (execute): 06:38:52.670135 => 06:38:55.840788
[0m06:38:55.849664 [info ] [Thread-1 (]: 14 of 25 PASS not_null_stg_accounts_closed_recorded_at ......................... [[32mPASS[0m in 3.26s]
[0m06:38:55.858779 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94
[0m06:38:55.866869 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m06:38:55.870046 [info ] [Thread-1 (]: 15 of 25 START test not_null_stg_accounts_created_account_id ................... [RUN]
[0m06:38:55.882348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_closed_recorded_at.824b452f94, now test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd)
[0m06:38:55.912093 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m06:38:55.981965 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"
[0m06:38:56.057024 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd (compile): 06:38:55.941374 => 06:38:56.055842
[0m06:38:56.060349 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m06:38:56.134845 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"
[0m06:38:56.166869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:56.194089 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`retail`.`stg_accounts_created`
where account_id is null



      
    ) dbt_internal_test
[0m06:39:00.335958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:023281c2-d490-407a-b27b-6dca2910a414&page=queryresults
[0m06:39:00.340634 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd (execute): 06:38:56.069650 => 06:39:00.339740
[0m06:39:00.345222 [info ] [Thread-1 (]: 15 of 25 PASS not_null_stg_accounts_created_account_id ......................... [[32mPASS[0m in 4.46s]
[0m06:39:00.351488 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd
[0m06:39:00.357395 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m06:39:00.367742 [info ] [Thread-1 (]: 16 of 25 START test not_null_stg_accounts_created_recorded_at .................. [RUN]
[0m06:39:00.372066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_created_account_id.b3edb4cbfd, now test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df)
[0m06:39:00.374966 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m06:39:00.393319 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df"
[0m06:39:00.446252 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df (compile): 06:39:00.378174 => 06:39:00.445401
[0m06:39:00.452763 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m06:39:00.473688 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df"
[0m06:39:00.523546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:00.572411 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`retail`.`stg_accounts_created`
where recorded_at is null



      
    ) dbt_internal_test
[0m06:39:04.055548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:cd2e8c0e-ad65-4f7f-8a1d-0ceeb3cb6cd7&page=queryresults
[0m06:39:04.063431 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df (execute): 06:39:00.459449 => 06:39:04.061404
[0m06:39:04.076036 [info ] [Thread-1 (]: 16 of 25 PASS not_null_stg_accounts_created_recorded_at ........................ [[32mPASS[0m in 3.70s]
[0m06:39:04.081516 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df
[0m06:39:04.084857 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m06:39:04.087633 [info ] [Thread-1 (]: 17 of 25 START test not_null_stg_accounts_created_user_id ...................... [RUN]
[0m06:39:04.092166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_created_recorded_at.83f76044df, now test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7)
[0m06:39:04.140826 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m06:39:04.281088 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7"
[0m06:39:04.477212 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7 (compile): 06:39:04.243710 => 06:39:04.473560
[0m06:39:04.524435 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m06:39:04.579836 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7"
[0m06:39:04.754396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:04.770356 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `silicon-parity-396203`.`retail`.`stg_accounts_created`
where user_id is null



      
    ) dbt_internal_test
[0m06:39:08.185527 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:1fc0f984-0b75-4366-bc1b-018f40a89df9&page=queryresults
[0m06:39:08.193246 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7 (execute): 06:39:04.535272 => 06:39:08.192331
[0m06:39:08.198838 [info ] [Thread-1 (]: 17 of 25 PASS not_null_stg_accounts_created_user_id ............................ [[32mPASS[0m in 4.11s]
[0m06:39:08.209117 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7
[0m06:39:08.213882 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m06:39:08.224781 [info ] [Thread-1 (]: 18 of 25 START test not_null_stg_accounts_reopened_account_id .................. [RUN]
[0m06:39:08.230839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_created_user_id.5796d808a7, now test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af)
[0m06:39:08.240441 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m06:39:08.276137 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"
[0m06:39:08.372633 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af (compile): 06:39:08.244445 => 06:39:08.371354
[0m06:39:08.377539 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m06:39:08.452455 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"
[0m06:39:08.587972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:08.612432 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select account_id
from `silicon-parity-396203`.`retail`.`stg_accounts_reopened`
where account_id is null



      
    ) dbt_internal_test
[0m06:39:12.100466 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:b6bfc3a2-c223-4f60-99df-8ba84fb433d5&page=queryresults
[0m06:39:12.105616 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af (execute): 06:39:08.385877 => 06:39:12.104587
[0m06:39:12.115549 [info ] [Thread-1 (]: 18 of 25 PASS not_null_stg_accounts_reopened_account_id ........................ [[32mPASS[0m in 3.89s]
[0m06:39:12.119879 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af
[0m06:39:12.136503 [debug] [Thread-1 (]: Began running node test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m06:39:12.147965 [info ] [Thread-1 (]: 19 of 25 START test not_null_stg_accounts_reopened_recorded_at ................. [RUN]
[0m06:39:12.151454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_reopened_account_id.8c8bfde0af, now test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f)
[0m06:39:12.154389 [debug] [Thread-1 (]: Began compiling node test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m06:39:12.175174 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"
[0m06:39:12.232299 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f (compile): 06:39:12.163586 => 06:39:12.231448
[0m06:39:12.235277 [debug] [Thread-1 (]: Began executing node test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m06:39:12.252799 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"
[0m06:39:12.371969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:12.456891 [debug] [Thread-1 (]: On test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select recorded_at
from `silicon-parity-396203`.`retail`.`stg_accounts_reopened`
where recorded_at is null



      
    ) dbt_internal_test
[0m06:39:17.155310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:500406f6-5823-4a99-8e36-d3ffae6dc8aa&page=queryresults
[0m06:39:17.160926 [debug] [Thread-1 (]: Timing info for test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f (execute): 06:39:12.238507 => 06:39:17.159980
[0m06:39:17.230241 [info ] [Thread-1 (]: 19 of 25 PASS not_null_stg_accounts_reopened_recorded_at ....................... [[32mPASS[0m in 5.08s]
[0m06:39:17.379806 [debug] [Thread-1 (]: Finished running node test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f
[0m06:39:17.386780 [debug] [Thread-1 (]: Began running node test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m06:39:17.390598 [info ] [Thread-1 (]: 20 of 25 START test relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_  [RUN]
[0m06:39:17.400308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.not_null_stg_accounts_reopened_recorded_at.623bc45f7f, now test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f)
[0m06:39:17.404350 [debug] [Thread-1 (]: Began compiling node test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m06:39:17.443916 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"
[0m06:39:17.625188 [debug] [Thread-1 (]: Timing info for test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f (compile): 06:39:17.408573 => 06:39:17.624062
[0m06:39:17.638000 [debug] [Thread-1 (]: Began executing node test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m06:39:17.657484 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"
[0m06:39:17.744527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:17.760372 [debug] [Thread-1 (]: On test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select account_surrogate_key as from_field
    from `silicon-parity-396203`.`retail`.`fct_transactions`
    where account_surrogate_key is not null
),

parent as (
    select surrogate_key as to_field
    from `silicon-parity-396203`.`retail`.`dim_accounts`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:39:23.041237 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:cbed7cae-448d-4e35-961f-9d42edbab2e2&page=queryresults
[0m06:39:23.050930 [debug] [Thread-1 (]: Timing info for test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f (execute): 06:39:17.643640 => 06:39:23.049958
[0m06:39:23.054262 [info ] [Thread-1 (]: 20 of 25 PASS relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_  [[32mPASS[0m in 5.65s]
[0m06:39:23.057451 [debug] [Thread-1 (]: Finished running node test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f
[0m06:39:23.061344 [debug] [Thread-1 (]: Began running node test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m06:39:23.063806 [info ] [Thread-1 (]: 21 of 25 START test relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_  [RUN]
[0m06:39:23.066319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.relationships_fct_transactions_account_surrogate_key__surrogate_key__ref_dim_accounts_.935f19969f, now test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a)
[0m06:39:23.068380 [debug] [Thread-1 (]: Began compiling node test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m06:39:23.080252 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"
[0m06:39:23.099705 [debug] [Thread-1 (]: Timing info for test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a (compile): 06:39:23.070210 => 06:39:23.099093
[0m06:39:23.101948 [debug] [Thread-1 (]: Began executing node test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m06:39:23.283847 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"
[0m06:39:23.312277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:23.327202 [debug] [Thread-1 (]: On test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select user_surrogate_key as from_field
    from `silicon-parity-396203`.`retail`.`fct_transactions`
    where user_surrogate_key is not null
),

parent as (
    select surrogate_key as to_field
    from `silicon-parity-396203`.`retail`.`dim_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:39:27.755298 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:30d32cd8-b292-450d-9f04-888110a4df34&page=queryresults
[0m06:39:27.767022 [debug] [Thread-1 (]: Timing info for test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a (execute): 06:39:23.103517 => 06:39:27.766074
[0m06:39:27.771818 [info ] [Thread-1 (]: 21 of 25 PASS relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_  [[32mPASS[0m in 4.71s]
[0m06:39:27.777059 [debug] [Thread-1 (]: Finished running node test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a
[0m06:39:27.782530 [debug] [Thread-1 (]: Began running node test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m06:39:27.794002 [info ] [Thread-1 (]: 22 of 25 START test unique_dim_accounts_surrogate_key .......................... [RUN]
[0m06:39:27.804913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.relationships_fct_transactions_user_surrogate_key__surrogate_key__ref_dim_users_.4586d5729a, now test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064)
[0m06:39:27.809588 [debug] [Thread-1 (]: Began compiling node test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m06:39:27.867006 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064"
[0m06:39:27.899512 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064 (compile): 06:39:27.812456 => 06:39:27.898449
[0m06:39:27.902969 [debug] [Thread-1 (]: Began executing node test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m06:39:27.930381 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064"
[0m06:39:27.994411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:28.009514 [debug] [Thread-1 (]: On test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select surrogate_key as unique_field
  from `silicon-parity-396203`.`retail`.`dim_accounts`
  where surrogate_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:39:31.587132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:28fe5f9a-5e07-493d-b6c3-30e1a4e3014b&page=queryresults
[0m06:39:31.591098 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064 (execute): 06:39:27.905852 => 06:39:31.590338
[0m06:39:31.594349 [info ] [Thread-1 (]: 22 of 25 PASS unique_dim_accounts_surrogate_key ................................ [[32mPASS[0m in 3.79s]
[0m06:39:31.598667 [debug] [Thread-1 (]: Finished running node test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064
[0m06:39:31.601380 [debug] [Thread-1 (]: Began running node test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m06:39:31.603664 [info ] [Thread-1 (]: 23 of 25 START test unique_dim_users_surrogate_key ............................. [RUN]
[0m06:39:31.606991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.unique_dim_accounts_surrogate_key.aa8b761064, now test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8)
[0m06:39:31.611499 [debug] [Thread-1 (]: Began compiling node test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m06:39:31.631442 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8"
[0m06:39:31.672579 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8 (compile): 06:39:31.614654 => 06:39:31.671744
[0m06:39:31.677253 [debug] [Thread-1 (]: Began executing node test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m06:39:31.686905 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8"
[0m06:39:31.714672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:31.724886 [debug] [Thread-1 (]: On test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select surrogate_key as unique_field
  from `silicon-parity-396203`.`retail`.`dim_users`
  where surrogate_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:39:35.493563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:c20cdc6d-47bf-4f43-8b41-8989e373b0d1&page=queryresults
[0m06:39:35.496790 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8 (execute): 06:39:31.681063 => 06:39:35.496009
[0m06:39:35.499726 [info ] [Thread-1 (]: 23 of 25 PASS unique_dim_users_surrogate_key ................................... [[32mPASS[0m in 3.89s]
[0m06:39:35.502690 [debug] [Thread-1 (]: Finished running node test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8
[0m06:39:35.505169 [debug] [Thread-1 (]: Began running node test.retail_task.unique_fct_transactions_unique_key.3151c30ad6
[0m06:39:35.507584 [info ] [Thread-1 (]: 24 of 25 START test unique_fct_transactions_unique_key ......................... [RUN]
[0m06:39:35.510063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.unique_dim_users_surrogate_key.6aad9a59e8, now test.retail_task.unique_fct_transactions_unique_key.3151c30ad6)
[0m06:39:35.512119 [debug] [Thread-1 (]: Began compiling node test.retail_task.unique_fct_transactions_unique_key.3151c30ad6
[0m06:39:35.529199 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.unique_fct_transactions_unique_key.3151c30ad6"
[0m06:39:35.550485 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_fct_transactions_unique_key.3151c30ad6 (compile): 06:39:35.514031 => 06:39:35.549734
[0m06:39:35.553186 [debug] [Thread-1 (]: Began executing node test.retail_task.unique_fct_transactions_unique_key.3151c30ad6
[0m06:39:35.571705 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.unique_fct_transactions_unique_key.3151c30ad6"
[0m06:39:35.597052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:35.606274 [debug] [Thread-1 (]: On test.retail_task.unique_fct_transactions_unique_key.3151c30ad6: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.unique_fct_transactions_unique_key.3151c30ad6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select unique_key as unique_field
  from `silicon-parity-396203`.`retail`.`fct_transactions`
  where unique_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:39:40.245918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:35779a92-1b1e-4bdf-9c6e-8e4360b5324d&page=queryresults
[0m06:39:40.249924 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_fct_transactions_unique_key.3151c30ad6 (execute): 06:39:35.555306 => 06:39:40.249435
[0m06:39:40.253176 [info ] [Thread-1 (]: 24 of 25 PASS unique_fct_transactions_unique_key ............................... [[32mPASS[0m in 4.74s]
[0m06:39:40.256567 [debug] [Thread-1 (]: Finished running node test.retail_task.unique_fct_transactions_unique_key.3151c30ad6
[0m06:39:40.259574 [debug] [Thread-1 (]: Began running node test.retail_task.unique_stg_accounts_created_account_id.d00a929146
[0m06:39:40.262092 [info ] [Thread-1 (]: 25 of 25 START test unique_stg_accounts_created_account_id ..................... [RUN]
[0m06:39:40.265107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_task.unique_fct_transactions_unique_key.3151c30ad6, now test.retail_task.unique_stg_accounts_created_account_id.d00a929146)
[0m06:39:40.267766 [debug] [Thread-1 (]: Began compiling node test.retail_task.unique_stg_accounts_created_account_id.d00a929146
[0m06:39:40.278115 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_task.unique_stg_accounts_created_account_id.d00a929146"
[0m06:39:40.306590 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_stg_accounts_created_account_id.d00a929146 (compile): 06:39:40.269711 => 06:39:40.306001
[0m06:39:40.308875 [debug] [Thread-1 (]: Began executing node test.retail_task.unique_stg_accounts_created_account_id.d00a929146
[0m06:39:40.321465 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_task.unique_stg_accounts_created_account_id.d00a929146"
[0m06:39:40.347978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:40.356127 [debug] [Thread-1 (]: On test.retail_task.unique_stg_accounts_created_account_id.d00a929146: /* {"app": "dbt", "dbt_version": "1.5.5", "profile_name": "retail_task", "target_name": "dev", "node_id": "test.retail_task.unique_stg_accounts_created_account_id.d00a929146"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select account_id as unique_field
  from `silicon-parity-396203`.`retail`.`stg_accounts_created`
  where account_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:39:43.334153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=silicon-parity-396203&j=bq:US:c2e0ed18-1583-4cdd-a10f-7ae663130901&page=queryresults
[0m06:39:43.413599 [debug] [Thread-1 (]: Timing info for test.retail_task.unique_stg_accounts_created_account_id.d00a929146 (execute): 06:39:40.312898 => 06:39:43.412702
[0m06:39:43.464178 [info ] [Thread-1 (]: 25 of 25 PASS unique_stg_accounts_created_account_id ........................... [[32mPASS[0m in 3.20s]
[0m06:39:43.505086 [debug] [Thread-1 (]: Finished running node test.retail_task.unique_stg_accounts_created_account_id.d00a929146
[0m06:39:43.521184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:43.581778 [debug] [MainThread]: Connection 'test.retail_task.unique_stg_accounts_created_account_id.d00a929146' was properly closed.
[0m06:39:43.592074 [info ] [MainThread]: 
[0m06:39:43.601233 [info ] [MainThread]: Finished running 25 tests in 0 hours 1 minutes and 48.19 seconds (108.19s).
[0m06:39:43.660218 [debug] [MainThread]: Command end result
[0m06:39:43.790837 [info ] [MainThread]: 
[0m06:39:43.793363 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:39:43.798213 [info ] [MainThread]: 
[0m06:39:43.802479 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m06:39:43.808374 [debug] [MainThread]: Command `dbt test` succeeded at 06:39:43.807758 after 112.66 seconds
[0m06:39:43.811646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c7f77610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c4591ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27c4591630>]}
[0m06:39:43.820042 [debug] [MainThread]: Flushing usage events
